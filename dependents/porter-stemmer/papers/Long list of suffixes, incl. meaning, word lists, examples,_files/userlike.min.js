(function(){var App,BackendContainerCookie,BackendCookie,BackendExpireContainerCookie,BackendExpireCookie,BackendLocalStorage,BackendMemory,BackendSessionContainerCookie,BackendSessionCookie,Base64,Blocked,BlockedCheck,Button,ButtonBig,ButtonBubble,ButtonChange,ButtonCheck,ButtonCustom,ButtonEventSetup,ButtonFactory,ButtonHidden,ButtonHiddenWidgetInsert,ButtonInsert,ButtonPreset,ButtonShow,CSS_BUTTON,CSS_EYECATCHER,Chat,ChatBlocked,ChatFeedbackRatingComposite,ChatInactive,ChatMinimized,ChatMinimizedQuitWait,ChatMinimizedQuitWaitDisconnect,ChatOffline,ChatOperatorDisconnect,ChatQuit,ChatQuitWait,ChatQuitWaitDisconnect,ChatReconnecting,ChatReconnectingIntermediate,ChatReopen,ChatSendQuit,ChatUserQuit,ChatUserQuitDisconnect,ChatView,ChatWaitQuit,CheckDisclaimer,CheckMobileDevice,CheckPostChatFirst,CheckPostChatLast,CheckPostChatSecond,CheckPostChatThird,CheckPreChatFirst,CheckPreChatLast,CheckPreChatSecond,CheckPreChatThird,CheckScriptPostion,CheckSlotAvailable,CheckTranscriptForm,Config,ConfigSetup,Cookies,CustomCSS,Disclaimer,DisclaimerAvailableCheck,DisclaimerView,EmojiPopoverView,ErrorMessage,EventSetup,ExpiredWarning,Eyecatcher,FSM,FacebookLoader,FacebookView,FeedbackRatingCompositeView,FeedbackView,FontLoader,GroupSelect,GroupSelectAvailableCheck,GroupSelectView,Idle,IdleView,Init,KeyHandler,KeyHandlerAndroid,KeyHandlerFactory,KeyHandlerFactoryAndroid,KeyHandlerLivePreview,KeyHandlerLivePreviewAndroid,LoadLib,Loader,MAP,MessageView,NoCookies,NoCookiesMessage,NoStateCheck,NoSwitch,Offline,OfflineMessage,OfflineMessageDone,OfflineMessageFeedback,OfflineMessageForm,OfflineMessageProcess,OfflineMessageScreenshot,OfflineMessageScreenshotSend,OfflineMessageSend,OfflineMessageSent,OfflineMessageView,PageUnloading,PassiveConnectAvailableCheck,PassiveConnectOffer,PassiveConnectSlotCreate,PassiveConnectSlotStart,PassiveConnectSlotVerify,PassiveConnectSocketConnect,PassiveConnectStart,Popup,Position,PostSurveyForm,PreSurveyAvailableCheck,PreSurveyForm,PreviewState,ProactiveEventSetup,ProactiveOffer,ProactivePassiveSlotCreate,ProactivePassiveSlotStart,ProactivePassiveSlotVerify,ProactivePassiveSocketConnect,ProactiveSlotAvailable,ProactiveSlotCheck,ProactiveSlotOfferPassive,ProactiveSlotOfferPassiveStart,ProactiveSlotReject,ProactiveSlotRejected,ProactiveSlotUnavailable,ProactiveTimer,ProgressView,Push,Rating,RatingView,RegisterAvailableCheck,RegisterFacebookApiMe,RegisterFacebookLogin,RegisterForm,RegisterOptions,RegisterView,RemoteApiMode,RemoteControlCheck,ResetState,RestartEventSetup,RestartFacebookLoader,RestartSlot,RestartSlotCreate,RestartSlotPlayback,RestartSlotStart,RestartSlotVerify,RestartSocketConnect,RestartTwitterLoader,RestoreState,Screenshot,ServerHibernate,ServerHibernateWakeup,ServerHibernateWakeupSlotVerify,Session,SessionFactory,SessionSetup,SessionStorage,SessionStoragePrivacy,Setup,SetupError,SetupTheme,Singleton,Slot,SlotCreate,SlotErrorDisconnect,SlotErrorHandle,SlotStart,SlotSwitch,SlotSwitchDisconnect,SlotSwitchIdle,SlotVerify,SocialComposite,SocialCompositeView,SocketConnect,Sound,SoundDummy,SoundFactory,Start,State,Storage,Survey,SurveyView,SwitchSlotCreate,SwitchSocketConnect,TrackingDummy,TrackingEvent,TrackingFactory,TrackingGA,TrackingGAUniversal,TrackingGoogleComposite,TrackingKissMetrics,TrackingMixpanel,TrackingPiwik,TranscriptForm,TranscriptSend,TranscriptView,TwitterLoader,TwitterView,UrlParser,UserlikeJqObj,UserlikeReady,Validator,View,Warning,WhitelistCheck,WidgetGoal,WidgetInsert,WidgetVerify,adjustFontSize,animationstring,applyTheme,browser,button,capitalize,chat_view,config,cookieCleanup,cookiesDomain,disclaimer_view,domPrefixes,elm,emotify,escapeRegExp,facebook,facebook_view,feedback_rating_composite_view,feedback_view,fsm,getCookieSupport,getInput,getLocation,getMousePosition,getOrientation,getStorageSupport,git_version,goal,group_select_view,has_css_animation_support,hashCode,i,idle_view,insertStringAtIndex,isAndroid,isElementInViewport,isIE11,isIE8,isURL,is_mobile,keyframeprefix,matched,message_view,offline_message_view,onKeyboardStateChange,overlapDiv,pfx,popup,progress_view,pusher,rating_view,regex_email,regex_url_full,register_view,rgb,rgbaToRgb,serialize,session,setBadge,slot,social_composite_view,sound,subDomain,survey_view,tracking,tracking_event,transcript_view,trim,trimPxSuffix,twitter,twitter_view,unpack,userlike,userlikeCallbackIframeCheck,userlikePreview,userlike_css,userlike_html,hasProp={}.hasOwnProperty,bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend1=function(child,parent){for(var key in parent){if(hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};userlike_html='<!--[if IE 8]><div id="userlike" class="lt-ie9"><![endif]--><!--[if gt IE 8]><!--><div id="userlike"><!--<![endif]--> <div id="userlike-popup" class="userlike-theme-bg userlike-theme-window-bg-color" style="display:none"> <div id="userlike-headerbar" class="userlike-drag userlike-theme-bg userlike-theme-headbar-bg-color"> <div id="userlike-headerbar-headline" class="userlike-theme-text userlike-theme-headbar-text-color"></div> <i id="userlike-minimize" class="userlike-icon userlike-icon-minimize userlike-theme-text userlike-theme-headbar-text-color"></i> <i id="userlike-close" class="userlike-icon userlike-icon-close userlike-theme-text userlike-theme-headbar-text-color"></i> </div> <div id="userlike-view-container"> <div id="userlike-idle" style="display:none"></div> <div id="userlike-progress" style="display:none"> <img src="//dq4irj27fs462.cloudfront.net/spinner.gif" alt="loading" id="userlike-spinner-gif" style="display:none"> <div id="userlike-spinner"> <div id="userlike-bounce-1" class="userlike-theme-bg userlike-theme-icon-active-color"></div> <div id="userlike-bounce-2" class="userlike-theme-bg userlike-theme-icon-active-color"></div> <div id="userlike-bounce-3" class="userlike-theme-bg userlike-theme-icon-active-color"></div> </div> </div> <div id="userlike-disclaimer" style="display:none"> <div class="userlike-headline userlike-theme-text userlike-theme-headline-text-color" id="userlike-disclaimer-headline"></div> <div id="userlike-disclaimer-text" class="userlike-theme-text userlike-theme-text-default-color"></div> <div id="userlike-disclaimer-submit"> <i class="userlike-icon userlike-icon-check userlike-theme-text userlike-theme-icon-default-color userlike-icon-has-active-state"></i> </div> </div> <div id="userlike-message" style="display:none"> <div id="userlike-message-headline" class="userlike-headline userlike-theme-text userlike-theme-headline-text-color" ></div> </div> <div id="userlike-group-select" style="display:none"> <div class="userlike-headline userlike-theme-text userlike-theme-headline-text-color" id="userlike-group-select-headline"></div> <fieldset> <div class="userlike-fieldset-wrapper"> <div class="userlike-radio-wrapper" data-select="1"> <input type="radio"> <img src="" alt="" class="userlike-group-select-operator-image"> <div class="userlike-label userlike-theme-text userlike-theme-text-default-color"></div> </div> <div class="userlike-radio-wrapper" data-select="2"> <input type="radio"> <img src="" alt="" class="userlike-group-select-operator-image"> <div class="userlike-label userlike-theme-text userlike-theme-text-default-color"></div> </div> <div class="userlike-radio-wrapper" data-select="3"> <input type="radio"> <img src="" alt="" class="userlike-group-select-operator-image"> <div class="userlike-label userlike-theme-text userlike-theme-text-default-color"></div> </div> <div class="userlike-radio-wrapper" data-select="4"> <input type="radio"> <img src="" alt="" class="userlike-group-select-operator-image"> <div class="userlike-label userlike-theme-text userlike-theme-text-default-color"></div> </div> <div class="userlike-radio-wrapper" data-select="5"> <input type="radio"> <img src="" alt="" class="userlike-group-select-operator-image"> <div class="userlike-label userlike-theme-text userlike-theme-text-default-color"></div> </div> <div class="userlike-radio-wrapper" data-select="6"> <input type="radio"> <img src="" alt="" class="userlike-group-select-operator-image"> <div class="userlike-label userlike-theme-text userlike-theme-text-default-color"></div> </div> </div> </fieldset> </div> <div id="userlike-feedback-rating-composite"> <div id="userlike-rating" style="display:none"> <div class="userlike-headline userlike-theme-text userlike-theme-headline-text-color" id="userlike-rating-headline"></div> <div id="userlike-star-rating"> <span> <i data-rating="1" class="userlike-icon userlike-icon-rating-inactive userlike-theme-text userlike-theme-icon-default-color userlike-rating"></i> </span> <span> <i data-rating="2" class="userlike-icon userlike-icon-rating-inactive userlike-theme-text userlike-theme-icon-default-color userlike-rating"></i> </span> <span> <i data-rating="3" class="userlike-icon userlike-icon-rating-inactive userlike-theme-text userlike-theme-icon-default-color userlike-rating"></i> </span> <span> <i data-rating="4" class="userlike-icon userlike-icon-rating-inactive userlike-theme-text userlike-theme-icon-default-color userlike-rating"></i> </span> <span> <i data-rating="5" class="userlike-icon userlike-icon-rating-inactive userlike-theme-text userlike-theme-icon-default-color userlike-rating"></i> </span> </div> </div> <div id="userlike-feedback" style="display:none"> <form id="userlike-feedback-form" onsubmit="return false;"> <textarea id="userlike-feedback-textarea" class="userlike-theme-text userlike-theme-input-default-text-color"></textarea> </form> <i id="userlike-feedback-submit" class="userlike-icon userlike-icon-send userlike-theme-text userlike-theme-icon-default-color userlike-icon-has-active-state userlike-disabled"></i> </div> </div> <div id="userlike-survey" style="display:none"> <div class="userlike-headline userlike-theme-text userlike-theme-headline-text-color" id="userlike-survey-headline"></div> <fieldset> <div class="userlike-fieldset-wrapper"> <div class="userlike-radio-wrapper" data-select="1"> <input type="radio"> <div class="userlike-label userlike-theme-text userlike-theme-text-default-color"></div> </div> <div class="userlike-radio-wrapper" data-select="2"> <input type="radio"> <div class="userlike-label userlike-theme-text userlike-theme-text-default-color"></div> </div> <div class="userlike-radio-wrapper" data-select="3"> <input type="radio"> <div class="userlike-label userlike-theme-text userlike-theme-text-default-color"></div> </div> <div class="userlike-radio-wrapper" data-select="4"> <input type="radio"> <div class="userlike-label userlike-theme-text userlike-theme-text-default-color"></div> </div> </div> </fieldset> </div> <div id="userlike-social-composite"> <div id="userlike-facebook-like" style="display:none"> <div class="userlike-headline userlike-theme-text userlike-theme-headline-text-color" id="userlike-facebook-like-headline"></div> <div id="userlike-facebook-like-wrapper"></div> </div> <div id="userlike-twitter-tweet" style="display:none"> <div class="userlike-headline userlike-theme-text userlike-theme-headline-text-color" id="userlike-twitter-tweet-headline"></div> <div id="userlike-twitter-tweet-wrapper"> </div> </div> </div> <div id="userlike-offline-message" style="display:none"> <div class="userlike-headline userlike-theme-text userlike-theme-headline-text-color" id="userlike-offline-message-headline"></div> <div id="userlike-offline-message-text" class="userlike-theme-text userlike-theme-text-default-color"></div> <form id="userlike-offline-message-form" onsubmit="return false;"> <input id="userlike-offline-name" type="text"> <input id="userlike-offline-email" type="email"> <textarea id="userlike-offline-textarea"></textarea> <div id="userlike-screenshot-wrapper"> <input type="checkbox" id="userlike-screenshot-checkbox" class="userlike-theme-text userlike-theme-text-default-color" name="sendScreenshot" value="1"> <div id="userlike-screenshot-label"></div> </div> <div id="userlike-offline-message-submit"> <i class="userlike-icon userlike-icon-send userlike-theme-text userlike-theme-icon-default-color userlike-icon-has-active-state"></i> </div> </form> </div> <div id="userlike-register" style="display:none"> <div class="userlike-headline userlike-theme-text userlike-theme-headline-text-color" id="userlike-register-headline"></div> <div id="userlike-register-text" class="userlike-theme-text userlike-theme-text-default-color"></div> <form id="userlike-register-form" onsubmit="return false;"> <input id="userlike-register-name" class="userlike-theme-text userlike-theme-input-default-text-color" type="text"> <input id="userlike-register-email" class="userlike-theme-text userlike-theme-input-default-text-color" type="email"> <input id="userlike-register-additional01" class="userlike-theme-text userlike-theme-input-default-text-color" type="text"> <input id="userlike-register-additional02" class="userlike-theme-text userlike-theme-input-default-text-color" type="text"> <input id="userlike-register-additional03" class="userlike-theme-text userlike-theme-input-default-text-color" type="text"> <div id="userlike-register-submit"> <i class="userlike-icon userlike-icon-send userlike-theme-text userlike-theme-icon-default-color userlike-icon-has-active-state"></i> </div> <div id="userlike-facebook-connect-submit"> <i class="userlike-icon userlike-icon-facebook userlike-theme-text userlike-theme-icon-default-color userlike-icon-has-active-state"></i> </div> </form> </div> <div id="userlike-transcript" style="display:none"> <div class="userlike-headline userlike-theme-text userlike-theme-headline-text-color" id="userlike-transcript-headline"></div> <div id="userlike-transcript-text" class="userlike-theme-text userlike-theme-text-default-color"></div> <form id="userlike-transcript-form" onsubmit="return false;"> <input id="userlike-transcript-email" class="userlike-theme-text userlike-theme-input-default-text-color" type="email"> <div id="userlike-transcript-submit"> <i class="userlike-icon userlike-icon-send userlike-theme-text userlike-theme-icon-default-color userlike-icon-has-active-state"></i> </div> </form> </div> <div id="userlike-chat" style="display:none"> <div id="userlike-chat-subheader" class="userlike-theme-bg uselike-theme-bg-default-color"> <div id="userlike-spinner" class="userlike-operator-connect-spinner"> <div id="userlike-bounce-1" class="userlike-theme-bg userlike-theme-icon-active-color"></div> <div id="userlike-bounce-2" class="userlike-theme-bg userlike-theme-icon-active-color"></div> <div id="userlike-bounce-3" class="userlike-theme-bg userlike-theme-icon-active-color"></div> </div> <img id="userlike-subheader-operator-image" src="" alt=""></img> <div id="userlike-subheader-operator-info-text-wrapper"> <span id="userlike-subheader-operator-info-text" class="userlike-theme-text userlike-theme-headbar-bg-color userlike-adjust-text"></span> </div> </div> <form id="userlike-chat-form" onsubmit="return false;"> <div id="userlike-chat-content"> </div> <div id="userlike-chat-scroll-textarea"> <textarea id="userlike-chat-textarea" class="userlike-theme-text userlike-theme-text-default-color"></textarea> <div id="userlike-emoji-button" class="userlike-emoji userlike-emoji-icon_emoticon"></div> </div> </form> </div> </div> <div id="userlike-footerbar"> <div id="userlike-data-privacy"><a target="_blank" href="#" class="userlike-theme-text userlike-theme-link-text-color"></a></div> <div id="userlike-poweredby" class="notranslate userlike-theme-text userlike-theme-link-text-color">{{POWEREDBY_SLOGAN}} <a id="userlike-poweredby-link" class="notranslate userlike-theme-text userlike-theme-link-text-color" target="_blank" href="{{POWEREDBY_LINK}}">Userlike</a></div> </div> <img id="userlike-subheader-operator-image-zoomed" src="" alt="" style="display: none;"></img> </div> <div id="userlike-eyecatcher"> <i id="userlike-eyecatcher-close" class="userlike-icon userlike-icon-close userlike-theme-button-bg-color userlike-theme-text"></i> <div id="userlike-eyecatcher-box"> <div id="userlike-eyecatcher-mask"> <div id="userlike-eyecatcher-picture"></div> </div> <div id="userlike-eyecatcher-message" class="userlike-theme-button-bg-color userlike-theme-text"></div> </div> </div> <div id="userlike-hover-text-container" class="userlike-theme-button-bg-color userlike-theme-bg"> <span id="userlike-button-hover-text" class="userlike-theme-text userlike-theme-button-text-color"></span> <div id="userlike-hover-text-arrow"></div> </div> <a href="javascript:void(0);" onkeypress="javascript:return false;" id="userlike-tab" class="userlike-theme-button-bg-color userlike-theme-bg" style=""> <div id="userlike-button-icon"> <div id="userlike-spinner" class="userlike-button-spinner"> <div id="userlike-bounce-1" class="userlike-theme-bg userlike-theme-button-icon-color"></div> <div id="userlike-bounce-2" class="userlike-theme-bg userlike-theme-button-icon-color"></div> <div id="userlike-bounce-3" class="userlike-theme-bg userlike-theme-button-icon-color"></div> </div> <i class="userlike-icon userlike-theme-text userlike-theme-button-icon-color"></i> </div> <span id="userlike-button-text" class="userlike-theme-text userlike-theme-button-text-color"></span> <div id="userlike-message-badge" class="userlike-theme-bg userlike-theme-window-bg-color"> <div id="userlike-message-badge-count" class="userlike-theme-text userlike-theme-headbar-bg-color"></div> </div> </a></div>';userlike_css='#userlike,.userlike { position: static; z-index: 2147483640; overflow: hidden; width: auto; min-width: 0; height: auto; min-height: 0; margin: 0; padding: 0;}#userlike *{ font-family: \'{{FONT}}\', sans-serif; font-size: 13px; font-weight: 400; font-style: normal; font-variant: normal; line-height: 1.5; position: static; top: auto; right: auto; bottom: auto; left: auto; float: none; clear: none; overflow: hidden; width: auto; min-width: 0; height: auto; min-height: 0; margin: 0; padding: 0; cursor: auto; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; text-align: left; white-space: normal; text-decoration: none; text-indent: 0; letter-spacing: normal; word-spacing: normal; text-transform: none; opacity: 1; color: #4b4d4f; border: none; -webkit-border-radius: 0; -moz-border-radius: 0; border-radius: 0; outline-style: none; background: none; -webkit-box-shadow: none; -moz-box-shadow: none; box-shadow: none; text-shadow: none; direction: ltr; unicode-bidi: normal; -moz-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; -webkit-touch-callout: none; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; -ms-border-radius: 0;}a#userlike-tab { line-height: 1; position: fixed; z-index: 2147483640; float: none; clear: none; overflow: hidden; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; width: auto; min-width: 240px; height: 48px; min-height: 0; max-height: 0; margin: 0; margin-bottom: -8px; padding: 0; padding-right: 32px; padding-bottom: 0; padding-left: 32px; cursor: pointer; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; text-align: left; white-space: nowrap; text-decoration: none; text-indent: 0; letter-spacing: normal; word-spacing: normal; text-transform: none; text-overflow: ellipsis; opacity: 1; color: #fff; border: none; border-radius: 0; outline-style: none; background: none; -webkit-box-shadow: 0 -5px 30px 0 rgba(0, 0, 0, .1); -moz-box-shadow: 0 -5px 30px 0 rgba(0, 0, 0, .1); box-shadow: 0 -5px 30px 0 rgba(0, 0, 0, .1); text-shadow: none; unicode-bidi: normal; -moz-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; -webkit-touch-callout: none; -webkit-tap-highlight-color:rgba(0,0,0,0); -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;}a#userlike-tab #userlike-message-bubble { display: none;}a#userlike-tab.userlike-button-01,a#userlike-tab.userlike-button-02 { padding-left: 28px;}a#userlike-tab.userlike-button-03 { padding-left: 26px;}a#userlike-tab.userlike-button-04 { padding-left: 25px;}a#userlike-tab.userlike-button-offline-01,a#userlike-tab.userlike-button-05,a#userlike-tab.userlike-button-06 { padding-left: 23px;}a#userlike-tab.userlike-button-offline-02{ padding-left: 24px;}a#userlike-tab.userlike-button-offline-03{ padding-left: 29px;}a#userlike-tab.userlike-button-bubble.userlike-button-01 .userlike-icon{ padding-top: 1px;}a#userlike-tab.userlike-button-bubble.userlike-button-02 .userlike-icon{ padding-left: 4px;}a#userlike-tab.userlike-button-bubble.userlike-button-03 .userlike-icon{ padding-top: 2px;}a#userlike-tab.userlike-button-bubble.userlike-button-04 .userlike-icon{ padding-top: 3px; padding-left: 2px;}a#userlike-tab.userlike-button-bubble.userlike-button-05 .userlike-icon{ padding-top: 3px; padding-left: 2px;}a#userlike-tab.userlike-button-bubble.userlike-button-06 .userlike-icon{ padding-top: 2px; padding-left: 2px;}a#userlike-tab.userlike-button-bubble.userlike-button-offline-01 .userlike-icon{ padding-top: 1px; }a#userlike-tab.userlike-button-bubble.userlike-button-offline-02 .userlike-icon{ padding-top: 3px; padding-left: 3px; }a#userlike-tab.userlike-button-bubble.userlike-button-offline-03 .userlike-icon{ padding-top: 3px; padding-right: 3px; }#userlike.userlike-mobile a#userlike-tab,#userlike a#userlike-tab.userlike-button-bubble { bottom: -100px; width: 64px; min-width: 64px; max-width: 64px; height: 64px; min-height: 64px; max-height: 64px; padding: 0; border-radius: 50%;}#userlike.userlike-mobile a#userlike-tab.userlike-slideup,#userlike a#userlike-tab.userlike-button-bubble.userlike-slideup{ bottom: 16px; -webkit-transition: bottom .5s ease-in-out; -moz-transition: bottom .5s ease-in-out; -o-transition: bottom .5s ease-in-out; transition: bottom .5s ease-in-out;}#userlike.userlike-mobile a#userlike-tab #userlike-message-badge { position: absolute; top: 10px; right: 7px; display: none; width: 20px; height: 20px; border-radius: 50%;}#userlike.userlike-mobile a#userlike-tab #userlike-message-badge.userlike-show { display: block;}#userlike.userlike-mobile a#userlike-tab #userlike-message-badge #userlike-message-badge-count { text-align: center;}#userlike.userlike-mobile #userlike-button-icon,#userlike a#userlike-tab.userlike-button-bubble #userlike-button-icon { width: 63px; height: 43px; margin-top: 9px !important; text-align: center;}#userlike.userlike-mobile #userlike-button-icon #userlike-spinne,#userlike a#userlike-tab.userlike-button-bubble #userlike-button-icon #userlike-spinner{ margin-left: 11px;}a#userlike-tab #userlike-button-text,#userlike #userlike-button-hover-text{ font-size: 14px !important; display: inline-block!important; position: relative !important; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; text-align: left; vertical-align: top !important; text-decoration: none; text-indent: 0; word-spacing: normal; text-transform: none; opacity: 1; outline-style: none; text-shadow: none; unicode-bidi: normal; -moz-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; -webkit-touch-callout: none; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; cursor: pointer;}a#userlike-tab #userlike-button-text { top: 8px !important; padding-left: 10px !important; font-weight: 700;}#userlike #userlike-button-hover-text{ font-weight: 600; padding-top: 13px;}#userlike.userlike-mobile a#userlike-tab #userlike-button-text { display: none;}a#userlike-tab.userlike-slideup { max-height: 48px; margin-bottom: 0; padding-top: 8px; -webkit-transition: max-height .5s ease-in-out; -moz-transition: max-height .5s ease-in-out; -o-transition: max-height .5s ease-in-out; transition: max-height .5s ease-in-out;}a#userlike-tab.userlike-slidedown { top: 0 !important; max-height: 48px; -webkit-transition: top .5s ease-in-out; -moz-transition: top .5s ease-in-out; -o-transition: top .5s ease-in-out; transition: top .5s ease-in-out;}a#userlike-tab.userlike-left,a#userlike-tab.userlike-right { bottom: 0; -webkit-border-top-left-radius: 3px; border-top-left-radius: 3px; -webkit-border-top-right-radius: 3px; border-top-right-radius: 3px; -moz-border-top-left-radius: 3px; -moz-border-top-right-radius: 3px;}a#userlike-tab.userlike-left { left: 40px;}a#userlike-tab.userlike-right { right: 40px;}body.userlike-disable-body-scroll{ position: fixed; overflow: hidden;}#userlike.userlike-mobile a#userlike-tab.userlike-left { left: 16px;}#userlike.userlike-mobile a#userlike-tab.userlike-right { right: 16px;}#userlike-button-icon { position: relative !important; display: inline-block !important; width: 43px; height: 43px; margin-top: -3px !important;}#userlike-button-icon i.userlike-icon { font-size: 43px; cursor: pointer;}#userlike-button-icon .userlike-button-spinner{ display: none; width: 40px !important; margin-top: 13px;}#userlike-button-icon .userlike-button-spinner > div{ width: 10px !important; height: 10px !important;}#userlike-eyecatcher,#userlike-eyecatcher-box,#userlike-eyecatcher-mask,#userlike-eyecatcher-message { display: none;}#userlike.userlike-mobile #userlike-eyecatcher,#userlike.lt-ie9 #userlike-eyecatcher { display: none !important;}#userlike #userlike-eyecatcher-close { font-size: 20px !important; position: absolute; z-index: 2147483642; width: 19px !important; height: 19px !important; padding: 0 !important; cursor: pointer; border: none;}#userlike-hover-text-container, #userlike-eyecatcher{ position: fixed; z-index: 2147483640; display: none; float: none; clear: none; overflow: visible !important; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 0; padding: 0; cursor: pointer; -webkit-transition: opacity .1s ease-in; -moz-transition: opacity .1s ease-in; -ms-transition: opacity .1s ease-in; -o-transition: opacity .1s ease-in; transition: opacity .1s ease-in; text-decoration: none; opacity: 0; border: none; outline-style: none; box-shadow: none; direction: ltr;}#userlike-hover-text-container{ text-align: center; bottom: 22px; padding-left: 32px; padding-right: 32px; height: 48px; min-height: 48px; max-height: 48px; border-radius: 2px;}#userlike-hover-text-arrow{ position: absolute; width: 0; height: 0; border-style: solid; top: 15px;}#userlike-hover-text-container.userlike-right #userlike-hover-text-arrow{ border-width: 9.5px 0 9.5px 10px; right: -10px;}#userlike-hover-text-container.userlike-left #userlike-hover-text-arrow{ border-width: 9.5px 10px 9.5px 0; left: -10px;}#userlike-eyecatcher { bottom: 56px; width: 242px; min-width: 240px; border-radius: 0; height: 60px; min-height: 60px; max-height: 60px; text-indent: -100000px;}#userlike-eyecatcher *{ cursor: pointer;}#userlike-eyecatcher.fadeIn,#userlike-hover-text-container.fadeIn{ opacity: 1 !important;}#userlike #userlike-eyecatcher-close { top: 3px !important; right: 3px !important; display: none !important;}#userlike #userlike-eyecatcher:hover > #userlike-eyecatcher-close { display: block !important;}#userlike-eyecatcher-box { display: block; overflow: visible !important; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; min-width: 240px; height: 60px;}#userlike-eyecatcher.eyecatcher-01 #userlike-eyecatcher-box { width: 242px; height: 60px; -webkit-border-radius: 3px; -moz-border-radius: 3px; border-radius: 3px; background-color: #fff; -webkit-box-shadow: 0 2px 1px 0 rgba(0, 0, 0, .1); -moz-box-shadow: 0 2px 1px 0 rgba(0, 0, 0, .1); box-shadow: 0 2px 1px 0 rgba(0, 0, 0, .1);}#userlike-eyecatcher.eyecatcher-02 { bottom: 68px;}#userlike-eyecatcher.eyecatcher-02 #userlike-eyecatcher-box { height: 72px; background-image: url(//dq4irj27fs462.cloudfront.net/eyecatcher_02.png?v=faf7df48a81098660d54dde06a2351fd73708626 ); background-repeat: no-repeat; background-size: 100% 100%;}#userlike-eyecatcher.eyecatcher-02 #userlike-eyecatcher-message { bottom: 4px; margin: 0 auto; left: 0; right: 0; width: 73%;}#userlike-eyecatcher.eyecatcher-02 #userlike-eyecatcher-close { top: 8px !important; right: 38px !important;}#userlike-eyecatcher.eyecatcher-03 #userlike-eyecatcher-box { height: 144px; background-image: url(//dq4irj27fs462.cloudfront.net/eyecatcher_03.png?v=faf7df48a81098660d54dde06a2351fd73708626 ); background-repeat: no-repeat; background-size: 100% 100%;}#userlike-eyecatcher.eyecatcher-03 #userlike-eyecatcher-close { top: 18px !important; right: 12px !important;}#userlike-eyecatcher.eyecatcher-03 { bottom: 141px;}#userlike-eyecatcher.eyecatcher-03.right { right: 0;}#userlike-eyecatcher.eyecatcher-03.left { left: 100px;}#userlike-eyecatcher.eyecatcher-03 #userlike-eyecatcher-mask { top: 25px; left: 29px; width: 50px; height: 50px; margin: 0; border: none;}#userlike-eyecatcher.eyecatcher-03 #userlike-eyecatcher-box:before { display: none;}#userlike-eyecatcher.eyecatcher-03 #userlike-eyecatcher-picture { width: 50px; height: 50px; background-size: 50px 50px;}#userlike-eyecatcher.eyecatcher-03 #userlike-eyecatcher-message { bottom: 0; left: 90px; width: 59%; text-align: left;}@media(-webkit-min-device-pixel-ratio:2), (min-resolution:192dppx) { #userlike-eyecatcher.eyecatcher-02 #userlike-eyecatcher-box { background-image: url(//dq4irj27fs462.cloudfront.net/eyecatcher_02@2x.png?v=faf7df48a81098660d54dde06a2351fd73708626 ); } #userlike-eyecatcher.eyecatcher-03 #userlike-eyecatcher-box { background-image: url(//dq4irj27fs462.cloudfront.net/eyecatcher_03@2x.png?v=faf7df48a81098660d54dde06a2351fd73708626 ); }}#userlike-eyecatcher-box:before { position: absolute; z-index: -1; top: -50px; right: 0; left: 0; display: block; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; width: 80px; height: 80px; margin: auto; content: \'\'; border: 5px solid #fff; -webkit-border-radius: 50%; -moz-border-radius: 50%; border-radius: 50%; background-color: #fff; -webkit-box-shadow: 0 2px 2px 0 rgba(0, 0, 0, .1), 0 0 4px 0 rgba(0, 0, 0, .1); -moz-box-shadow: 0 2px 2px 0 rgba(0, 0, 0, .1), 0 0 4px 0 rgba(0, 0, 0, .1); box-shadow: 0 2px 2px 0 rgba(0, 0, 0, .1), 0 0 4px 0 rgba(0, 0, 0, .1);}#userlike-eyecatcher-mask { position: absolute; top: -48px; right: 0; left: 0; display: block; overflow: hidden; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; width: 74px; height: 74px; margin: auto; border: 5px solid #fff; -webkit-border-radius: 50%; -moz-border-radius: 50%; border-radius: 50%; background-color: #fff;}#userlike-eyecatcher-picture { width: 64px; height: 64px; background-color: #fff; background-size: 64px 64px;}#userlike-eyecatcher-message { font-size: 15px; position: absolute; bottom: 7px; display: block; width: 100%; text-align: center; text-indent: 0; color: #4b4d4f; white-space: nowrap; text-overflow: ellipsis; overflow: hidden;}#userlike-eyecatcher.right { right: 40px;}#userlike-eyecatcher.left { left: 40px;}#userlike a:hover,#userlike a:active { z-index: 2147483642; cursor: pointer; text-decoration: none; outline: 0;}#userlike input { font-size: 100%; line-height: normal; overflow: visible; margin: 0; -webkit-user-select: text; -moz-user-select: text; -ms-user-select: text; user-select: text; vertical-align: middle;}#userlike input[type="checkbox"],#userlike input[type="radio"] { box-sizing: border-box; border: none; padding: 0 !important;}#userlike input::-moz-focus-inner { padding: 0; border: 0;}#userlike form { position: relative; top: 0; right: 0; display: block; margin: 0; padding: 0;}#userlike-popup { position: fixed; z-index: 2147483643; overflow: visible !important; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; width: 416px; height: 216px; margin: 0 !important; padding: 0 0 10px !important; color: #4b4d4f; -webkit-border-radius: 0; -moz-border-radius: 0; border-radius: 0; background: #fff; box-shadow: 0 -5px 50px 0 rgba(0, 0, 0, .2);}#userlike.userlike-mobile #userlike-popup{ width: 100%;}#userlike #userlike-register,#userlike #userlike-offline-message,#userlike #userlike-survey,#userlike #userlike-disclaimer,#userlike #userlike-group-select,#userlike #userlike-transcript,#userlike #userlike-message,#userlike #userlike-social-composite,#userlike #userlike-feedback-rating-composite { margin: 0 40px;}#userlike.userlike-mobile #userlike-register,#userlike.userlike-mobile #userlike-offline-message,#userlike.userlike-mobile #userlike-survey,#userlike.userlike-mobile #userlike-disclaimer,#userlike.userlike-mobile #userlike-group-select,#userlike.userlike-mobile #userlike-transcript,#userlike.userlike-mobile #userlike-message,#userlike.userlike-mobile #userlike-message,#userlike.userlike-mobile #userlike-feedback-rating-composite { margin: 0 22px;}#userlike #userlike-group-select .userlike-radio-wrapper{ height: 48px; width: 43%; float: left; padding-left: 23px;}#userlike #userlike-group-select input[type="radio"]{ margin: 17px 0 0 -5px !important;}#userlike #userlike-group-select .userlike-label{ padding-top: 15px; padding-left: 19px; overflow: hidden; white-space: nowrap; width: 73%; text-overflow: ellipsis;}#userlike #userlike-group-select .userlike-group-select-operator-image{ position: absolute; top: 0; left: 0; width: 48px; height: 48px; border-radius: 50%; cursor: pointer;}#userlike.lt-ie9 #userlike-popup { border: 1px solid rgb(211, 212, 213);}#userlike-progress { position: static;}#userlike-progress #userlike-spinner { margin: 60px auto 0;}#userlike.userlike-no-css-animation #userlike-spinner-gif { margin: 40px 180px 0!important;}#userlike.userlike-no-css-animation #userlike-spinner div { display: none;}#userlike.userlike-no-css-animation #userlike-progress #userlike-spinner { width: 40px; height: 40px; background-size: 40px 40px;}#userlike-spinner { position: static; z-index: 2147483642; width: 70px; text-align: center;}#userlike-spinner div { position: static; display: inline-block; width: 18px !important; height: 18px !important; -webkit-animation: bouncedelay 1.4s infinite ease-in-out; -moz-animation: bouncedelay 1.4s infinite ease-in-out; animation: bouncedelay 1.4s infinite ease-in-out; border-radius: 100%; -webkit-animation-fill-mode: both; -moz-animation-fill-mode: both; animation-fill-mode: both;}#userlike-spinnerIframe { position: relative; z-index: 2147483642; top: 50%; width: 100%; height: 100%; text-align: center;}#userlike-spinnerIframe div { position: static; display: inline-block; width: 40px !important; height: 40px !important; -webkit-animation: bouncedelay 1.4s infinite ease-in-out; -moz-animation: bouncedelay 1.4s infinite ease-in-out; animation: bouncedelay 1.4s infinite ease-in-out; border-radius: 100%; background-color: #a9b0b7 !important; -webkit-animation-fill-mode: both; -moz-animation-fill-mode: both; animation-fill-mode: both;}#userlike.lt-ie9 #userlike-spinnerIframe div { position: static; display: inline-block; width: 40px !important; height: 40px !important; border-radius: 100%; background-color: #a9b0b7 !important;}#userlike-bounce-1 { -webkit-animation-delay: -.32s !important; -moz-animation-delay: -.32s !important; animation-delay: -.32s !important;}#userlike-bounce-2 { -webkit-animation-delay: -.16s !important; -moz-animation-delay: -.16s !important; animation-delay: -.16s !important;}@-webkit-keyframes bouncedelay { 0%, 80%, 100% { -webkit-transform: scale(.0); transform: scale(.0); } 40% { -webkit-transform: scale(1.0); transform: scale(1.0); }}@keyframes bouncedelay { 0%, 80%, 100% { transform: scale(.0); } 40% { transform: scale(1.0); }}.uselikeDrag { cursor: auto;}#userlike-dragTop { position: absolute; z-index: 2147483641; top: 0 !important; left: 0 !important; display: block; width: 320px !important; height: 40px !important; margin: 0 !important; cursor: auto;}#userlike #userlike-headerbar { position: absolute !important; top: 0 !important; right: 0 !important; left: 0 !important; height: 56px !important;}#userlike.userlike-chat-textarea-fullscreen #userlike-headerbar { display: none;}#userlike #userlike-headerbar #userlike-headerbar-headline { font-size: 14px !important; font-weight: bold; position: absolute !important; top: 18px !important; left: 40px !important; max-width: 80%; white-space: nowrap; text-overflow: ellipsis;}#userlike.userlike-mobile #userlike-headerbar #userlike-headerbar-headline { left: 22px !important;}#userlike #userlike-footerbar { position: absolute; right: 0; bottom: 0; left: 0; height: 32px;}#userlike.userlike-chat-textarea-fullscreen #userlike-footerbar { display: none;}#userlike-dragBottom { position: absolute; z-index: 2147483641; bottom: 0 !important; left: 0 !important; display: block; width: 320px !important; height: 35px !important; margin: 0 !important; cursor: auto;}#userlike-close,#userlike-minimize { position: absolute; z-index: 2147483642; top: 16px; width: 24px !important; height: 24px !important; padding: 0 !important; cursor: pointer; border: none;}#userlike-view-container { position: absolute !important; top: 56px !important; right: 0 !important; bottom: 32px !important; left: 0 !important;}#userlike.userlike-mobile #userlike-view-container { position: fixed !important; overflow-y: scroll !important; overflow-x: hidden !important; width: 100%;}#userlike.userlike-mobile.userlike-chat-textarea-fullscreen #userlike-view-container { top: 0 !important;}#userlike-close { right: 16px;}#userlike-minimize { right: 44px;}.userlike-headline { font-size: 14px !important; font-weight: 700 !important; line-height: 20px !important; z-index: 2147483642; display: block; overflow: hidden; width: 336px !important; height: auto !important; padding: 0 !important; text-overflow: ellipsis;}#userlike-offline-message-headline,#userlike-register-headline,#userlike-disclaimer-headline,#userlike-transcript-headline,#userlike-group-select-headline,#userlike-survey-headline { position: relative !important; margin-top: 40px !important;}#userlike-offline-message-text,#userlike-register-text,#userlike-transcript-text { font-size: 13px; line-height: 18px; overflow: hidden; min-height: 20px !important; max-height: 40px !important; margin: 16px 0 0 0; text-overflow: ellipsis;}#userlike-disclaimer-text { font-size: 13px !important; line-height: 18px !important; right: 40px !important; bottom: 60px !important; left: 40px !important; overflow-y: auto !important; min-height: 20px !important; max-height: 236px !important; text-overflow: ellipsis !important; margin: 16px 0 0 0;}#userlike.userlike-mobile #userlike-disclaimer-text { left: 22px !important;}#userlike-facebook-like,#userlike-twitter-tweet { position: relative; width: 100% !important; margin: 40px 0 !important; padding-bottom: 16px; text-align: left !important; border-bottom: 1px solid rgba(211, 212, 213, .4);}.lt-ie9 #userlike-facebook-like,.lt-ie9 #userlike-twitter-tweet { border-bottom: 1px solid rgb(211, 212, 213);}#userlike-facebook-like-headline,#userlike-twitter-tweet-headline { display: inline-block; max-width: 50%; text-align: left;}#userlike-facebook-like-wrapper,#userlike-twitter-tweet-wrapper { float: right; max-width: 50% !important;}#userlike #userlike-facebook-like.userlike-break-facebook-line #userlike-facebook-like-wrapper{ max-width: 100% !important; float: left; margin-top: 10px;}#userlike #userlike-facebook-like.userlike-break-facebook-line #userlike-facebook-like-headline{ max-width: 100% !important; width: 100% !important;}#userlike.userlike-mobile #userlike-facebook-like-wrapper { right: 0;}#userlike.ie #userlike-facebook-like-wrapper { display: table; width: 225px; height: 70px; margin: 20px auto;}#userlike-twitter-tweet-wrapper { text-align: right;}#userlike.ie #userlike-twitter-tweet-wrapper { display: table; margin: 20px auto;}#userlike-rating { position: relative; margin-top: 20px;}#userlike-rating-headline { width: auto !important; margin-top: 24px !important; text-align: left !important;}#userlike-message-headline { min-height: 22px !important; margin-top: 30px !important; max-height: 90px !important;}#userlike-chatHeadline { line-height: 20px !important; margin: 12px 10px 0 14px !important;}#userlike-chat-subheader { position: absolute; top: 0; right: 0; left: 0; height: 50px;}#userlike.userlike-chat-textarea-fullscreen #userlike-chat-subheader { display: none !important;}#userlike-chat-subheader #userlike-subheader-operator-image,#userlike-chat-subheader #userlike-spinner.userlike-operator-connect-spinner { position: absolute; left: 40px; width: 32px; height: 32px;}#userlike #userlike-subheader-operator-image-zoomed{ position: absolute; top: 66px; left: 38px; border-radius: 50%; width: 32px; height: 32px; -webkit-transition: -webkit-transform 0.6s; transition: -webkit-transform 0.6s; transition: transform 0.6s; transition: transform 0.6s, -webkit-transform 0.6s;}#userlike.userlike-mobile #userlike-subheader-operator-image-zoomed{ left: 16px;}#userlike #userlike-subheader-operator-image-zoomed.userlike-zoom{ box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.41); transform: scale(2.5); -webkit-transform: scale(2.5);}#userlike.userlike-mobile #userlike-subheader-operator-image-zoomed.userlike-zoom{ -webkit-transform: scale(2.5) translateX(7px); transform: scale(2.5) translateX(7px)}#userlike.userlike-mobile.userlike-chat-textarea-fullscreen #userlike-subheader-operator-image-zoomed{ display: none;}#userlike-chat-subheader #userlike-spinner.userlike-operator-connect-spinner { top: 17px;}#userlike.no-css-animation #userlike-spinner.userlike-operator-connect-spinner{ display: none;}#userlike-chat-subheader #userlike-subheader-operator-image { top: 10px; border-radius: 50%;}#userlike.userlike-mobile #userlike-chat-subheader #userlike-subheader-operator-image,#userlike.userlike-mobile #userlike-chat-subheader #userlike-spinner.userlike-operator-connect-spinner{ left: 16px;}#userlike-chat-subheader #userlike-spinner.userlike-operator-connect-spinner div { width: 8px !important; height: 8px !important;}#userlike-chat-subheader #userlike-subheader-operator-info-text-wrapper { position: absolute; top: 17px; left: 88px; height: 20px;}#userlike.userlike-mobile #userlike-chat-subheader #userlike-subheader-operator-info-text-wrapper { left: 64px; max-width: 80%; white-space: nowrap; text-overflow: ellipsis;}#userlike-chat-subheader #userlike-subheader-operator-info-text { font-size: 13px; font-weight: bold;}#userlike-chat-form { position: absolute !important; top: 50px !important; right: 0 !important; bottom: 0 !important; left: 0 !important; display: block !important; margin: 0; padding: 0;}#userlike.userlike-chat-textarea-fullscreen #userlike-chat-form { top: 0 !important;}#userlike #userlike-chatHeadlineContainer { width: 175px !important; height: 16px !important; margin: 12px 10px 0 84px !important;}#userlike #userlike-poweredby { font-size: 11px; position: absolute; z-index: 2147483642; bottom: 16px; left: 40px; display: block; color: rgb(169, 176, 183);}#userlike.userlike-mobile #userlike-poweredby { left: 20px;}#userlike #userlike-poweredby-link { font-size: 11px; text-decoration: underline; color: rgb(169, 176, 183);}#userlike-data-privacy { position: absolute; z-index: 2147483642; right: 15px; bottom: 12px; display: none;}#userlike.userlike-mobile #userlike-data-privacy { display: none !important;}#userlike input[type="checkbox"],#userlike input[type="checkbox"]:focus,#userlike input[type="checkbox"]:hover,#userlike input[type="checkbox"]:active { display: inline; overflow: hidden; margin: 10px 5px 20px 0; padding: 0; border: none; border-radius: 0; box-shadow: none; -moz-appearance: checkbox; -ms-appearance: checkbox; -webkit-appearance: checkbox;}#userlike input[type="text"],#userlike input[type="email"] { width: 100% !important; margin: 20px 0 !important; padding: 26px 0 21px 0 !important; -webkit-appearance: none; -moz-appearance: none;}#userlike input,#userlike input[type="text"],#userlike input[type="email"] { font-size: 13px; font-weight: 400; display: block; overflow: hidden; box-sizing: border-box; padding: 8px 0 16px 0 !important; color: #4b4d4f; border-bottom: 1px solid rgba(211, 212, 213, .4);}/* Hack to prevent ios from zooming on inputs that have a font-size < 16 */#userlike.userlike-mobile textarea,#userlike.userlike-mobile textarea#userlike-chat-textarea,#userlike.userlike-mobile input[type="text"],#userlike.userlike-mobile input[type="email"]{ font-size: 16px !important;}#userlike.lt-ie9 input,#userlike.lt-ie9 input[type="text"],#userlike.lt-ie9 input[type="email"]{ border-bottom: 1px solid rgb(211, 212, 213);}#userlike textarea { white-space: pre-wrap;}#userlike input[type="radio"] { float: left !important; clear: none !important; overflow: auto; margin: 3px 0 0 1px !important; border: none; cursor: pointer;}#userlike.userlike-mobile input[type="radio"] { margin: 2px 0 0 1px !important;}#userlike.lt-ie9 input[type="radio"] { margin-top: 5px !important;}#userlike-screenshot-wrapper { display: inline-block; margin: 0 !important;}#userlike-screenshot-wrapper #userlike-screenshot-checkbox { margin: 1px 16px 4px 0;}#userlike.lt-ie9 #userlike-screenshot-wrapper > * { display: none;}#userlike-screenshot-label { display: inline;}#userlike textarea { line-height: 1.5 !important; overflow-y: auto; box-sizing: border-box; width: 100% !important; resize: none; -webkit-user-select: text; -moz-user-select: text; -ms-user-select: text; user-select: text; vertical-align: top; color: #4b4d4f; -webkit-appearance: none; -moz-appearance: none;}#userlike-offline-textarea { height: 110px !important; margin-bottom: 16px; border-bottom: 1px solid rgba(211, 212, 213, .4);}.lt-ie9 #userlike-offline-textarea{ border-bottom: 1px solid rgb(211, 212, 213);}#userlike-popup:after { position: absolute; width: 0; height: 0; content: \'\';}#userlike-chat-content { font-size: 13px; font-weight: 400; position: absolute; top: 0; right: 0; bottom: 110px; left: 0; display: block; overflow-y: auto; box-sizing: border-box; margin: 0 !important; padding: 16px 16px 16px 16px !important; word-wrap: break-word; word-break: break-word; -ms-word-break: break-word; border-top: 1px solid #e8e8e8; border-bottom: 1px solid #e8e8e8; overflow-wrap: break-word;}#userlike.userlike-mobile #userlike-chat-content{ bottom: 60px;}#userlike.userlike-mobile.userlike-chat-textarea-fullscreen #userlike-chat-content{ display: none !important;}#userlike-chat-content::-webkit-scrollbar { display: none;}#userlike-chat-content * { -webkit-user-select: text; -moz-user-select: text; -ms-user-select: text; user-select: text;}#userlike-chat-content .userlike-message-container { clear: both; margin-top: 8px;}#userlike-chat-content .userlike-message-container-ct { text-align: left;}#userlike-chat-content .userlike-message-container-co { text-align: right;}#userlike-chat-content .userlike-message-bubble { display: inline-block; max-width: 80%; padding: 16px 24px !important; border-radius: 20px;}#userlike.userlike-no-css-animation #userlike-chat-content .userlike-message-bubble #userlike-spinner { width: 17px; height: 17px;}#userlike-chat-content .userlike-message-bubble #userlike-spinner { position: relative; top: 2px;}#userlike-chat-content .userlike-message-bubble #userlike-spinner div { width: 12px !important; height: 12px !important;}#userlike-chat-content .userlike-message-bubble-co { border-bottom-right-radius: 0;}#userlike-chat-content .userlike-message-bubble-ct { border-bottom-left-radius: 0;}#userlike-chat-content .userlike-message-timestamp { font-size: 11px; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none;}#userlike-chat-content .userlike-message-timestamp.userlike-message-timestamp-co { text-align: right;}#userlike-chat-content img.userlike-url-info-image{ margin-top: 22px; height: auto; width: 100%;}#userlike-chat-content .userlike-url-info-title{ font-weight: bold;}#userlike #userlike-chat-content .userlike-emoji { vertical-align: middle; cursor: auto;}#userlike-chat-state { line-height: 16px; overflow: hidden; height: 16px; max-height: 16px; margin: -5px 0 0 15px; white-space: nowrap; text-overflow: ellipsis;}#userlike-chat-state > div { font-size: 12px !important; font-weight: 400 !important; color: #a9b0b7;}#userlike-offline-message form { height: 325px !important;}#userlike-feedback #userlike-feedback-form { height: 110px !important;}#userlike #userlike-feedback-textarea { width: 100% !important; height: 110px !important; padding: 16px 0 20px 0 !important; border-top: 1px solid rgba(211, 212, 213, .4);}#userlike.lt-ie9 #userlike-feedback-textarea { border-bottom: 1px solid rgb(211, 212, 213);}#userlike-transcript form { height: 140px !important;}#userlike-star-rating { position: relative !important; display: inline-block !important; height: 25px !important; margin: 16px 0 !important; padding: 0 !important; cursor: pointer;}#userlike-star-rating .userlike-icon { font-size: 22px !important; padding-right: 4px !important;}#userlike-offline-message-submit { position: relative; z-index: 2147483642; top: -9px; right: -8px; display: inline-block; float: right; width: 40px; height: 40px; cursor: pointer; border: none;}#userlike-offline-message-submit .userlike-icon { position: absolute; top: 5px; left: 5px;}#userlike-chat-scroll-textarea { position: absolute; right: 0; bottom: 0; left: 0; height: 100px;}#userlike.userlike-mobile #userlike-chat-scroll-textarea{ height: 70px;}#userlike #userlike-chat-textarea { font-weight: 400 !important; position: absolute !important; right: 0 !important; bottom: 0 !important; left: 0 !important; width: 100% !important; height: 100px !important; padding: 16px 40px !important;}#userlike.userlike-mobile #userlike-chat-textarea { height: 54px !important; padding: 0px 36px 10px 16px !important;}#userlike-emoji-button { position: absolute; z-index: 2147483642; top: 16px; right: 16px; width: 22px; height: 22px; cursor: pointer; border: none;}#userlike-emoji-list { position: absolute; top: 0; right: 50px; bottom: 0; left: 1px; display: none; overflow-y: auto; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; padding: 8px 40px; -moz-border-radius: 5px; border-radius: 5px;}#userlike.userlike-mobile #userlike-emoji-list { padding: 8px 16px;}#userlike-emoji-list.show { display: block;}#userlike-popup .userlike-emoji { width: 21px; height: 21px; cursor: pointer;}#userlike-emoji-list .userlike-emoji { padding: 3px 0 0 10px;}#userlike.userlike-mobile #userlike-emoji-list .userlike-emoji { padding: 4px 0 0 5px;}#userlike-register-submit,#userlike-transcript-submit,#userlike-facebook-connect-submit,#userlike-feedback-submit { position: relative; z-index: 2147483642; right: -12px; bottom: 14px; float: right; width: 40px; height: 40px; cursor: pointer; border: none;}#userlike-register-submit{ bottom: 11px;}#userlike-facebook-connect-submit{ bottom: 9px;}#userlike-register form { height: 380px;}#userlike-disclaimer-submit { position: absolute; z-index: 2147483642; right: 28px; bottom: 0; width: 40px; height: 40px; cursor: pointer; border: none;}#userlike-feedback-submit { bottom: 3px;}#userlike .userlike-fieldset-wrapper { clear: none; overflow: hidden; margin-top: 24px;}#userlike.userlike-mobile .userlike-fieldset-wrapper { margin-right: 0 !important;}#userlike .userlike-radio-wrapper { display: block; position: relative !important; margin-bottom: 16px; cursor: pointer;}#userlike .userlike-label { font-size: 13px !important; line-height: 1.5; left: 19px; position: relative; cursor: pointer;}#userlikePushIframe { position: fixed; z-index: 2147483640; top: 10%; right: 10%; bottom: 10%; left: 10%; overflow: hidden; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; width: 80%; height: 80%; margin: 0; padding: 0; color: #4b4d4f; -webkit-border-radius: 5px; -moz-border-radius: 5px; border-radius: 5px; background: #fff; box-shadow: 0 -5px 50px 0 rgba(0, 0, 0, .2);}#userlikePushIframeClose { position: absolute; color: #A9B0B7; height: 19px!important; width: 19px!important; padding: 0!important; font-size: 26px !important; border: none; z-index: 2147483642; right: 22px; top: 0; cursor: pointer;}#userlikePushIframeOpen { position:absolute; background-image: url(\'//dq4irj27fs462.cloudfront.net/icon_open.png\'); background-size: 100% 100%; top: 5px; right: 42px; height: 16px!important; width: 16px!important; border:none; z-index:2147483642; padding:0!important; cursor:pointer;}/* Animations */.userlike-flash { animation: userlike-flash-animation 1s ease-in infinite alternate;}@keyframes userlike-flash-animation { 50% { transform: scale(1.1); }}#userlike .userlike-icon.userlike-icon-close { font-size: 28px !important;}#userlike .userlike-icon.userlike-icon-minimize { font-size: 28px !important; margin-left: 4px !important;}#userlike .userlike-icon.userlike-icon-check { font-size: 30px !important; position: absolute !important; left: 2px !important;}#userlike .userlike-icon.userlike-icon-send { font-size: 34px !important;}#userlike .userlike-icon.userlike-icon-facebook { font-size: 30px !important;}/* IE8 will not load fonts if we use the data-url in one @font-face declaration */@font-face { font-family: "userlike_default"; font-weight: normal; font-style: normal; src: url("//dq4irj27fs462.cloudfront.net/userlike_default.eot"); src: url("//dq4irj27fs462.cloudfront.net/userlike_default.eot?#iefix") format("embedded-opentype");}@font-face { font-family: "userlike_default"; font-weight: normal; font-style: normal; src: url(data:application/x-font-woff;charset=utf-8;base64,d09GRgABAAAAABUsABAAAAAAIhQAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABGRlRNAAABbAAAABoAAAAceIDqwUdERUYAAAGIAAAAHAAAAB4AJwAbT1MvMgAAAaQAAABKAAAAYEDWXThjbWFwAAAB8AAAAEIAAAFCAA/0vWN2dCAAAAI0AAAAFAAAACQDmf+YZnBnbQAAAkgAAAXBAAAL4j+uG59nYXNwAAAIDAAAAAgAAAAIAAAAEGdseWYAAAgUAAAKZgAADsxx6+iYaGVhZAAAEnwAAAAuAAAANgeYwwFoaGVhAAASrAAAABwAAAAkA/ABxWhtdHgAABLIAAAALgAAADIIhgMibG9jYQAAEvgAAAAsAAAALCLOJwxtYXhwAAATJAAAACAAAAAgAYMCL25hbWUAABNEAAAA+gAAAgEzXt0UcG9zdAAAFEAAAABsAAAA3H7RM+ZwcmVwAAAUrAAAAIAAAACNE0njCnicY2BgYGQAgkvSGTYg+rLRQScYDQA5dgWjAAB4nGNgZGBg4AFiMSBmYmAEQhEgZgHzGAAEegBDeJxjYGFiYJzAwMrAwOjDmMbAwOAOpb8ySDK0MDAwMbByMsCBAILJEJDmmsLQ8JHxoxDjgf8HGPQYDzA4AIUZkZQoMDACAAueC6MAAHicY2BgYGaAYBkGRgYQsAHyGMF8FgYFIM0ChED+R6H//4Ek4////ExQlQyMbAwwJgMjE5BgYkAFjAzDHgAAT/YGvgAAeJxjYMACeCCQ8cD/AyAMABZoBTF4nK1WaXPTVhSVvMVJyFKy0KIuT7w4Te0nk1IIBkwIkmUX3MXZWglKK8VOui/QMsNv0K+5Mu0M/cZP67mSbQxJ2hmmmYzuee8dvbtfmTQlSNv3XF+I9jNtdrtNhd17Hl02aM0PjkS071GmFP5d1IpatysPDNMkzSfNkY2+pmtOYFukKxLBkUUZJXqCnncot3qvv6ZPOW7XpYLrmZQt+Tv3PVOaRuQJ6nSwteUbgmqMar4v4pQd9mgNW4OVoHU+X2fm844nYE0UCprqeAF2BJ9NMdpgtBEYge/7BukV35ekdbxD37coqwTuyZVCWJZ3Oh7lpU0FacMPn/TAopySsEv04vyBLfiELTZSC/gJktulbNnEoSMiEUFBvJ4vwcltL+gY4Y7vSd/0BW3tejgz2LWBfovyiiacSl/LpJEqYCltiYhLO6TMwRHpXSigfNmiCSXY1Gmn+yynHQi+gbYCnylBIzG1qPoT05rj2mVzFPtJ9XIuptJb9ApMcOB3INxIhpyXJF6awTElYcDIoZXIjgwbqYrpU16nFbylGS9cG3/pjEoc6k9PZZFsQ5p+2bRoRsWZjEu9sGHRrAJRCDrj3OXXAaTt0wyvdrCawcqiOVwzn4REIAJd6KVZJxBRIGgWQbNoXrX3vDjXa/grNHMon1j0hmpve+3ddNMwsb+Q7J9VsTbn7Hvx3BwSGNo0V+GaRSXb8Rl+zOBB+jIykS11vJiDB2/tCPlltWVT4rUhNtJzfgWtwDs+PGnB/hZ2X07VKQmMNW1BIloOaZt9XdeTXC0oLdYy7p5Hc9IWLk2j+KagOLBFAPV/zc/r2qxm21EQny1U6HHFuIAwLcK3hYpFSyrWWS4jzizPqTjL8k0V51i+peI8y/MqLrA0VDzB8m0VF1m+o+JJlh8oOYw7FQJEWIoq6Q+4QSwqjx0ujw4fpoeVscPV0eGj9PBdpdFM5TX8ew/+vQu7BPxjacI/lhfgH0sJ/1iuwD+WJfjHchX+sXwf/rFcg38slRL1pEwtBbXzgXDYBCdJJVpPca1WFVkVstCFF9EALXFKFmVYkzwR/5VhsPfro9Tqy3SxHOf1JdfDIGMHPxyPzPHjS0pcSez9CDzdPa4E3Xmict7Xlv/U+K+xKWvxJX0JHl2G/zD4ZHvRFGHNoiuqeq5u0cZ/UVHAXdCvIiXacklURYsbH6G8E0Ut2cKk8PCFwGDFNNjQ9aVF6K9hQi2jufCfUGjSqRxGVSlEPcJd114ci2p6B+VwJ1iCAp4VW9ve04zICuNpZjV73rd5fhYximXClk10rvNqGwY8w9LPRcYJepKyTtjDccYJDeCA59er74QwCVNdNpFDCQ1N+AWRaMF9JyiR6aTMYTgg9nkUVP7YrbiRPSolRuDZSSfkC11I+XWOgcBOfnUQA1lHaG4k21RE8wjRlC1WxtmqJyFjBwYR1fa8qqjj68oWDzYF2zIMeaGE1Z3xD3maqJMqeJAZyWV8c2CBM0xNwF/6V10cpnIT86DKUWtiqNf9alzVF9GAt0bbnfHtrZfZJ3JuK6pVTrzUVnStEkExFwusPc5BWqpUBdUZVdgwulxcEqVeRZOk1zUwNDD/X6MUW/9X9bH5PF/qEiNkLN+mP7DR5WAM/W+y/6YcBGDgx8jlFlxeSpsTvwzQhwtVuoxe/PiU/TuYufriAl0BvqvoKkSbo+YirqKJz+AwTp8oLkdqA36q+pgzAJ8B6Aw+V3092ekAJDvbzHEBdpjDYJc5DPaYw2CfObcBvmAOgy+Zw8BjDgOfOQ7APeYwuM8cBl8xh8ED5jQBvmYOg2+YwyBgDoOQOTbAAXMYdJnDoMccBoeKro/CfMQL2gT6NkG3gL5L6gmLLSy+V3RjxP6BFwn7xwQx+6cEMfVnRfUR9RdeJNRfE8TU3xLE1IeKbo6oj3iRUH9PEFP/SBBTH6unk7nM8IeXXaHiIWVXOk+G3xTrH4qiY04AAAAAAQAB//8AD3icrVdbbBzVGT7/mTnnzM6sZ/YyF9u7vs3YM7bXt3j2ksR2PE1IbK9rkpo4xg4CErNxSJMQ4t6gUpQgpUEIhYRSUaqWVhWKVIEqKiEh0T7w0otKkVDVJx5Qn/pQ8VS1L60U+p/ZJI3a8sZqdW7znznnv3zf/w+hJE8IeQ3WiEIEGU0inCmUKCcIBaBrhFLYUHEEK4QIzlQUU/JMOJU4H+ejOB/kn//mqVOwdvvNPMS4l5KYhPAxbBKbBORAkuRAod0ax21lwN3NkqDqgjyCKuQCISol6nmiqk8TwKPWCR51HI+mh6NCEE0z0VVp2N5U4EeiEdaq9Xja9cLA5/Vp17GFF/HAn4Ba9ZfTMBbOdTTOrux+xOn1k83WuZUpPup1BXPBj2PfDOeH9+w+MjGoH5jaOzLRO9otuidKI+Tefd/H+zokImPJCN4XShlKFRXwik2C04t4XeUiitKLuOPJYHx0QBWdlSEur8XDeWjfzDPBsd2G5/JJwEehXOvFJfCCaGQw4Qrt6ttMDk2MzQz8wlRUFnT1VmZnK6Wp0p6ik6eMTY/EyWZdW5j09/b1qoxmc7Nrs+XJso+nqmTlzj27yAAZIVXSSKo6kAUCGlfxfkC3BEObEmVd9grZwCFZqYzumhqtVqrFYtGplzKiuzJkCgtqAQ/noFqfgWm3B+zQ57Y7Xa/e7SM/1UWuwA21o+A4TsFU1Ym5B5fib8dLDxVNs9hxRrbm14QusDO/pWT0jmxW16iyjx2s8XhxMeazRzpS0XbLDZ6RPUn12ST98JM0TnwyQfaQfckMAV2wjIqmV7Y0TlUUW5e9SjYoSBNMTbpONZ7cM7VndGQw6Ck5vusP1foN4VUaaHGpUTyQasQrIHjUaOsRT+/DIAlHgTt2L6STqK1prToBH7SYEAzGmSb4ExUhHmMZZmhM49n1nMEyeoZ9VTMMOTyvsT8yLW0OGMbvUE4z0gbFM6w9yrUnUkcgO+iza6hjjZxafjtz5OHEF6iHSrYJwyBn9IQCoKqwjh2oxzmooB4uJQNSCPd+vsxG4gCJd42NDA70loo5XZAa1DRhVxp+FNbnQfp1H6A5wgqgCdAevVS6WprFv9/xqZk+0DgHvsLFhJYVOeMmtqrIcEvqZZXCqHSzFIalcJGHguV4k4kO0crmtKzWYrqmGrlsVGqVo6jcKkUP8NS3p1DvH6DeGWKRITIlY3U8QlbhSCSENl2LwgKGJygELiDkn0akKXQdyUY5LrF2uDzRaUuIoSZRGAjXc0UoB40y7AosmKdT0xJwvWBbSgNFUAuU+eAmdBjWzQ5Dz4JhmPklYCcHPlKoSt18RkNmGemCrGHSLpRo3bSM7MuqbnRnDaOKD9WBkx8B5PVOgyrU7LKyRpdq6Aihu7qYpAcZ7fFED/yB/h6GQdpcfttAn/YhieEhp9HfVEUYEglC5NO7ECwl/W0J5cLniWy8W3ig0/6KpLshLxgFjGWklJTjMEQRlTKI90I8CYHjNSJ4prdkr3Qe2Ny8vLmnb/nM8vJu94F8ca17ohCenN1Mks3NpNo/OFVbXq7Vm+GPTkwUJK8zxNwp+CHydAkxN0TGkUWWkkPTI4N+H1PpZBlJjzbv3pUBQXephJ5AR0F6W9iQdLgSBEDGKsNRMBQMFTVSgm6BodcOKIHMF/i7Bqb8QLL2BKSYFLbXqDeihtewIEbO9HFYnUOnwSXL8pD4AW7/ExtKs0bR0GAJ4MvG5ctv7v94/5AilMWlZYC4aNzo5ChT0G9Y1s8pXQcY85rNB1dXHUp71ym9MoZXJt1kE/NPgpHXgzxZIwfIEjmWPDRfp7oHBl1CQ+gq0U9gmDKqMkx0RMlQTHgGyXAjs4WvEBoXWwSDQlsjmia11mBlafHQwf1fqsb4q1VrcVb0VBq1//BNMICZqI0rxzYBcVZvz1LMufeNG+hMnNRRfzTEPASeO31LY9AtqeX2X5j2omDbTFO5ss3GBKvK5SoraCwV6GargqNQy+g3xo/+4ahwT33IheAfIomdMlAA903omjC0g4YQhnjxltx164lstrC6KjAAI1KET+BR4pKepDsPCL+mTLgX8RGk+c3udBQkVGJblPuTNKwiCqf7oCEb+ET7MNQ8LdzWtEhztYfewyaCYVf7fShE2MJZqGmr72paKPnvBdKEb0Ad4w3PckyhyNPQ23iSAnhUp91ZSFMpWkKeE2HSbB/l2hZ4aC8/ArLOcjpbX2d6Trb3xrf+Z6U9Jlky89m/4NdwFSsaB6Mgwhw/g3GwTI6Rx8lZ8iycTwrPPnX2zBYz7MegoFmQKSh30IyAVGV8XOgAwzZt4zTBZ4XM6U7gGDFc3fKcrKK7YBu6vZUDMw+WZlpbxS6qkUJGKyBaUEGmwBaRaWWdMCaOE8HE4dLy2wU8YPP/H6Bc+AJOSI7/18vNC1/c2zc2ktrIcH/v13fOnzu9ffLEo8cfXj929PCDy82FQwf2z++b2duoT44PxyPTg0Fv1B8VbX+oWMBSq1KXXIa+LCI0ZNGECblNa+1iY1f6EF3vTUvopOQXh3f23N3r3unDNi9KMS9AQUSSg/WLqN4jTF+06zFZezlHW9dbrevvzLcWVuPJucXWipy23lrd2XljZ+d7wvbtvoroM23Lsq9atmnavpHT9dzf9Vya2X/zMojviCshQwl4KWRg6cLgz6QvgV3x6kJrPmotzh1LT7kk3/nGzl95ob8wXOaxY5p3/92WYbT/WOCwrEo5p6tFVdFNU1fUYjriWa6o7brhdYzfbYxfl8TJFJFE3JR5cQe5iaAfTzBJlbDGJGVieY7wXQny+HMGhChVwAl8k/ZALAInqAW1ODUHbA/piMCDmdmFmZmpER+e28d0Qxs/9M47h+KxXeQeXsnTSIWdiYMLQNbk+obkhpV4mgq3cj+rvaD3vN6jy+ZwD2M9LH2H/dmf4FN4i/RLzBdzBldkHdNMy2eQoC8PRpJfhlKEO3bgT4LMGrUU/9hSpADqwqdiuxOynF2+zFkWOrdF7nrCczy5nvsH1868oiiWsrCgWMBeOaNxQ3GvZbPXXKVd05PP3qcE3k+xHyZBOChzdl+pu6uYNXQTlWnKm16UeedJf6worwOTEPrIeD3gCVklzkDDiyVJR8jyeFP8AEGu9uDPV2eMUWPmav85j1mGfuWKnrO8c+Nnup57ruvMd5MEXPtSZ+clm5Wtp26omtmxsOBl2UtPWeWBs68uLLx61nv++dROJ4kPryMP9xA3KZY9u1jQhaKRRUnBZcAvLHCFkubTtn0irNsaIgqjamNIuvM1WbJi2USPjCqcUvH9Xx0UwGFIfrk8wsTtvyGGoT9moGhz7/20rAih/AyNgt8RFfgtGmAPmUgqu4Eqk4N+GWOINu985tyfCxCHQ2i1vCoTfB3LMC5s7kxxhwuTyjtFYaMeu412HzYQjumC53rVxj7AGs316vAeU1Ul66K1lezs0cmCVRthlPKRKDLw65B2G0wxXEVhECwDm+xTM6FThG7KFFZysd5VQBPjhyKa6VMZU0xrFDf7wyz0sYBcKrNM3zDwAYX8G0gH4HsAAHicY2BkYGAA4rnCDCfj+W2+MsgzMYDAZaODTgj6/wEmBsYDQC4HA1gaAA/0CdgAAHicY2BkYGA88P8Agx4TAwgASUYGVMACAFCUArl4nGNiYBBkAAImCDYGQl+GKIZihjQgjGKQYlBn6GKwZpgHJEWASpIYfAFpRgWvAAAAAAAoACgAKACAANQBPAGuAioCkAL2A2gD+AQuBGoFygYGBigGaga8BvgHZgABAAAAFQB7AAwAAAAAAAIANABEAHcAAAC2AW4AAAAAeJydj0FqwzAUREeJnVIoJUcQ3XRTG0kNJWQbyKa7LELpJhiiGBNhgxxfpTfohXqWHCAj96+6KUTw9R9fMxoJwAO+oJCWwhxPwhPcYS08xQu+hTNqLsI55upZeEb+pFJl95zo0ZV4gke8Ck/xgXfhjJof4Rxa5cIz8hIDenhEBDQ4kfY4cD+i4knAGRh6H0Nz8vuDP1ZD4GRLQT0eVzRi6+shVIQNOrS0pB6p8Ax2KGHYV6z/on5Vlp4CC5aj0+KNF3ftedPF2mtXGr3Sf5/EkXXFonDGUn3Dj3ajoach/UAzNyWXY0+vx87HvulabYwtjTH6lpQrH4BYQAAAeJxdzTkSgkAARNH5o4iCuGAZcIuZQVBCXLgLiZl34pZoQUf+5FV10saaqXEwxQ/Mf+dptVgWLIlYEbNmQ0LKlowdew4cyTnFn3ffeedlkKW8yErW8ipvspGtvMuHfMqX7Ga9k/r34Qs9fypHeJxj8N7BcCIoYiMjY1/kBsadHAwcDMkFGxnYnTYxMDJogRibeZgYOSAsAQYwi8NpF7MDUJoTyOZ02sUAZTMzuGxUYewIjNjg0BGxkTnFZaMaiLeLo4GBkcWhIzkkAqQkEgg28zEx8mjtYPzfuoGldyMTg8tm1hQ2BhcXAOttJS8=) format("woff"), url("//dq4irj27fs462.cloudfront.net/userlike_default.eot") format("truetype");}#userlike .userlike-icon,#userlike i.userlike-icon,#userlikePushIframe .userlike-icon,#userlikePushIframe i.userlike-icon,#userlikePushIframe [class*="-icon"],#userlikePushIframe [class*="icon-"],#userlikePushIframe i[class*="-icon"],#userlikePushIframe i[class*="icon-"] { font-family: "{{ICON_FONT}}" !important; font-weight: normal !important; font-style: normal !important; line-height: 1 !important; display: inline-block !important; cursor: pointer; vertical-align: middle !important; text-decoration: inherit !important; text-transform: none !important; speak: none !important; text-rendering: auto !important; margin: 0 0 0 0!important; -webkit-font-smoothing: antialiased !important; -moz-osx-font-smoothing: grayscale !important; -webkit-touch-callout: none; -webkit-tap-highlight-color:rgba(0,0,0,0);}.userlike-icon.userlike-button-01:before { content:"\\f101";}.userlike-icon.userlike-button-02:before { content:"\\f102";}.userlike-icon.userlike-button-03:before { content:"\\f103";}.userlike-icon.userlike-button-04:before { content:"\\f104";}.userlike-icon.userlike-button-05:before { content:"\\f105";}.userlike-icon.userlike-button-06:before { content:"\\f106";}.userlike-icon.userlike-button-offline-01:before { content:"\\f107";}.userlike-icon.userlike-button-offline-02:before { content:"\\f108";}.userlike-icon.userlike-button-offline-03:before { content:"\\f109";}.userlike-icon.userlike-icon-check:before { content:"\\f10a";}.userlike-icon.userlike-icon-close:before { content:"\\f10b";}.userlike-icon.userlike-icon-emoticon:before { content:"\\f10c";}.userlike-icon.userlike-icon-facebook:before { content:"\\f10d";}.userlike-icon.userlike-icon-minimize:before { content:"\\f10e";}.userlike-icon.userlike-icon-rating:before { content:"\\f10f";}.userlike-icon.userlike-icon-rating-inactive:before { content:"\\f110";}.userlike-icon.userlike-icon-send:before { content:"\\f111";}.userlike-icon.userlike-icon-twitter:before { content:"\\f112";}.userlike-emoji { background-image: url(\'//dq4irj27fs462.cloudfront.net/spritemap_emojis.png\') !important; background-repeat: no-repeat !important; display: inline-block !important;}@media only screen and (-webkit-min-device-pixel-ratio: 2),only screen and (min-device-pixel-ratio: 2) { .userlike-emoji { background-image: url(\'//dq4irj27fs462.cloudfront.net/spritemap_emojis@2x.png\') !important; background-size: 155px 155px !important; }}.userlike-emoji-emoji_angry { width: 21px !important; height: 21px !important; background-position: -5px -5px !important;}.userlike-emoji-emoji_blushing { width: 21px !important; height: 21px !important; background-position: -36px -5px !important;}.userlike-emoji-emoji_confused { width: 21px !important; height: 21px !important; background-position: -67px -5px !important;}.userlike-emoji-emoji_cool { width: 21px !important; height: 21px !important; background-position: -98px -5px !important;}.userlike-emoji-emoji_embarrassed { width: 21px !important; height: 21px !important; background-position: -129px -5px !important;}.userlike-emoji-emoji_evil { width: 21px !important; height: 21px !important; background-position: -5px -36px !important;}.userlike-emoji-emoji_frown { width: 21px !important; height: 21px !important; background-position: -36px -36px !important;}.userlike-emoji-emoji_gasp { width: 21px !important; height: 21px !important; background-position: -67px -36px !important;}.userlike-emoji-emoji_grimmace { width: 21px !important; height: 21px !important; background-position: -98px -36px !important;}.userlike-emoji-emoji_grin { width: 21px !important; height: 21px !important; background-position: -129px -36px !important;}.userlike-emoji-emoji_innocent { width: 21px !important; height: 21px !important; background-position: -5px -67px !important;}.userlike-emoji-emoji_kiss { width: 21px !important; height: 21px !important; background-position: -36px -67px !important;}.userlike-emoji-emoji_lips_are_sealed { width: 21px !important; height: 21px !important; background-position: -67px -67px !important;}.userlike-emoji-emoji_mischievous { width: 21px !important; height: 21px !important; background-position: -98px -67px !important;}.userlike-emoji-emoji_oops { width: 21px !important; height: 21px !important; background-position: -129px -67px !important;}.userlike-emoji-emoji_shouting { width: 21px !important; height: 21px !important; background-position: -5px -98px !important;}.userlike-emoji-emoji_sleeping { width: 21px !important; height: 21px !important; background-position: -36px -98px !important;}.userlike-emoji-emoji_smile { width: 21px !important; height: 21px !important; background-position: -67px -98px !important;}.userlike-emoji-emoji_smirk { width: 21px !important; height: 21px !important; background-position: -98px -98px !important;}.userlike-emoji-emoji_straight_faced { width: 21px !important; height: 21px !important; background-position: -129px -98px !important;}.userlike-emoji-emoji_tongue { width: 21px !important; height: 21px !important; background-position: -5px -129px !important;}.userlike-emoji-emoji_undecided { width: 21px !important; height: 21px !important; background-position: -36px -129px !important;}.userlike-emoji-emoji_wink { width: 21px !important; height: 21px !important; background-position: -67px -129px !important;}.userlike-emoji-emoji_wink_tongue { width: 21px !important; height: 21px !important; background-position: -98px -129px !important;}.userlike-emoji-icon_emoticon { width: 21px !important; height: 21px !important; background-position: -129px -129px !important;}';
Cookies=function(){var extend,init;extend=function(){var attributes,i,key,result;i=0;result={};while(i<arguments.length){attributes=arguments[i];for(key in attributes){if(!hasProp.call(attributes,key))continue;result[key]=attributes[key]}i++}return result};init=function(converter){var api;api=function(key,value,attributes){var cookie,cookies,e,error,error1,error2,expires,i,name,parts,rdecode,result;result=void 0;if(arguments.length>1){attributes=extend({path:"/"},api.defaults,attributes);if(typeof attributes.expires==="number"){expires=new Date;expires.setMilliseconds(expires.getMilliseconds()+attributes.expires*864e5);attributes.expires=expires}try{result=JSON.stringify(value);if(/^[\{\[]/.test(result)){value=result}}catch(error){e=error}if(!converter.write){value=encodeURIComponent(String(value)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent)}else{value=converter.write(value,key)}key=encodeURIComponent(String(key));key=key.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent);key=key.replace(/[\(\)]/g,escape);return document.cookie=[key,"=",value,attributes.expires&&"; expires="+attributes.expires.toUTCString(),attributes.path&&"; path="+attributes.path,attributes.domain&&"; domain="+attributes.domain,attributes.secure?"; secure":""].join("")}if(!key){result={}}cookies=document.cookie?document.cookie.split("; "):[];rdecode=/(%[0-9A-Z]{2})+/g;i=0;while(i<cookies.length){parts=cookies[i].split("=");name=parts[0].replace(rdecode,decodeURIComponent);cookie=parts.slice(1).join("=");if(cookie.charAt(0)==='"'){cookie=cookie.slice(1,-1)}try{cookie=converter.read?converter.read(cookie,name):converter(cookie,name)||cookie.replace(rdecode,decodeURIComponent);if(this.json){try{cookie=JSON.parse(cookie)}catch(error1){e=error1}}if(key===name){result=cookie;break}if(!key){result[name]=cookie}}catch(error2){e=error2}i++}return result};api.get=api.set=api;api.getJSON=function(){return api.apply({json:true},[].slice.call(arguments))};api.defaults={};api.remove=function(key,attributes){api(key,"",extend(attributes,{expires:-1}))};api.withConverter=init;return api};return init(function(){})}();userlike={};window.messenger={};popup=null;idle_view=null;progress_view=null;message_view=null;disclaimer_view=null;offline_message_view=null;register_view=null;group_select_view=null;survey_view=null;chat_view=null;transcript_view=null;rating_view=null;feedback_view=null;twitter_view=null;facebook_view=null;feedback_rating_composite_view=null;social_composite_view=null;slot=null;pusher=null;fsm=null;session=null;config=null;sound=null;goal=null;button=null;tracking=null;tracking_event=null;facebook=false;twitter=false;git_version="faf7df48a81098660d54dde06a2351fd73708626 ";is_mobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(typeof navigator!=="undefined"&&navigator!==null?navigator.userAgent:void 0);window._ullog=function(){var ref1;if(((ref1=window.__utils__)!=null?ref1.echo:void 0)&&this.console){__utils__.echo("Client: "+Array.prototype.slice.call(arguments))}if(this.console&&(typeof localStorage!=="undefined"&&localStorage!==null?localStorage.getItem("uslk_debug"):void 0)){return Function.prototype.apply.call(console.log,console,arguments)}};window.UL_EMOTICONS=[{image:"emoji_smile.png",equivalents:[":-)",":)",";)"],code:":-)",name:"Smile"},{image:"emoji_wink.png",equivalents:[";-)",";)"],code:";-)",name:"Wink"},{image:"emoji_wink_tongue.png",equivalents:[";-P",";P",";-p",";p"],code:";-P",name:"Wink Tongue"},{image:"emoji_grin.png",equivalents:[":-D",":D"],code:":-D",name:"Grin"},{image:"emoji_blushing.png",equivalents:[":-]",":]",":-`"],code:":-]",name:"Blushing"},{image:"emoji_kiss.png",equivalents:[":-*",":*"],code:":-*",name:"Kiss"},{image:"emoji_cool.png",equivalents:["B-)","B)","8-)","8)"],code:"B-)",name:"Cool"},{image:"emoji_innocent.png",equivalents:["O:-)","O:)","o:-)","o:)","0:-)","0:)"],code:"O:-)",name:"Innocent"},{image:"emoji_tongue.png",equivalents:[":-P",":P",":-p",":p"],code:":-P",name:"Tongue"},{image:"emoji_smirk.png",equivalents:[":->",":>"],code:":->",name:"Smirk"},{image:"emoji_lips_are_sealed.png",equivalents:[":-X",":-x"],code:":-X",name:"Lips Are Sealed"},{image:"emoji_confused.png",equivalents:[":-?",":?"],code:":-?",name:"Confused"},{image:"emoji_embarrassed.png",equivalents:[":-[",":["],code:":-[",name:"Embarrassed"},{image:"emoji_frown.png",equivalents:[":-(",":("],code:":-(",name:"Frown"},{image:"emoji_gasp.png",equivalents:[":-o",":o",":-O",":O","=-o","=-O"],code:":-o",name:"Gasp"},{image:"emoji_grimmace.png",equivalents:["X-(","x-(","X(","x("],code:"X-(",name:"Grimmace"},{image:"emoji_mischievous.png",equivalents:[">:-)",">:)"],code:">:-)",name:"Mischievous"},{image:"emoji_oops.png",equivalents:[":-!",":!"],code:":-!",name:"Oops"},{image:"emoji_shouting.png",equivalents:[">:-O",">:O",">:-o",">:o",":-@",":@",">:-@",">:@",">:-V",">:V",":-V",":V"],code:">:-O",name:"Shouting"},{image:"emoji_sleeping.png",equivalents:["|-)","I-)","I-|","|-|","|-*","|-*","|-.","|-."],code:"|-)",name:"Sleeping"},{image:"emoji_straight_faced.png",equivalents:[":-|",":|",":-I",":I"],code:":-|",name:"Straight Faced"},{image:"emoji_undecided.png",equivalents:[":-U",":U"],code:":-U",name:"Undecided"},{image:"emoji_evil.png",equivalents:[">:-D",">:D"],code:">:-D",name:"Evil"},{image:"emoji_angry.png",equivalents:[">:-(",">:("],code:">:-(",name:"Angry"}];KeyHandlerFactory=function(){function KeyHandlerFactory(){}KeyHandlerFactory.prototype.get=function($input,fsm){if(!config.data_privacy&&config.live_preview){return new KeyHandlerLivePreview($input,fsm)}else{return new KeyHandler($input,fsm)}};return KeyHandlerFactory}();KeyHandlerFactoryAndroid=function(){function KeyHandlerFactoryAndroid(){}KeyHandlerFactoryAndroid.prototype.get=function($input,fsm){if(!config.data_privacy&&config.live_preview){return new KeyHandlerLivePreviewAndroid($input,fsm)}else{return new KeyHandlerAndroid($input,fsm)}};return KeyHandlerFactoryAndroid}();KeyHandler=function(){KeyHandler.PAUSED="Paused";KeyHandler.COMPOSING="Composing";KeyHandler.ACTIVE="Active";KeyHandler.CHAT_STATE_INTERVAL=5e3;KeyHandler.PREVIEW_INTERVAL=500;KeyHandler.fsm=null;KeyHandler.$input=null;KeyHandler.chat_state_timer=null;KeyHandler.chat_state_last_input="";KeyHandler.chat_state_last_length="";KeyHandler.prototype.key_action_event_name="keypress";function KeyHandler($input1,fsm1){this.$input=$input1;this.fsm=fsm1;this.handler=bind(this.handler,this);this.chatStateTimer=bind(this.chatStateTimer,this);this.chat_state=KeyHandler.PAUSED;this.$input.off().on(this.key_action_event_name,this.handler);this.$input.blur(function(_this){return function(){return _this.changeChatState(KeyHandler.PAUSED)}}(this));this.$input.focus(function(_this){return function(){return _this.changeChatState(KeyHandler.ACTIVE)}}(this))}KeyHandler.prototype.chatStateTimer=function(){if(this.chat_state===KeyHandler.COMPOSING&&this.$input.val().length===this.chat_state_last_length){return this.changeChatState(KeyHandler.PAUSED)}else if(this.chat_state===KeyHandler.COMPOSING){this.chat_state_last_length=this.$input.val().length;clearTimeout(this.chat_state_timer);return this.chat_state_timer=setTimeout(this.chatStateTimer,KeyHandler.CHAT_STATE_INTERVAL)}};KeyHandler.prototype.changeChatState=function(newChatState){this.chat_state_last_input=this.chat_state;this.chat_state=newChatState;if(this.chat_state!==this.chat_state_last_input){_ullog("KeyHandler changeChatState name="+this.chat_state);return this.fsm.event("state"+this.chat_state)}};KeyHandler.prototype.clearTimer=function(){clearTimeout(this.chat_state_timer);return this.chat_state_timer=null};KeyHandler.prototype.handler=function(e){var key_code;e=_jq.event(e);key_code=e.which;if(key_code===13&&e.shiftKey){}else if(key_code===13){this.changeChatState(KeyHandler.PAUSED);fsm.event("inputEnter");this.clearTimer();_jq.event(e).preventDefault()}else{this.changeChatState(KeyHandler.COMPOSING);clearTimeout(this.chat_state_timer);return this.timer=setTimeout(this.chatStateTimer,KeyHandler.CHAT_STATE_INTERVAL)}};return KeyHandler}();KeyHandlerAndroid=function(superClass){extend1(KeyHandlerAndroid,superClass);function KeyHandlerAndroid(){return KeyHandlerAndroid.__super__.constructor.apply(this,arguments)}KeyHandlerAndroid.prototype.key_action_event_name="keyup";KeyHandlerAndroid.prototype.isAndroidQuirksKeycode=function(key_code){return key_code===0||key_code===229};KeyHandlerAndroid.prototype.getKeycodeFromInputText=function(input_text){var char_code;if(input_text==null){return-1}char_code=input_text.charCodeAt(input_text.length-1);if(char_code===10){return 13}};KeyHandlerAndroid.prototype.handler=function(e){var key_code;if(this.isAndroidQuirksKeycode(key_code)){key_code=this.getKeycodeFromInputText(_jq(e.target).val())}e.which=key_code;return KeyHandlerAndroid.__super__.handler.call(this,e)};return KeyHandlerAndroid}(KeyHandler);KeyHandlerLivePreview=function(superClass){extend1(KeyHandlerLivePreview,superClass);function KeyHandlerLivePreview(){this.handler=bind(this.handler,this);this.livePreviewTimer=bind(this.livePreviewTimer,this);return KeyHandlerLivePreview.__super__.constructor.apply(this,arguments)}KeyHandlerLivePreview.prototype.clearTimer=function(){KeyHandlerLivePreview.__super__.clearTimer.call(this);clearTimeout(this.live_preview_timer);this.live_preview_timer=null;return this.live_preview_last_input=""};KeyHandlerLivePreview.prototype.livePreviewTimer=function(){var val;val=this.$input.val();if(val!==this.live_preview_last_input&&val.indexOf(config.default_textarea)===-1){_ullog("KeyHandlerPreview livePreviewTimer send event livePreview val="+this.$input.val());this.live_preview_last_input=val;this.fsm.event("livePreview",val)}clearTimeout(this.live_preview_timer);this.live_preview_timer=null;return this.live_preview_timer=setTimeout(this.livePreviewTimer,KeyHandler.PREVIEW_INTERVAL)};KeyHandlerLivePreview.prototype.handler=function(e){KeyHandlerLivePreview.__super__.handler.call(this,e);return this.live_preview_timer=this.live_preview_timer||setTimeout(this.livePreviewTimer,KeyHandler.PREVIEW_INTERVAL)};return KeyHandlerLivePreview}(KeyHandler);KeyHandlerLivePreviewAndroid=function(superClass){extend1(KeyHandlerLivePreviewAndroid,superClass);function KeyHandlerLivePreviewAndroid(){this.handler=bind(this.handler,this);this.livePreviewTimer=bind(this.livePreviewTimer,this);return KeyHandlerLivePreviewAndroid.__super__.constructor.apply(this,arguments)}KeyHandlerLivePreviewAndroid.prototype.clearTimer=function(){KeyHandlerLivePreviewAndroid.__super__.clearTimer.call(this);clearTimeout(this.live_preview_timer);this.live_preview_timer=null;return this.live_preview_last_input=""};KeyHandlerLivePreviewAndroid.prototype.livePreviewTimer=function(){var val;val=this.$input.val();if(val!==this.live_preview_last_input&&val.indexOf(config.default_textarea)===-1){_ullog("KeyHandlerPreview livePreviewTimer send event livePreview val="+this.$input.val());this.live_preview_last_input=val;this.fsm.event("livePreview",val)}clearTimeout(this.live_preview_timer);this.live_preview_timer=null;return this.live_preview_timer=setTimeout(this.livePreviewTimer,KeyHandler.PREVIEW_INTERVAL)};KeyHandlerLivePreviewAndroid.prototype.handler=function(e){KeyHandlerLivePreviewAndroid.__super__.handler.call(this,e);return this.live_preview_timer=this.live_preview_timer||setTimeout(this.livePreviewTimer,KeyHandler.PREVIEW_INTERVAL)};return KeyHandlerLivePreviewAndroid}(KeyHandlerAndroid);Position=function(){function Position(){var ref1,ref2,ref3,ref4;this.$button=_jq(button.el());this.$popup=_jq("#userlike-popup");this.drag=session.getDrag()||{};if(!this.drag.snap&&((ref1=this.drag)!=null?(ref2=ref1.pos)!=null?ref2.top:void 0:void 0)!=null&&((ref3=this.drag)!=null?(ref4=ref3.pos)!=null?ref4.left:void 0:void 0)!=null){_ullog("Position::ctor use stored position top="+this.drag.pos.top+" left="+this.drag.pos.left+" snap="+this.drag.snap)}else{this.snap();_ullog("Position::ctor use button position")}this.setupEvents()}Position.prototype.snap=function(){_ullog("Position::snap");this.drag.snap=true;this.drag.down=false;return session.persistDrag(this.drag)};Position.prototype.update=function(){var e,error;if(!isElementInViewport(this.$popup.get())&&!this.drag.down){this.snap()}if(this.drag.snap){this.drag.pos=button.popupPosition()}try{this.$popup.css(this.drag.pos);if(this.isInDefaultPosition()){return button.slideOut()}else{return button.show()}}catch(error){e=error;return _ullog("Position:update error=",e," drag=",this.drag)}};Position.prototype.isInDefaultPosition=function(){return this.drag.snap&&popup.isVisible()};Position.prototype.setupEvents=function(){var $area;if(is_mobile){return}$area=_jq(".userlike-drag");$area.css({cursor:"move"});$area.on("mousedown",function(_this){return function(e){_this.startDrag(e);return false}}(this)).on("touchstart",function(_this){return function(e){_this.startDrag(e);return false}}(this));return _jq(document).on("mouseup",function(_this){return function(e){return _this.stopDrag(e)}}(this)).on("mousemove",function(_this){return function(e){return _this.moveDrag(e)}}(this)).on("touchend",function(_this){return function(e){return _this.stopDrag(e)}}(this)).on("touchmove",function(_this){return function(e){return _this.moveDrag(e)}}(this))};Position.prototype.getMousePosition=function(e){var posx,posy,ref1,t;posx=0;posy=0;if(!e){e=window.event}if(((ref1=e.originalEvent)!=null?ref1.targetTouches:void 0)!=null){t=e.originalEvent.targetTouches[0];posx=t.clientX;posy=t.clientY}else if(e.pageX||e.pageY){posx=e.pageX;posy=e.pageY}else if(e.clientX||e.clientY){posx=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft;posy=e.clientY+document.body.scrollTop+document.documentElement.scrollTop}return{x:posx,y:posy}};Position.prototype.startDrag=function(e){var start;if(typeof userlikePreview!=="undefined"&&userlikePreview!==null&&(typeof userlikePreview!=="undefined"&&userlikePreview!==null?userlikePreview.isActive():void 0)){return}if(_jq(_jq.event(e).target).hasClass("userlike-icon")){return}start=this.$popup.position();this.drag={mouse:getMousePosition(e),start:{left:start.left,top:start.top},down:true,snap:false};return session.persistDrag(this.drag)};Position.prototype.stopDrag=function(e){if(!this.drag.down){return}this.drag.down=false;if(overlapDiv(this.$button,this.$popup)){this.snap()}this.update();return session.persistDrag(this.drag)};Position.prototype.moveDrag=function(e){var pos;if(!this.drag.down){return}pos=getMousePosition(e);this.drag.pos={left:pos.x-this.drag.mouse.x+this.drag.start.left,top:pos.y-this.drag.mouse.y+this.drag.start.top};this.update();return session.persistDrag(this.drag)};return Position}();View=function(){function View(options){if(options==null){options={}}this.config=_jq.extend({},config,options.config)}View.prototype.height=352;View.prototype.is_minimizable=false;View.prototype.height_mobile="100%";View.current_hightlight_timeout=null;View.prototype.getHeaderbarText=function(){return this.config.custom_header||""};View.prototype.el=function(){return _ullog("View::el must be implemented by child class")};View.prototype.destroy=function(){};View.prototype.highlightText=function(selector,new_value){var $el,is_input_or_textarea,node_name,old_value;$el=_jq(selector);node_name=$el.nodeName();is_input_or_textarea=node_name==="input"||node_name==="textarea";old_value=is_input_or_textarea?$el.val():$el.text();if(!(typeof userlikePreview!=="undefined"&&userlikePreview!==null?userlikePreview.isActive():void 0)||!old_value||!new_value||old_value===new_value){return}if(is_input_or_textarea&&$el.data("default")===new_value){return}if(View.current_hightlight_timeout){return}this._removeAllHighlights(selector);$el.addClass("bounceIn");$el.addClass("animated");return View.current_hightlight_timeout=window.setTimeout(function(_this){return function(){_this._removeAllHighlights(selector);return View.current_hightlight_timeout=null}}(this),2e3)};View.prototype._removeAllHighlights=function(selector){_jq(".animate").removeClass("animated");return _jq(".bounceIn").removeClass("bounceIn")};return View}();Loader=function(){function Loader(){}Loader.loadLib=function(callback){var scripts;scripts={userlikelib:"dq4irj27fs462.cloudfront.net/userlikelib.min.js"};return Loader.loadScripts(scripts,function(){return callback()})};Loader.loadScripts=function(scripts,callback){var count,i,p,results1,src,srcs;srcs=[];for(p in scripts){if(!hasProp.call(scripts,p))continue;if(!(p in window)){srcs.push(scripts[p])}}count=srcs.length;if(count===0){callback()}i=0;results1=[];while(i<srcs.length){src=srcs[i];Loader.loadScript(src,function(){if(--count===0){return callback()}});results1.push(i++)}return results1};Loader.loadScript=function(src,callback){var script;_ullog("loadScript: "+src);script=document.createElement("script");script.setAttribute("type","text/javascript");script.setAttribute("src","https://"+src);script.onload=script.onreadystatechange=function(){var state;state=script.readyState;if(!callback.done&&(!state||/loaded|complete/.test(state))){callback.done=true;return callback()}};return document.getElementsByTagName("head")[0].appendChild(script)};Loader.loadFont=function(fontName){var e,error,s,wf;try{window.WebFontConfig={google:{families:[fontName]}};wf=document.createElement("script");wf.src="https://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js";wf.type="text/javascript";wf.async="true";s=document.getElementsByTagName("script")[0];return s.parentNode.insertBefore(wf,s)}catch(error){e=error;return _ullog("Error loading font ",e)}};Loader.loadTheme=function(){var theme_style_element;theme_style_element=document.createElement("style");theme_style_element.type="text/css";if(theme_style_element.styleSheet){theme_style_element.styleSheet.cssText=config.theme_css}else{theme_style_element.appendChild(document.createTextNode(config.theme_css))}return document.getElementsByTagName("head")[0].appendChild(theme_style_element)};Loader.loadCustomCss=function(){var custom_style_element;custom_style_element=document.createElement("style");custom_style_element.type="text/css";if(custom_style_element.styleSheet){custom_style_element.styleSheet.cssText=config.custom_css}else{custom_style_element.appendChild(document.createTextNode(config.custom_css))}return document.getElementsByTagName("head")[0].appendChild(custom_style_element)};Loader.injectMarkup=function(callback){var div,el,j,len1,ref,ref1,trial,wait;if(callback==null){callback=function(){}}div=document.createElement("div");div.className="userlike";div.innerHTML=userlike_html.replace(/{{POWEREDBY_LINK}}/g,config.poweredby_link).replace(/{{POWEREDBY_SLOGAN}}/g,config.poweredby_slogan);ref1=["body","frameset","head"];for(j=0,len1=ref1.length;j<len1;j++){ref=ref1[j];el=document.getElementsByTagName(ref);if(el[0]){el[0].appendChild(div);break}}trial=100;wait=function(){if((!document.getElementById("userlike")||!document.getElementById("userlike-offline-message-submit")||!document.getElementById("userlike-register-submit"))&&trial--){_ullog("Popup::inject wait");return window.setTimeout(wait,300)}else{return callback(!document.getElementById("userlike")&&!document.getElementById("userlike-offline-message-submit")&&!document.getElementById("userlike-register-submit"))}};return wait()};return Loader}();Validator=function(){function Validator(){}Validator.validateEmail=function(email){var validator;if(!email||email.length>100){return false}validator=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,})+$/i;return validator.test(email)};Validator.validateName=function(name){if(!name||name.length>100){return false}return true};Validator.validateAdditional=function(value){if(!value||value.length>100){return false}return true};return Validator}();window._jq=function(selector,context){var el;if(context==null){context=window.document}if(typeof selector==="string"){el=context.querySelectorAll(selector);if(el.length===1){el=el[0]}if(el.length===0){el=null}return new UserlikeJqObj(el)}else if(selector.nodeType!=null){return new UserlikeJqObj(selector)}else{return selector}};_jq.uaMatch=function(ua){var match;ua=ua.toLowerCase();match=/(chrome)[ \/]([\w.]+)/.exec(ua)||/(webkit)[ \/]([\w.]+)/.exec(ua)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(ua)||/(msie) ([\w.]+)/.exec(ua)||ua.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(ua)||[];return{browser:match[1]||"",version:match[2]||"0"}};if(!_jq.browser){matched=_jq.uaMatch(navigator.userAgent);browser={};if(matched.browser){browser[matched.browser]=true;browser.version=matched.version}if(browser.chrome){browser.webkit=true}else if(browser.webkit){browser.safari=true}_jq.browser=browser}_jq.ajaxGet=function(options){var request;request=new XMLHttpRequest;request.open("GET",options.url,true);request.onreadystatechange=function(){if(this.readyState===4){if(this.status>=200&&this.status<400){options.success(this.responseText)}else{options.error(this.responseText)}}};return request.send()};_jq.ajaxPost=function(options){var request;if(_jq.browser.msie&&parseInt(_jq.browser.version)<10){request=new XDomainRequest;request.open("POST",options.url,true)}else{request=new XMLHttpRequest;request.open("POST",options.url,true);request.setRequestHeader("Content-Type","application/json; charset=UTF-8")}request.onreadystatechange=function(){if(this.readyState===4){if(this.status>=200&&this.status<400){options.success(this.responseText)}else{options.error(this.responseText)}}};request.onerror=function(){return options.error(request.responseText)};return request.send(options.data)};_jq.ajaxJsonp=function(options){JSONP.init({error:options.error});return JSONP.get(options.url,options.data,function(resp){return options.success(resp)})};_jq.windowOn=function(eventName,handler){if(window.addEventListener!=null){return window.addEventListener(eventName,handler)}else{return window.attachEvent("on"+eventName,function(){return handler.call(window)})}};_jq.windowOff=function(eventName,handler){if(window.removeEventListener!=null){return window.removeEventListener(eventName,handler)}else{return window.detachEvent("on"+eventName,function(){return handler.call(window)})}};_jq.windowSize=function(){return{width:window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,height:window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight}};_jq.event=function(event){var jqEvent;jqEvent=event;if(jqEvent.preventDefault==null){jqEvent.preventDefault=function(){return event.returnValue=false}}if(jqEvent.stopPropagation==null){jqEvent.stopPropagation=function(){return event.returnValue=false}}if(jqEvent.target==null){jqEvent.target=window.event.target||window.event.srcElement}if(jqEvent.which==null){jqEvent.which=event.keyCode}return jqEvent};_jq.extend=function(out){var i,key,ref1;out=out||{};i=1;while(i<arguments.length){if(!arguments[i]){i++;continue}ref1=arguments[i];for(key in ref1){if(!hasProp.call(ref1,key))continue;if(arguments[i].hasOwnProperty(key)){out[key]=arguments[i][key]}}i++}return out};UserlikeJqObj=function(){function UserlikeJqObj(element){this.el=element}UserlikeJqObj.prototype.get=function(index){if(this.el==null){return this}if(!index){return this.el}return this.el[index]};UserlikeJqObj.prototype.find=function(selector){if(this.el==null){return this}return _jq(selector,this.el)};UserlikeJqObj.prototype.contains=function(element){if(this.el==null){return false}element=_jq(element);return this.el.contains(element.el)};UserlikeJqObj.prototype._getStyle=function(prop){if(getComputedStyle!=="undefined"){return getComputedStyle(this.el,null).getPropertyValue(prop)}else{return this.el.currentStyle[prop]}};UserlikeJqObj.prototype._toJSAttribute=function(attribute){var camelCased;camelCased=attribute.replace(/-([a-z])/g,function(g){return g[1].toUpperCase()});return camelCased};UserlikeJqObj.prototype._addPxSuffix=function(val){if(typeof val!=="string"){val+="px"}return val};UserlikeJqObj.prototype.each=function(iterator){var element,i,j,len1,ref1,ref2,results1;if(this.el!=null&&!this.el.length){return iterator.call(this,0,this)}if(!((ref1=this.el)!=null?ref1.length:void 0)){return this}ref2=this.el;results1=[];for(i=j=0,len1=ref2.length;j<len1;i=++j){element=ref2[i];results1.push(iterator.call(this,i,_jq(element)))}return results1};UserlikeJqObj.prototype.width=function(value){var width;if(this.el==null){return this}if(value){return this.css("width",value)}else{}width=this._getStyle("width");width.replace("px","");return parseInt(width,10)};UserlikeJqObj.prototype.outerWidth=function(){if(this.el==null){return this}return this.el.offsetWidth};UserlikeJqObj.prototype.height=function(value){var height;if(this.el==null){return this}if(value){return this.css("height",value)}else{height=this._getStyle("height");height.replace("px","");return parseInt(height,10)}};UserlikeJqObj.prototype.outerHeight=function(){if(this.el==null){return this}return this.el.offsetHeight};UserlikeJqObj.prototype.attr=function(key,val){if(this.el==null){return this}if(this.el.length){this.each(function(i,e){return e.attr(key,val)});return this}if(val==null){return this.el.getAttribute(key)}else{this.el.setAttribute(key,val)}return this};UserlikeJqObj.prototype.removeAttr=function(attr){if(this.el==null){return this}if(this.el!=null){this.el.removeAttribute(attr)}return this};UserlikeJqObj.prototype.css=function(stringOrObj,value){var attributeName,attributeVal;if(this.el==null){return this}if(this.el.length){this.each(function(i,el){return el.css(stringOrObj,value)});return this}if(stringOrObj==null){return window.getComputedStyle(this.el)}if(typeof stringOrObj==="string"){if(value!=null){this.el.style[this._toJSAttribute(stringOrObj)]=this._addPxSuffix(value)}else{return window.getComputedStyle(this.el)[this._toJSAttribute(stringOrObj)]}}if(typeof stringOrObj==="object"){for(attributeName in stringOrObj){if(!hasProp.call(stringOrObj,attributeName))continue;attributeVal=stringOrObj[attributeName];this.el.style[this._toJSAttribute(attributeName)]=this._addPxSuffix(attributeVal)}}return this};UserlikeJqObj.prototype.offset=function(){var rect;if(this.el==null){return this}rect=this.el.getBoundingClientRect();return{top:rect.top+document.body.scrollTop,left:rect.left+document.body.scrollLeft}};UserlikeJqObj.prototype.position=function(){if(this.el==null){return this}return{left:this.el.offsetLeft,top:this.el.offsetTop}};UserlikeJqObj.prototype.removeClass=function(className){if(this.el==null){return this}if(this.el.length){this.each(function(i,el){return el.removeClass(className)});return this}if(this.el.classList){this.el.classList.remove(className)}else{this.el.className=this.el.className.replace(new RegExp("(^|\\b)"+className.split(" ").join("|")+"(\\b|$)","gi")," ")}return this};UserlikeJqObj.prototype.addClass=function(className){if(this.el==null){return this}if(this.el.length){this.each(function(i,el){return el.addClass(className)});return this}if(this.el.classList){this.el.classList.add(className)}else{this.el.className+=" "+className}return this};UserlikeJqObj.prototype.hasClass=function(className){if(this.el==null){return this}if(this.el.classList){return this.el.classList.contains(className)}else{return new RegExp("(^| )"+className+"( |$)","gi").test(this.el.className)}};UserlikeJqObj.prototype.hasFocus=function(){if(this.el==null){return this}if(this.el.matches!=null){return this.el.matches(":focus")}else{return document.activeElement===this.el}};UserlikeJqObj.prototype.nodeName=function(){if(this.el==null){return this}return this.el.nodeName.toLowerCase()};UserlikeJqObj.prototype.importize=function(){var styleArray;styleArray=this.el.style.cssText.split(";");styleArray[styleArray.length-2]=styleArray[styleArray.length-2]+"!important";return this.el.style.cssText=styleArray.join(";")};UserlikeJqObj.prototype.on=function(eventName,handler){if(this.el==null){return this}if(this.el.length){this.each(function(i,el){return _jq(el).on(eventName,handler)});return this}if(this.el.addEventListener){this.el.addEventListener(eventName,handler)}else{this.el.attachEvent("on"+eventName,function(_this){return function(e){return handler.call(_this.el,e)}}(this))}return this};UserlikeJqObj.prototype.off=function(eventName,handler){var el,j,len1,ref1;if(handler==null){handler=null}if(this.el==null){return this}if(this.el.length){this.each(function(i,el){return el.off(eventName,handler)});return this}if(this.el.length){ref1=this.el;for(j=0,len1=ref1.length;j<len1;j++){el=ref1[j];new UserlikeJqObj(el).off(eventName)}return this}if(this.el.removeEventListener){this.el.removeEventListener(eventName,handler)}else{this.el.detachEvent("on"+eventName,handler)}return this};UserlikeJqObj.prototype.scrollTop=function(value){if(this.el==null){return this}if(value!=null){return this.el.scrollTop=value}else{return this.el.scrollTop}};UserlikeJqObj.prototype.val=function(valueOrFn){if(this.el==null){return this}if(valueOrFn==null){return this.el.value}else if(typeof valueOrFn==="function"){this.el.value=valueOrFn(this.el.value)}else{this.el.value=valueOrFn}return this};UserlikeJqObj.prototype.html=function(markup){if(this.el==null){return this}if(markup==null){return this.el.innerHTML}else{this.el.innerHTML=markup}return this};UserlikeJqObj.prototype.text=function(string){var attibute;if(this.el==null){return this}if(this.el.length){this.each(function(i,el){return _jq(el).text(string)});return this}attibute=this.el.textContent!=null?"textContent":"innerText";if(string==null){return this.el[attibute]}else{this.el[attibute]=string}return this};UserlikeJqObj.prototype.focus=function(handler){if(this.el==null){return this}if(handler==null){this.el.focus()}else{this.on("focus",handler)}return this};UserlikeJqObj.prototype.blur=function(handler){if(this.el==null){return this}this.on("blur",handler);return this};UserlikeJqObj.prototype.parent=function(){if(this.el==null){return this}return _jq(this.el.parentNode)};UserlikeJqObj.prototype.first=function(){if(this.el==null||!this.el.length){return this}return _jq(this.el[0])};UserlikeJqObj.prototype.after=function(element){if(this.el==null){return this}this.el.insertAdjacentHTML("afterend",element.get().outerHTML);return this};UserlikeJqObj.prototype.append=function(element){if(this.el==null){return this}element=_jq(element);this.el.appendChild(element.get());return this};UserlikeJqObj.prototype.remove=function(){if(this.el==null){return this}if(this.el.length){this.each(function(i,el){return _jq(el).remove()});return this}if(this.el instanceof NodeList&&!this.el.length){return}else if(this.el.parentNode!=null){this.el.parentNode.removeChild(this.el)}return this};UserlikeJqObj.prototype.empty=function(){if(this.el==null){return this}while(this.el.firstChild){this.el.removeChild(this.el.firstChild)}return this};UserlikeJqObj.prototype.last=function(){if(this.el==null){return this}if(this.el.length){return _jq(this.el[this.el.length-1])}else{return this}};UserlikeJqObj.prototype.data=function(key,val){var _data,attribute,j,k,len1,prefix,prefix_index,ref1,v;if(typeof key==="object"){for(k in key){if(!hasProp.call(key,k))continue;v=key[k];this.data(k,v)}return}if(this.el==null){return this}if(!this.el.dataset){if(key&&val){return this.attr("data-"+key,val)}else if(key){return this.attr("data-"+key)}else{prefix="data-";_data={};ref1=this.el.attributes;for(j=0,len1=ref1.length;j<len1;j++){attribute=ref1[j];prefix_index=attribute.name.indexOf(prefix);if(prefix_index===0){_data[attribute.name.substr(prefix.length)]=this.attr(attribute.name)}}return _data}}else{if(key!=null){key=this._toJSAttribute(key)}if(key==null){return this.el.dataset}if(val==null){return this.el.dataset[key]}else{this.el.dataset[key]=val}}return this};UserlikeJqObj.prototype.size=function(){var ref1;if((ref1=this.el)!=null?ref1.length:void 0){return this.el.length}else if(this.el!=null){return 1}else{return 0}};UserlikeJqObj.prototype.show=function(){if(this.el==null){
return this}return this.el.style.display=""};UserlikeJqObj.prototype.hide=function(cb){var ref1;if(this.el==null){return this}return(ref1=this.el.style)!=null?ref1.display="none":void 0};UserlikeJqObj.prototype.fadeIn=function(options){var last,opacity,tick;if(this.el==null){return this}opacity=1;this.el.style.display="";if(options.complete!=null){options.complete()}return;opacity=0;this.el.style.display="block";this.el.style.opacity=0;this.el.style.filter="";last=+new Date;tick=function(_this){return function(){opacity+=(new Date-last)/400;_this.el.style.opacity=opacity;_this.el.style.filter="alpha(opacity="+100*opacity|0+")";last=+new Date;if(opacity<1){window.requestAnimationFrame&&requestAnimationFrame(tick)||setTimeout(tick,16)}else{if((options!=null?options.complete:void 0)!=null){options.complete()}}}}(this);tick();return this};UserlikeJqObj.prototype.fadeOut=function(options,callback){var last,opacity,tick;if(this.el==null){return this}opacity=0;this.el.style.display="none";if(callback!=null){callback()}return this;opacity=1;this.el.style.opacity=opacity;this.el.style.filter="";last=+new Date;tick=function(_this){return function(){opacity-=(new Date-last)/400;_this.el.style.opacity=opacity;_this.el.style.filter="alpha(opacity="+100*opacity|0+")";last=+new Date;if(opacity<1){window.requestAnimationFrame&&requestAnimationFrame(tick)||setTimeout(tick,16)}else{_this.el.style.display="none";if(callback!=null){callback()}}}}(this);tick();return this};return UserlikeJqObj}();!("getComputedStyle"in this)&&(this.getComputedStyle=function(){function getComputedStylePixel(element,property,fontSize){var value=element.document&&element.currentStyle[property].match(/([\d\.]+)(%|cm|em|in|mm|pc|pt|)/)||[0,0,""],size=value[1],suffix=value[2],rootSize;fontSize=!fontSize?fontSize:/%|em/.test(suffix)&&element.parentElement?getComputedStylePixel(element.parentElement,"fontSize",null):16;rootSize=property=="fontSize"?fontSize:/width/i.test(property)?element.clientWidth:element.clientHeight;return suffix=="%"?size/100*rootSize:suffix=="cm"?size*.3937*96:suffix=="em"?size*fontSize:suffix=="in"?size*96:suffix=="mm"?size*.3937*96/10:suffix=="pc"?size*12*96/72:suffix=="pt"?size*96/72:size}function setShortStyleProperty(style,property){var borderSuffix=property=="border"?"Width":"",t=property+"Top"+borderSuffix,r=property+"Right"+borderSuffix,b=property+"Bottom"+borderSuffix,l=property+"Left"+borderSuffix;style[property]=(style[t]==style[r]&&style[t]==style[b]&&style[t]==style[l]?[style[t]]:style[t]==style[b]&&style[l]==style[r]?[style[t],style[r]]:style[l]==style[r]?[style[t],style[r],style[b]]:[style[t],style[r],style[b],style[l]]).join(" ")}function CSSStyleDeclaration(element){var style=this,currentStyle=element.currentStyle,fontSize=getComputedStylePixel(element,"fontSize"),unCamelCase=function(match){return"-"+match.toLowerCase()},property;for(property in currentStyle){Array.prototype.push.call(style,property=="styleFloat"?"float":property.replace(/[A-Z]/,unCamelCase));if(property=="width"){style[property]=element.offsetWidth+"px"}else if(property=="height"){style[property]=element.offsetHeight+"px"}else if(property=="styleFloat"){style.float=currentStyle[property]}else if(/margin.|padding.|border.+W/.test(property)&&style[property]!="auto"){style[property]=Math.round(getComputedStylePixel(element,property,fontSize))+"px"}else if(/^outline/.test(property)){try{style[property]=currentStyle[property]}catch(error){style.outlineColor=currentStyle.color;style.outlineStyle=style.outlineStyle||"none";style.outlineWidth=style.outlineWidth||"0px";style.outline=[style.outlineColor,style.outlineWidth,style.outlineStyle].join(" ")}}else{style[property]=currentStyle[property]}}setShortStyleProperty(style,"margin");setShortStyleProperty(style,"padding");setShortStyleProperty(style,"border");style.fontSize=Math.round(fontSize)+"px"}CSSStyleDeclaration.prototype={constructor:CSSStyleDeclaration,getPropertyPriority:function(){throw new Error("NotSupportedError: DOM Exception 9")},getPropertyValue:function(property){return this[property.replace(/-\w/g,function(match){return match[1].toUpperCase()})]},item:function(index){return this[index]},removeProperty:function(){throw new Error("NoModificationAllowedError: DOM Exception 7")},setProperty:function(){throw new Error("NoModificationAllowedError: DOM Exception 7")},getPropertyCSSValue:function(){throw new Error("NotSupportedError: DOM Exception 9")}};var getComputedStyle=function getComputedStyle(element){return new CSSStyleDeclaration(element)};return getComputedStyle}(this));var JSONP=function(){var counter=0,head,window=this,config={};function load(url,pfnError){var script=document.createElement("script"),done=false;script.src=url;script.async=true;var errorHandler=pfnError||config.error;if(typeof errorHandler==="function"){script.onerror=function(ex){errorHandler({url:url,event:ex})}}script.onload=script.onreadystatechange=function(){if(!done&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){done=true;script.onload=script.onreadystatechange=null;if(script&&script.parentNode){script.parentNode.removeChild(script)}}};if(!head){head=document.getElementsByTagName("head")[0]}head.appendChild(script)}function encode(str){return encodeURIComponent(str)}function jsonp(url,params,callback,callbackName){var query=(url||"").indexOf("?")===-1?"?":"&",key;callbackName=callbackName||config["callbackName"]||"callback";var uniqueName=callbackName+"_json"+ ++counter;params=params||{};for(key in params){if(params.hasOwnProperty(key)){query+=encode(key)+"="+encode(params[key])+"&"}}window[uniqueName]=function(data){callback(data);try{delete window[uniqueName]}catch(e){}window[uniqueName]=null};load(url+query+callbackName+"="+uniqueName);return uniqueName}function setDefaults(obj){config=obj}return{get:jsonp,init:setDefaults}}();Config=function(){function Config(app_key1,widget_key1,config){var ref1;this.app_key=app_key1;this.widget_key=widget_key1;_ullog("Config::ctor: version="+git_version);_ullog("Config::ctor: config=%o ",config);this.set(config);if(((ref1=window.userlike)!=null?ref1.config:void 0)!=null){this.set(window.userlike.config)}}Config.prototype.set=function(config){var key,results1,value;results1=[];for(key in config){if(!hasProp.call(config,key))continue;value=config[key];results1.push(this[key]=value)}return results1};return Config}();getCookieSupport=function(){var e,error,persist;try{Cookies.set("_uslk_test","test");persist=Cookies.get("_uslk_test")==="test";Cookies.remove("_uslk_test");return persist}catch(error){e=error;return false}};getStorageSupport=function(){var e,error;try{localStorage.setItem("_uslk_test","test");localStorage.removeItem("_uslk_test");return true}catch(error){e=error;return false}};subDomain=function(){var d;d=window.location.hostname.match(/[a-z0-9][a-z0-9\-]+\.[a-z\.]{2,6}$/i);if(d){return"."+d[0]}else{return""}};cookiesDomain=function(){if(config.wildcard_cookie){return subDomain()}else{}};cookieCleanup=function(){var es,j,len1,name,new_key,old_key,ref1,ref2,results1,value;if(config.wildcard_cookie){Cookies.remove("uslk_e");Cookies.remove("uslk_s")}else{Cookies.remove("uslk_e",{domain:subDomain()});Cookies.remove("uslk_s",{domain:subDomain()})}es=Storage.expireContainerCookie;ref1={_uslk_uuid:"uuid",_uslk_email:"client_email",_uslk_name:"client_name",_uslk_additional01:"client_additional01_value",_uslk_additional02:"client_additional02_value",_uslk_additional03:"client_additional03_value",_uslk_visits:"visits"};for(old_key in ref1){if(!hasProp.call(ref1,old_key))continue;new_key=ref1[old_key];value=Cookies.set(old_key);if(value){es.setItem(new_key,value)}}ref2=["widget_config","widget_key","state","app_state","referrer","chat_meta_id","id","ct","co","created","operator_id","operator_name","operator","bootstrapped","active","page_impressions","email","name","uuid","additional01","additional02","additional03","visits"];results1=[];for(j=0,len1=ref2.length;j<len1;j++){name=ref2[j];results1.push(Cookies.remove("_uslk_"+name,{domain:cookiesDomain()}))}return results1};BackendMemory=function(){function BackendMemory(){}BackendMemory.prototype.data={};BackendMemory.prototype.setItem=function(name,value){_ullog("BackendMemory::setItem name="+name+" value="+value);return this.data[name]=value};BackendMemory.prototype.getItem=function(name){var value;value=this.data[name];return value};BackendMemory.prototype.removeItem=function(name){_ullog("BackendMemory::removeItem name="+name);return delete this.data[name]};BackendMemory.prototype.removeAllItems=function(){return this.data={}};return BackendMemory}();BackendLocalStorage=function(){function BackendLocalStorage(){}BackendLocalStorage.prototype.prefix="uslk_";BackendLocalStorage.prototype.setItem=function(name,value){if(name!=="widget_key"&&name!=="app_key"&&name!=="config"){_ullog("BackendLocalStorage::setItem name="+name)}if(value===""){_ullog("BackendLocalStorage::setItem value is empty");return}return localStorage.setItem(""+this.prefix+name,value)};BackendLocalStorage.prototype.getItem=function(name){var value;return value=localStorage.getItem(""+this.prefix+name,value)};BackendLocalStorage.prototype.removeItem=function(name){_ullog("BackendLocalStorage::removeItem name="+name);return localStorage.removeItem(""+this.prefix+name)};BackendLocalStorage.prototype.removeAllItems=function(){var key,results1;results1=[];for(key in localStorage){if(!hasProp.call(localStorage,key))continue;if(key.indexOf(this.prefix)>-1){results1.push(localStorage.removeItem(key))}else{results1.push(void 0)}}return results1};return BackendLocalStorage}();BackendCookie=function(){function BackendCookie(){}BackendCookie.prototype.prefix="uslk_";BackendCookie.prototype.domain=function(){var d;d=window.location.hostname.match(/[a-z0-9][a-z0-9\-]+\.[a-z\.]{2,6}$/i);if(d){return"."+d[0]}else{return""}}();BackendCookie.prototype.setItem=function(name,value,days){_ullog("BackendCookie::setItem name="+name+" value="+value+" days="+days);return Cookies.set(this.prefix+name,value,{expires:days,domain:cookiesDomain()})};BackendCookie.prototype.getItem=function(name){var value;value=Cookies.get(this.prefix+name);_ullog("BackendCookie::getItem name="+name+" value=value");return value};BackendCookie.prototype.removeItem=function(name){Cookies.remove(this.prefix+name,{domain:cookiesDomain()});return _ullog("BackendCookie::removeItem name="+name)};return BackendCookie}();BackendSessionCookie=function(superClass){extend1(BackendSessionCookie,superClass);function BackendSessionCookie(){return BackendSessionCookie.__super__.constructor.apply(this,arguments)}BackendSessionCookie.prototype.setItem=function(name,value){return BackendSessionCookie.__super__.setItem.call(this,name,value)};return BackendSessionCookie}(BackendCookie);BackendContainerCookie=function(superClass){extend1(BackendContainerCookie,superClass);BackendContainerCookie.prototype.sep="~";function BackendContainerCookie(map){this.map=map;this.data={}}BackendContainerCookie.prototype.escape=function(s){return s};BackendContainerCookie.prototype.unescape=function(s){return s};BackendContainerCookie.prototype.serialize=function(){var i,j,len1,ref1,s,v;s="";ref1=this.map;for(j=0,len1=ref1.length;j<len1;j++){i=ref1[j];v=this.data[i];if(v!==void 0&&v!==null){s+=""+this.escape(v)+this.sep}else{s+=this.sep}}return s};BackendContainerCookie.prototype.deserialize=function(s){var data,i,k,results1,v;if(!s){return}data=s.split(this.sep);results1=[];for(i in data){if(!hasProp.call(data,i))continue;v=data[i];k=this.map[i];results1.push(this.data[k]=decodeURIComponent(this.unescape(v)))}return results1};BackendContainerCookie.prototype.removeItem=function(name){this.setItem(name,void 0);return _ullog("BackendContainerCookie::removeItem name="+name)};BackendContainerCookie.prototype.removeAllItems=function(){var name,ref1,results1;ref1=this.data;results1=[];for(name in ref1){if(!hasProp.call(ref1,name))continue;results1.push(this.removeItem(name))}return results1};return BackendContainerCookie}(BackendCookie);BackendSessionContainerCookie=function(superClass){extend1(BackendSessionContainerCookie,superClass);function BackendSessionContainerCookie(){this.data={};this.map=["app_state","id","duration","client_terminating","client_originating","chat_meta_id"];this.deserialize(Cookies.get(this.prefix+"s"))}BackendSessionContainerCookie.prototype.getItem=function(name){var value;value=this.data[name];_ullog("BackendSessionContainerCookie::getItem name="+name+" value="+value);return value};BackendSessionContainerCookie.prototype.setItem=function(name,value){this.data[name]=value;BackendSessionContainerCookie.__super__.setItem.call(this,"s",this.serialize());return _ullog("BackendSessionContainerCookie::setItem name="+name+" value="+value)};return BackendSessionContainerCookie}(BackendContainerCookie);BackendExpireContainerCookie=function(superClass){extend1(BackendExpireContainerCookie,superClass);function BackendExpireContainerCookie(){this.data={};this.map=["uuid","blocked","client_name","client_email","client_additional01_value","client_additional02_value","client_additional03_value","visits"];this.deserialize(Cookies.get(this.prefix+"e"))}BackendExpireContainerCookie.prototype.getItem=function(name){var value;value=this.data[name];_ullog("BackendExpireContainerCookie::getItem name="+name+" value="+value);return value};BackendExpireContainerCookie.prototype.setItem=function(name,value){this.data[name]=value;BackendExpireContainerCookie.__super__.setItem.call(this,"e",this.serialize(),parseInt(config.cookie_expire));return _ullog("BackendExpireContainerCookie::setItem name="+name+" value="+value)};return BackendExpireContainerCookie}(BackendContainerCookie);BackendExpireCookie=function(superClass){extend1(BackendExpireCookie,superClass);function BackendExpireCookie(){return BackendExpireCookie.__super__.constructor.apply(this,arguments)}BackendExpireCookie.prototype.setItem=function(name,value){_ullog("BackendExpireCookie::setItem name="+name+" value="+value);return BackendExpireCookie.__super__.setItem.call(this,name,value,parseInt(config.cookie_expire))};return BackendExpireCookie}(BackendCookie);SessionFactory=function(){function SessionFactory(){}SessionFactory.prototype.get=function(){if(config.data_privacy){return new SessionStoragePrivacy}else{return new SessionStorage}};return SessionFactory}();Storage=function(){function Storage(){}Storage.memory=new BackendMemory;Storage.expireCookie=new BackendExpireCookie;Storage.sessionCookie=new BackendSessionCookie;Storage.localStorage=new BackendLocalStorage;Storage.expireContainerCookie=new BackendExpireContainerCookie;Storage.sessionContainerCookie=new BackendSessionContainerCookie;return Storage}();Session=function(){function Session(){}Session.is_number=new RegExp("^[-]?[0-9]+[.]?[0-9]+$");Session.is_bool=new RegExp("^[01]$");Session.prototype.items={widget_key:Storage.localStorage,config:Storage.localStorage,app_key:Storage.localStorage,drag:Storage.localStorage,operator_binding:Storage.localStorage,goal_reached:Storage.localStorage,referrer:Storage.localStorage,ip:Storage.localStorage,longitude:Storage.localStorage,latitude:Storage.localStorage,operator_name:Storage.localStorage,operator_display_name:Storage.localStorage,operator_id:Storage.localStorage,was_proactive:Storage.localStorage,inital_url:Storage.localStorage,whitelist:Storage.localStorage,chat_meta_id:Storage.sessionContainerCookie,page_impressions:Storage.localStorage,debug:Storage.localStorage,uuid:Storage.expireContainerCookie,blocked:Storage.expireContainerCookie,client_name:Storage.expireContainerCookie,client_email:Storage.expireContainerCookie,client_additional01_value:Storage.expireContainerCookie,client_additional02_value:Storage.expireContainerCookie,client_additional03_value:Storage.expireContainerCookie,visits:Storage.expireContainerCookie,app_state:Storage.sessionContainerCookie,id:Storage.sessionContainerCookie,duration:Storage.sessionContainerCookie,client_terminating:Storage.sessionContainerCookie,client_originating:Storage.sessionContainerCookie};Session.state_map={Chat:"Offline",ChatMinimized:"Offline"};Session.prototype.lookup=function(name){return this.items[name]||Storage.memory};Session.prototype.set=function(name,value){return this.lookup(name).setItem(name,value)};Session.prototype.get=function(name){var value;value=this.lookup(name).getItem(name);if(Session.is_number.test(value)){value=parseFloat(value)}else if(Session.is_bool.test(value)){value=parseInt(value)}return value};Session.prototype["delete"]=function(name){return this.lookup(name).removeItem(name)};Session.prototype.setIfEmpty=function(key,value){if(!this.get(key)){return this.set(key,value)}};Session.prototype.reset=function(){this.deleteConfig();this.setState(null);this.resetChatDuration();return this.resetSession()};Session.prototype.resetSession=function(){this["delete"]("id");this["delete"]("chat_meta_id");this["delete"]("was_proactive");this["delete"]("operator_name");this["delete"]("operator_display_name");return this["delete"]("operator_id")};Session.prototype.resetChatDuration=function(){return this.set("duration",0)};Session.prototype.resetStats=function(){this.set("client_terminating",0);return this.set("client_originating",0)};Session.prototype.deleteConfig=function(){this["delete"]("widget_key");this["delete"]("config");return this["delete"]("app_key")};Session.prototype.saveConfig=function(){this.set("widget_key",config.widget_key);this.set("app_key",config.app_key);return this.set("config",JSON.stringify(config))};Session.prototype.persistDrag=function(drag){return this.set("drag",JSON.stringify(drag))};Session.prototype.getDrag=function(){var drag;drag=this.get("drag");if(!drag){return}return JSON.parse(drag)};Session.prototype.resetDrag=function(){return this["delete"]("drag")};Session.prototype.getConfig=function(){return{widget_key:this.get("widget_key"),app_key:this.get("app_key"),config:JSON.parse(this.get("config"))}};Session.prototype.hasClientTerminating=function(){return this.get("client_terminating")!==0};Session.prototype.hasClientOriginating=function(){return this.get("client_originating")!==0};Session.prototype.incClientTerminating=function(){return this.set("client_terminating",this.get("client_terminating")+1)};Session.prototype.incClientOriginating=function(){return this.set("client_originating",this.get("client_originating")+1)};Session.prototype.setState=function(value,expires){if(expires){_ullog("Session::setState app_state="+value+";"+(+new Date+expires));return this.set("app_state",value+";"+(+new Date+expires))}else{_ullog("Session::setState app_state="+value+";0");return this.set("app_state",value+";0")}};Session.prototype.getState=function(){var expires,now,override_state,state,value,values;now=+new Date;value=this.get("app_state");values=value!=null?value.split(";"):void 0;if(!values){return}state=values[0];expires=parseInt(values[1]);_ullog("Session::getState value="+value+" ttl="+(expires-now));if(expires>0&&expires<now){_ullog("Session::getState state is expired");override_state=Session.state_map[state];this.setState(override_state);return override_state}else{_ullog("Session::getState state is valid");return state}};Session.prototype.updateUserData=function(){var ref1,ref2,ref3,ref4,ref5;if(Validator.validateName(typeof userlikeData!=="undefined"&&userlikeData!==null?(ref1=userlikeData.user)!=null?ref1.name:void 0:void 0)){this.set("client_name",userlikeData.user.name)}if(Validator.validateEmail(typeof userlikeData!=="undefined"&&userlikeData!==null?(ref2=userlikeData.user)!=null?ref2.email:void 0:void 0)){this.set("client_email",userlikeData.user.email)}if(Validator.validateAdditional(typeof userlikeData!=="undefined"&&userlikeData!==null?(ref3=userlikeData.user)!=null?ref3.additional01:void 0:void 0)){this.set("client_additional01_value",userlikeData.user.additional01)}if(Validator.validateAdditional(typeof userlikeData!=="undefined"&&userlikeData!==null?(ref4=userlikeData.user)!=null?ref4.additional02:void 0:void 0)){this.set("client_additional02_value",userlikeData.user.additional02)}if(Validator.validateAdditional(typeof userlikeData!=="undefined"&&userlikeData!==null?(ref5=userlikeData.user)!=null?ref5.additional03:void 0:void 0)){return this.set("client_additional03_value",userlikeData.user.additional03)}};Session.prototype.addAdditionalRegisterValues=function(data){var i,j,len1,ref1;ref1=[1,2,3];for(j=0,len1=ref1.length;j<len1;j++){i=ref1[j];if(config["register_additional0"+i+"_enabled"]){data["client_additional0"+i+"_value"]=this.get("client_additional0"+i+"_value");data["client_additional0"+i+"_name"]=config["register_additional0"+i+"_name"]}}return data};Session.prototype.setGoal=function(key){var goal_reached;goal_reached=this.get("goal_reached");if(goal_reached){goal_reached=JSON.parse(goal_reached)}else{goal_reached={}}goal_reached[key]=+new Date;return this.set("goal_reached",JSON.stringify(goal_reached))};Session.prototype.getGoal=function(key){var goal_reached;goal_reached=this.get("goal_reached");if(goal_reached){goal_reached=JSON.parse(goal_reached)}else{goal_reached={}}return goal_reached[key]};Session.prototype.setOperator=function(operator){var operator_binding;this.set("operator_name",operator.name);this.set("operator_display_name",operator.display_name);this.set("operator_id",operator.id);operator_binding=this.get("operator_binding");if(operator_binding){operator_binding=JSON.parse(operator_binding)}else{operator_binding={}}operator_binding[operator.operator_group_id]=operator.id;return this.set("operator_binding",JSON.stringify(operator_binding))};Session.prototype.getOperatorBinding=function(operator_group_id){var operator_binding;operator_binding=this.get("operator_binding");if(operator_binding){operator_binding=JSON.parse(operator_binding)}else{operator_binding={}}return operator_binding[operator_group_id]};Session.prototype.startChatDuration=function(){if(this.get("duration")===0){this.set("duration",+new Date);return true}};Session.prototype.getChatDuration=function(){var t;t=this.get("duration");if(t>0){return(+new Date-t)/1e3}};Session.prototype.isActive=function(){var ref1;return(ref1=this.getState())==="Chat"||ref1==="ChatMinimized"};Session.prototype.isOffline=function(){return this.getState()==="Offline"};Session.prototype.isRject=function(){return this.getState()==="ProactiveSlotReject"};return Session}();SessionStorage=function(superClass){extend1(SessionStorage,superClass);function SessionStorage(){var i;this.bootstrap();this.updateUserData();i=this.get("page_impressions")||0;this.set("page_impressions",++i)}SessionStorage.prototype.getLocation=function(){return getLocation(function(_this){return function(position){if(position){_this.set("latitude",position.coords.latitude);_this.set("longitude",position.coords.longitude);return fsm.event("locationchange")}}}(this))};SessionStorage.prototype.bootstrap=function(){var i;if(this.get("app_state")){return}_ullog("SessionStorage::bootstrap init values");i=this.get("visits")||0;this.set("visits",++i);this.set("page_impressions",0);this.set("referrer",document.referrer);this.set("app_state",null);this.set("inital_url",document.location.href.substring(0,4096));this.resetStats();this.resetChatDuration();return this.resetDrag()};SessionStorage.prototype.packet=function(){var data;this.updateUserData();data={client_uuid:this.get("uuid"),client_name:this.get("client_name"),client_email:this.get("client_email"),url:document.location.href.substring(0,4096),inital_url:this.get("inital_url"),title:document.title,custom:typeof userlikeData!=="undefined"&&userlikeData!==null?userlikeData.custom:void 0,pre_survey_option:this.get("pre_survey_option"),goal:this.get("goal"),page_impressions:this.get("page_impressions"),visits:this.get("visits"),referrer:this.get("referrer"),ip:this.get("ip"),latitude:this.get("latitude"),longitude:this.get("longitude"),duration:this.getChatDuration()};return this.addAdditionalRegisterValues(data)};return SessionStorage}(Session);SessionStoragePrivacy=function(superClass){extend1(SessionStoragePrivacy,superClass);function SessionStoragePrivacy(){this.bootstrap();this.updateUserData()}SessionStoragePrivacy.prototype.packet=function(){var data;this.updateUserData();data={client_uuid:this.get("uuid"),client_name:this.get("client_name"),client_email:this.get("client_email"),pre_survey_option:this.get("pre_survey_option"),goal:this.get("goal"),url:document.location.href.substring(0,4096),custom:typeof userlikeData!=="undefined"&&userlikeData!==null?userlikeData.custom:void 0,duration:this.getChatDuration()};return this.addAdditionalRegisterValues(data)};SessionStoragePrivacy.prototype.getLocation=function(){};SessionStoragePrivacy.prototype.bootstrap=function(){if(this.get("app_state")){return}_ullog("SessionStoragePrivacy::bootstrap init values");this.set("app_state",null);this.resetChatDuration();return this.resetDrag()};return SessionStoragePrivacy}(Session);emotify=function(){var EMOTICON_RE,emoticons,lookup;emotify=void 0;EMOTICON_RE=void 0;emoticons={};lookup=[];emotify=function(txt,callback){callback=callback||function(img,title,emoji,text){var class_name;title=(title+", "+emoji).replace(/"/g,"&quot;").replace(/</g,"&lt;");class_name=img.substr(0,img.indexOf(".png"));return'<div class="userlike-emoji userlike-emoji-'+class_name+'"></div>'};return txt.replace(EMOTICON_RE,function(a,b,text){var e,emoji,i;i=0;emoji=text;e=emoticons[text];if(!e){while(i<lookup.length&&!lookup[i].regexp.test(text)){i++}emoji=lookup[i].name;e=emoticons[emoji]}if(e){return b+callback(e[0],e[1],emoji,text)}else{return a}})};emotify.emoticons=function(){var alts,args,arr,base_url,e,i,j,len1,regexp_str,smilies;args=Array.prototype.slice.call(arguments);base_url=typeof args[0]==="string"?args.shift():"";smilies=args[0];e=void 0;arr=[];alts=void 0;i=void 0;regexp_str=void 0;for(j=0,len1=smilies.length;j<len1;j++){e=smilies[j];emoticons[e.code]=[base_url+e.image,e.name].concat(e.equivalents)}for(e in emoticons){if(!hasProp.call(emoticons,e))continue;if(emoticons[e].length>2){alts=emoticons[e].slice(2).concat(e);i=alts.length;while(i--){alts[i]=alts[i].replace(/(\W)/g,"\\$1")}regexp_str=alts.join("|");lookup.push({name:e,regexp:new RegExp("^"+regexp_str+"$")})}else{regexp_str=e.replace(/(\W)/g,"\\$1")}arr.push(regexp_str)}EMOTICON_RE=new RegExp("(^|\\s)("+arr.join("|")+")(?=(?:$|\\s))","g");return emoticons};return emotify}();emotify.emoticons(UL_EMOTICONS);FSM=function(){function FSM(){this.state=new Init;this.freeze=false;this.event_queue=[]}FSM.prototype.start=function(data){return this.next(Start,data)};FSM.prototype.next=function(state,data){this.freeze=true;return this.state.leave(function(_this){return function(){_this.state.persist();return _this.state.transitionOut(function(){_ullog("FSM::next:  "+_this.state.getName()+" -> "+state.getName());delete _this.state;_this.state=new state;_this.state.persist();return _this.state.transitionIn(function(){_this.freeze=false;return _this.state.enter(data)})})}}(this))};FSM.prototype.event=function(name,data){if(this.state[name]!=null&&typeof this.state[name]==="function"){if(this.freeze){if(data){_ullog("FSM::event: Frozen "+this.state.getName()+":"+name+" data=",JSON.stringify(data))}else{_ullog("FSM::event: Frozen "+this.state.getName()+":"+name)}return this.queue(name,data)}else{if(name!=="persist"){if(data){_ullog("FSM::event: Event "+this.state.getName()+":"+name+" data=",JSON.stringify(data))}else{_ullog("FSM::event: Event "+this.state.getName()+":"+name)}}return this.state[name](data)}}else{return _ullog("FSM::event: Unhandled "+this.state.getName()+":"+name)}};FSM.prototype.signal=function(name,data){if(this.state[name]!=null&&typeof this.state[name]==="function"){if(!this.freeze){_ullog("FSM::signal: Signal "+this.state.getName()+":"+name);return this.state[name](data)}else{return setTimeout(function(_this){return function(){_ullog("FSM::signal: Frozen "+_this.state.getName()+":"+name);return _this.signal(name,data)}}(this),200)}}else{return _ullog("FSM::event: Unhandled "+this.state.getName()+":"+name)}};FSM.prototype.queue=function(name,data){_ullog("FSM::queue: Event "+this.state.getName()+":"+name);return this.event_queue.push([name,data])};FSM.prototype.unshift=function(name,data){_ullog("FSM::unshift: Event "+this.state.getName()+":"+name);return this.event_queue.unshift([name,data])};FSM.prototype.poll=function(){var data,event,name,unhandled;unhandled=[];while(this.event_queue.length){event=this.event_queue.shift();name=event[0];data=event[1];if(this.state[name]!=null&&typeof this.state[name]==="function"){_ullog("FSM::poll: Event "+this.state.getName()+":"+name);this.state[name](data)}else{_ullog("FSM::poll: Unhandled "+this.state.getName()+":"+name);unhandled.push(event)}}return this.event_queue=unhandled};FSM.prototype.reset=function(){_ullog("FSM::reset: remove "+this.event_queue.length+" events");return this.event_queue=[]};return FSM}();State=function(){State.timeout=4e3;State.timeout_load_script=2e3;State.timeout_connect=1e4;State.timeout_offsite=1e5;State.timeout_persist=5e3;State.timeout_screenshot=3e4;State.timeout_disconnected=3e4;State.timeout_hibernate=8e4;function State(){}State.prototype.leave=function(callback){return callback()};State.prototype.enter=function(){};State.prototype.persist=function(){};State.prototype.transitionIn=function(callback){return callback()};State.prototype.transitionOut=function(callback){return callback()};State.prototype.getName=function(){var results;results=/function ([^(]+)/.exec(this.constructor.toString());if((results!=null?results.length:void 0)>1){return results[1]}else{return""}};State.getName=function(){var results;results=/function ([^(]+)/.exec(this.toString());if((results!=null?results.length:void 0)>1){return results[1]}else{return""}};return State}();Init=function(superClass){extend1(Init,superClass);function Init(){return Init.__super__.constructor.apply(this,arguments)}return Init}(State);Start=function(superClass){extend1(Start,superClass);function Start(){return Start.__super__.constructor.apply(this,arguments)}Start.prototype.enter=function(data){return fsm.next(CheckScriptPostion,data)};return Start}(State);CheckScriptPostion=function(superClass){extend1(CheckScriptPostion,superClass);function CheckScriptPostion(){return CheckScriptPostion.__super__.constructor.apply(this,arguments)}CheckScriptPostion.prototype.enter=function(data){var e,error,i,ref1,ref2,script,scripts;scripts=document.getElementsByTagName("script");try{for(i in scripts){if(!hasProp.call(scripts,i))continue;script=scripts[i];if((typeof script.getAttribute==="function"?(ref1=script.getAttribute("src"))!=null?ref1.indexOf("userlike-cdn-widgets"):void 0:void 0)>-1){if(((ref2=script.parentElement)!=null?ref2.nodeName:void 0)==="HEAD"){_ullog("####################################################################");_ullog("# WARNING: The Userlike script should not be included in the header");_ullog("####################################################################")}}}}catch(error){e=error;_ullog("Error checking script postion")}return fsm.next(ConfigSetup,data)};return CheckScriptPostion}(State);ConfigSetup=function(superClass){extend1(ConfigSetup,superClass);function ConfigSetup(){return ConfigSetup.__super__.constructor.apply(this,arguments)}ConfigSetup.prototype.enter=function(data){config=new Config(data.app_key,data.widget_key,data.config);cookieCleanup();return fsm.next(FontLoader)};return ConfigSetup}(State);FontLoader=function(superClass){extend1(FontLoader,superClass);function FontLoader(){return FontLoader.__super__.constructor.apply(this,arguments)}FontLoader.prototype.enter=function(){var e,error,ref1,s,wf;if((ref1=config.theme.font)==="sans-serif"||ref1==="serif"){return fsm.next(SessionSetup)}try{window.WebFontConfig={google:{families:[config.theme.font]}};wf=document.createElement("script");wf.src="https://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js";
wf.type="text/javascript";wf.async="true";s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(wf,s)}catch(error){e=error;_ullog("Error loading font ",e)}return fsm.next(SessionSetup)};return FontLoader}(State);SessionSetup=function(superClass){extend1(SessionSetup,superClass);function SessionSetup(){return SessionSetup.__super__.constructor.apply(this,arguments)}SessionSetup.prototype.enter=function(){session=(new SessionFactory).get();return fsm.next(NoStateCheck)};return SessionSetup}(State);NoStateCheck=function(superClass){extend1(NoStateCheck,superClass);function NoStateCheck(){return NoStateCheck.__super__.constructor.apply(this,arguments)}NoStateCheck.prototype.enter=function(){var ref1;if(((ref1=window.userlike)!=null?ref1.nostate:void 0)!=null&&window.userlike.nostate){_ullog("###################################################################");_ullog("WARNING: Widget in nostate mode. Sessions don't persist on page change");_ullog("###################################################################");return fsm.next(ResetState)}else{return fsm.next(WidgetVerify)}};return NoStateCheck}(State);ResetState=function(superClass){extend1(ResetState,superClass);function ResetState(){return ResetState.__super__.constructor.apply(this,arguments)}ResetState.prototype.enter=function(){session.reset();return fsm.next(WidgetVerify)};return ResetState}(State);WidgetVerify=function(superClass){extend1(WidgetVerify,superClass);function WidgetVerify(){return WidgetVerify.__super__.constructor.apply(this,arguments)}WidgetVerify.prototype.enter=function(){var data,e,error;if(session.isActive()){data=session.getConfig();_ullog("WidgetVerify current="+config.widget_key+" stored="+(data!=null?data.widget_key:void 0));if(data&&data.widget_key!==config.widget_key&&data.config&&data.app_key){try{_ullog("###################################################################");_ullog("INFO: Using presisted config");_ullog("###################################################################");fsm.next(ConfigSetup,data);return}catch(error){e=error;_ullog("Error getting original config")}}}return fsm.next(Setup)};return WidgetVerify}(State);Setup=function(superClass){extend1(Setup,superClass);function Setup(){return Setup.__super__.constructor.apply(this,arguments)}Setup.prototype.enter=function(){button=(new ButtonFactory).makeButton();goal=new WidgetGoal;slot=new Slot;popup=new Popup;progress_view=new ProgressView;idle_view=new IdleView;message_view=new MessageView;disclaimer_view=new DisclaimerView;offline_message_view=new OfflineMessageView;register_view=new RegisterView;group_select_view=new GroupSelectView;chat_view=new ChatView;transcript_view=new TranscriptView;survey_view=new SurveyView;rating_view=new RatingView;feedback_view=new FeedbackView;feedback_rating_composite_view=new FeedbackRatingCompositeView;social_composite_view=new SocialCompositeView;twitter_view=new TwitterView;facebook_view=new FacebookView;tracking=(new TrackingFactory).get();tracking_event=new TrackingEvent;sound=(new SoundFactory).get();return fsm.next(CustomCSS)};return Setup}(State);CustomCSS=function(superClass){extend1(CustomCSS,superClass);function CustomCSS(){return CustomCSS.__super__.constructor.apply(this,arguments)}CustomCSS.prototype.enter=function(){var custom_style_element;if(config.custom_css!=null&&config.custom_css.length>0){custom_style_element=document.createElement("style");custom_style_element.type="text/css";if(custom_style_element.styleSheet){custom_style_element.styleSheet.cssText=config.custom_css}else{custom_style_element.appendChild(document.createTextNode(config.custom_css))}document.getElementsByTagName("head")[0].appendChild(custom_style_element)}return fsm.next(BlockedCheck)};return CustomCSS}(State);BlockedCheck=function(superClass){extend1(BlockedCheck,superClass);function BlockedCheck(){return BlockedCheck.__super__.constructor.apply(this,arguments)}BlockedCheck.prototype.enter=function(){if(session.get("blocked")){return fsm.next(Blocked)}else{return fsm.next(WhitelistCheck)}};return BlockedCheck}(State);this.userlikeCallbackGeoIP=function(data){return fsm.event("response",data)};WhitelistCheck=function(superClass){extend1(WhitelistCheck,superClass);function WhitelistCheck(){return WhitelistCheck.__super__.constructor.apply(this,arguments)}WhitelistCheck.prototype.enter=function(){var ref1;if(((ref1=window.userlike)!=null?ref1.whitelist:void 0)!=null){return fsm.event("check")}else{return fsm.event("done")}};WhitelistCheck.prototype.check=function(){if(session.get("whitelist")===1){return fsm.event("done")}else{this.timer=setTimeout(function(){return fsm.event("timerFired")},State.timeout_load_script);return Loader.loadScript("api.userlike.com/api/chat/geoip/?&callback=userlikeCallbackGeoIP",function(){})}};WhitelistCheck.prototype.response=function(data){clearTimeout(this.timer);if(window.userlike.whitelist.indexOf(data.country_code)>-1){fsm.event("done");return session.set("whitelist",1)}else{return _ullog("No whitelist match for "+data.country_code)}};WhitelistCheck.prototype.done=function(){return fsm.next(CheckMobileDevice)};WhitelistCheck.prototype.timerFired=function(){};WhitelistCheck.prototype.leave=function(callback){clearTimeout(this.timer);return callback()};return WhitelistCheck}(State);CheckMobileDevice=function(superClass){extend1(CheckMobileDevice,superClass);function CheckMobileDevice(){return CheckMobileDevice.__super__.constructor.apply(this,arguments)}CheckMobileDevice.prototype.enter=function(){if(is_mobile&&config.mobile_mode==="disabled"){button.hide();return _ullog("Disabled on mobile devices")}else{return fsm.next(LoadLib)}};return CheckMobileDevice}(State);LoadLib=function(superClass){extend1(LoadLib,superClass);function LoadLib(){return LoadLib.__super__.constructor.apply(this,arguments)}LoadLib.prototype.enter=function(){return Loader.loadLib(function(){return fsm.next(RemoteControlCheck)})};return LoadLib}(State);RemoteControlCheck=function(superClass){extend1(RemoteControlCheck,superClass);function RemoteControlCheck(){return RemoteControlCheck.__super__.constructor.apply(this,arguments)}RemoteControlCheck.prototype.enter=function(){var state;state=session.getState();if(state==="Chat"||state==="ChatMinimized"){return fsm.next(WidgetInsert)}else if(config.mode_remote){return fsm.next(RemoteApiMode)}else{return fsm.next(ButtonCheck)}};return RemoteControlCheck}(State);RemoteApiMode=function(superClass){extend1(RemoteApiMode,superClass);function RemoteApiMode(){return RemoteApiMode.__super__.constructor.apply(this,arguments)}RemoteApiMode.prototype.enter=function(){var fn;fn=window["userlikeRemoteReady"];if(typeof fn==="function"){return fn()}};RemoteApiMode.prototype.reset=function(){return session.reset()};RemoteApiMode.prototype.normal=function(){return fsm.next(ButtonCheck)};RemoteApiMode.prototype.register=function(){config.mode_registration=true;config.mode_proactive=false;config.mode_proactive_registration=false;return fsm.next(ButtonCheck)};RemoteApiMode.prototype.proactive_passive=function(data){config.mode_proactive_registration=false;config.mode_registration=false;config.mode_proactive=true;config.proactive_passive_connect=true;if(data.message){config.proactive_message=data.message}if(data.timeout){config.proactive_timeout=data.timeout}return fsm.next(ButtonCheck)};RemoteApiMode.prototype.proactive_passive_register=function(data){config.mode_proactive=false;config.mode_registration=false;config.mode_proactive_registration=true;config.proactive_passive_connect=true;if(data.message){config.proactive_message=data.message}if(data.timeout){config.proactive_timeout=data.timeout}return fsm.next(ButtonCheck)};return RemoteApiMode}(State);Blocked=function(superClass){extend1(Blocked,superClass);function Blocked(){return Blocked.__super__.constructor.apply(this,arguments)}return Blocked}(State);this.userlikeCallbackButtonCheck=function(resp){_ullog("message="+(resp!=null?resp.message:void 0));slot.setCache(resp);if(resp.message==="GROUP_ONLINE"){return fsm.event("groupAvailable")}else{return fsm.event("groupUnavailable")}};ButtonCheck=function(superClass){extend1(ButtonCheck,superClass);function ButtonCheck(){return ButtonCheck.__super__.constructor.apply(this,arguments)}ButtonCheck.prototype.enter=function(){return slot.checkButton("userlikeCallbackButtonCheck")};ButtonCheck.prototype.groupAvailable=function(){return fsm.next(ButtonShow)};ButtonCheck.prototype.groupUnavailable=function(){if(config.hide_button){return fsm.next(ButtonHidden)}else{return fsm.next(ButtonChange)}};return ButtonCheck}(State);ButtonChange=function(superClass){extend1(ButtonChange,superClass);function ButtonChange(){return ButtonChange.__super__.constructor.apply(this,arguments)}ButtonChange.prototype.enter=function(){button.changeToOfflineText();return fsm.next(WidgetInsert)};return ButtonChange}(State);ButtonShow=function(superClass){extend1(ButtonShow,superClass);function ButtonShow(){return ButtonShow.__super__.constructor.apply(this,arguments)}ButtonShow.prototype.enter=function(){return fsm.next(WidgetInsert)};return ButtonShow}(State);ButtonHidden=function(superClass){extend1(ButtonHidden,superClass);function ButtonHidden(){return ButtonHidden.__super__.constructor.apply(this,arguments)}ButtonHidden.prototype.enter=function(){tracking_event.trigger("button_hidden");button.hide();return fsm.next(ButtonHiddenWidgetInsert)};return ButtonHidden}(State);WidgetInsert=function(superClass){extend1(WidgetInsert,superClass);function WidgetInsert(){return WidgetInsert.__super__.constructor.apply(this,arguments)}WidgetInsert.prototype.enter=function(){this.timer=setTimeout(function(){return fsm.event("timerFired")},State.timeout);return Loader.injectMarkup(function(err){if(err){return fsm.event("injectFailed")}else{return fsm.event("injectDone")}})};WidgetInsert.prototype.injectFailed=function(){return fsm.next(SetupError)};WidgetInsert.prototype.injectDone=function(){return fsm.next(SetupTheme)};WidgetInsert.prototype.timerFired=function(){return fsm.next(SetupError)};WidgetInsert.prototype.leave=function(callback){clearTimeout(this.timer);return callback()};return WidgetInsert}(State);ButtonHiddenWidgetInsert=function(superClass){extend1(ButtonHiddenWidgetInsert,superClass);function ButtonHiddenWidgetInsert(){return ButtonHiddenWidgetInsert.__super__.constructor.apply(this,arguments)}ButtonHiddenWidgetInsert.prototype.injectDone=function(){return fsm.next(ButtonEventSetup)};return ButtonHiddenWidgetInsert}(WidgetInsert);SetupTheme=function(superClass){extend1(SetupTheme,superClass);function SetupTheme(){return SetupTheme.__super__.constructor.apply(this,arguments)}SetupTheme.prototype.enter=function(){popup.setupTheme();return fsm.next(ButtonInsert)};return SetupTheme}(State);ButtonInsert=function(superClass){extend1(ButtonInsert,superClass);function ButtonInsert(){return ButtonInsert.__super__.constructor.apply(this,arguments)}ButtonInsert.prototype.enter=function(){var delay;button.render();delay=!session.isActive();button.show(delay);tracking_event.trigger("button_displayed");if(is_mobile){_jq("#userlike").addClass("userlike-mobile")}return fsm.next(ButtonEventSetup)};return ButtonInsert}(State);ButtonEventSetup=function(superClass){extend1(ButtonEventSetup,superClass);function ButtonEventSetup(){return ButtonEventSetup.__super__.constructor.apply(this,arguments)}ButtonEventSetup.prototype.enter=function(){button.registerEvents();return fsm.next(UserlikeReady)};return ButtonEventSetup}(State);SetupError=function(superClass){extend1(SetupError,superClass);function SetupError(){return SetupError.__super__.constructor.apply(this,arguments)}return SetupError}(State);UserlikeReady=function(superClass){extend1(UserlikeReady,superClass);function UserlikeReady(){return UserlikeReady.__super__.constructor.apply(this,arguments)}UserlikeReady.prototype.enter=function(){var fn;fn=window["userlikeReady"];if(typeof fn==="function"){fn()}return fsm.next(RestoreState)};return UserlikeReady}(State);RestoreState=function(superClass){extend1(RestoreState,superClass);function RestoreState(){return RestoreState.__super__.constructor.apply(this,arguments)}RestoreState.prototype.enter=function(){if(session.get("uuid")&&session.get("chat_meta_id")){goal.check()}if(!getCookieSupport()||!getStorageSupport()){return fsm.next(NoCookies)}else if(session.isActive()){return fsm.next(RestartSlot)}else if(session.isRject()){return fsm.next(ProactiveSlotReject)}else if(session.isOffline()){return fsm.next(Offline)}else if(config.mode_proactive||config.mode_proactive_registration){return fsm.next(ProactiveTimer)}else{return fsm.next(Idle)}};return RestoreState}(State);Idle=function(superClass){extend1(Idle,superClass);function Idle(){return Idle.__super__.constructor.apply(this,arguments)}Idle.prototype.enter=function(){session.reset();session.setState("Idle");return fsm.reset()};Idle.prototype.chatButton=function(){button.fadeOutEyecatcher();tracking_event.trigger("chat_requested");fsm.queue("slotRequest");return fsm.next(FacebookLoader)};Idle.prototype.directRequest=function(operator_id){tracking_event.trigger("chat_requested");fsm.queue("directRequest",{operator_id:operator_id});return fsm.next(FacebookLoader)};Idle.prototype.updateAPI=function(){return session.updateUserData()};return Idle}(State);NoCookies=function(superClass){extend1(NoCookies,superClass);function NoCookies(){return NoCookies.__super__.constructor.apply(this,arguments)}NoCookies.prototype.chatButton=function(){button.fadeOutEyecatcher();return fsm.next(NoCookiesMessage)};NoCookies.prototype.directRequest=function(operator_id){return fsm.next(NoCookiesMessage)};return NoCookies}(Idle);PageUnloading=function(superClass){extend1(PageUnloading,superClass);function PageUnloading(){return PageUnloading.__super__.constructor.apply(this,arguments)}return PageUnloading}(State);Offline=function(superClass){extend1(Offline,superClass);function Offline(){return Offline.__super__.constructor.apply(this,arguments)}Offline.prototype.persist=function(){session.reset();return session.setState("Offline")};return Offline}(Idle);NoSwitch=function(superClass){extend1(NoSwitch,superClass);function NoSwitch(){return NoSwitch.__super__.constructor.apply(this,arguments)}NoSwitch.prototype.enter=function(){};NoSwitch.prototype.persist=function(){};NoSwitch.prototype.chatButton=function(){button.fadeOutEyecatcher();return fsm.next(SwitchSocketConnect)};NoSwitch.prototype.directRequest=function(operator_id){return fsm.next(SwitchSocketConnect)};return NoSwitch}(Idle);ProactiveTimer=function(superClass){extend1(ProactiveTimer,superClass);function ProactiveTimer(){return ProactiveTimer.__super__.constructor.apply(this,arguments)}ProactiveTimer.prototype.chatButton=function(){button.fadeOutEyecatcher();fsm.queue("slotRequest");return fsm.next(FacebookLoader)};ProactiveTimer.prototype.directRequest=function(operator_id){fsm.queue("directRequest",{operator_id:operator_id});return fsm.next(FacebookLoader)};ProactiveTimer.prototype.timerFired=function(){return fsm.next(ProactiveSlotCheck)};ProactiveTimer.prototype.enter=function(){var delay;delay=parseInt(config.proactive_timeout)+parseInt(button.delayProactive());_ullog("ProactiveTimer::enter delay="+delay);return this.timer=setTimeout(function(){return fsm.event("timerFired")},delay*1e3)};ProactiveTimer.prototype.leave=function(callback){clearTimeout(this.timer);return callback()};ProactiveTimer.prototype.updateAPI=function(){return session.updateUserData()};return ProactiveTimer}(State);this.userlikeCallbackProactiveSlotCheck=function(resp){if(resp.operator!=null){return fsm.event("slotAvailable",resp)}else{return fsm.event("slotUnavailable",resp)}};ProactiveSlotCheck=function(superClass){extend1(ProactiveSlotCheck,superClass);function ProactiveSlotCheck(){return ProactiveSlotCheck.__super__.constructor.apply(this,arguments)}ProactiveSlotCheck.prototype.enter=function(){tracking_event.trigger("proactive_timer");this.timer=setTimeout(function(){return fsm.event("timerFired")},State.timeout);return slot.checkProactive("userlikeCallbackProactiveSlotCheck")};ProactiveSlotCheck.prototype.slotAvailable=function(data){return fsm.next(ProactiveSlotAvailable,data)};ProactiveSlotCheck.prototype.slotUnavailable=function(data){return fsm.next(ProactiveSlotUnavailable)};ProactiveSlotCheck.prototype.timerFired=function(){return fsm.next(Idle)};ProactiveSlotCheck.prototype.leave=function(callback){clearTimeout(this.timer);return callback()};return ProactiveSlotCheck}(State);ProactiveSlotUnavailable=function(superClass){extend1(ProactiveSlotUnavailable,superClass);function ProactiveSlotUnavailable(){return ProactiveSlotUnavailable.__super__.constructor.apply(this,arguments)}ProactiveSlotUnavailable.prototype.enter=function(){tracking_event.trigger("proactive_unavailable");return fsm.next(Idle)};return ProactiveSlotUnavailable}(State);ProactiveSlotAvailable=function(superClass){extend1(ProactiveSlotAvailable,superClass);function ProactiveSlotAvailable(){return ProactiveSlotAvailable.__super__.constructor.apply(this,arguments)}ProactiveSlotAvailable.prototype.enter=function(data){return fsm.next(ProactiveEventSetup,data)};return ProactiveSlotAvailable}(State);ProactiveEventSetup=function(superClass){extend1(ProactiveEventSetup,superClass);function ProactiveEventSetup(){return ProactiveEventSetup.__super__.constructor.apply(this,arguments)}ProactiveEventSetup.prototype.enter=function(data){_jq.windowOn("hashchange",function(){return fsm.event("hashchange",window.location.hash)});_jq.windowOn("unload",function(){return fsm.next(PageUnloading)});fsm.event("done",data);return sound.load()};ProactiveEventSetup.prototype.done=function(data){return fsm.next(ProactiveOffer,data)};return ProactiveEventSetup}(State);ProactiveOffer=function(superClass){extend1(ProactiveOffer,superClass);function ProactiveOffer(){return ProactiveOffer.__super__.constructor.apply(this,arguments)}ProactiveOffer.prototype.enter=function(data){return fsm.next(ProactiveSlotOfferPassiveStart,data)};return ProactiveOffer}(State);ProactiveSlotOfferPassiveStart=function(superClass){extend1(ProactiveSlotOfferPassiveStart,superClass);function ProactiveSlotOfferPassiveStart(){return ProactiveSlotOfferPassiveStart.__super__.constructor.apply(this,arguments)}ProactiveSlotOfferPassiveStart.prototype.enter=function(data){session.setOperator(data.operator);tracking.offerProactiveChat();tracking_event.trigger("proactive_offer");chat_view.setProactiveMessage(config.proactive_message);return chat_view.displaySlot(data.operator.display_name,data.operator.url_image,config.status_message,function(){chat_view.sendProactiveMessage();return fsm.next(ProactiveSlotOfferPassive)})};return ProactiveSlotOfferPassiveStart}(State);ProactiveSlotOfferPassive=function(superClass){extend1(ProactiveSlotOfferPassive,superClass);function ProactiveSlotOfferPassive(){return ProactiveSlotOfferPassive.__super__.constructor.apply(this,arguments)}ProactiveSlotOfferPassive.prototype.transitionIn=function(callback){button.fadeOutEyecatcher();return chat_view.show(callback)};ProactiveSlotOfferPassive.prototype.inputEnter=function(data){var text;text=chat_view.sendMessage();fsm.queue("sendMessage",text);return fsm.next(ProactivePassiveSocketConnect)};ProactiveSlotOfferPassive.prototype.closeButton=function(){return fsm.next(ProactiveSlotRejected)};ProactiveSlotOfferPassive.prototype.minimizeButton=function(){return fsm.next(ProactiveSlotRejected)};ProactiveSlotOfferPassive.prototype.chatButton=function(){return fsm.next(ProactiveSlotRejected)};return ProactiveSlotOfferPassive}(State);ProactiveSlotRejected=function(superClass){extend1(ProactiveSlotRejected,superClass);function ProactiveSlotRejected(){return ProactiveSlotRejected.__super__.constructor.apply(this,arguments)}ProactiveSlotRejected.prototype.transitionIn=function(callback){return popup.close(callback)};ProactiveSlotRejected.prototype.enter=function(){tracking_event.trigger("proactive_reject");return fsm.next(ProactiveSlotReject)};return ProactiveSlotRejected}(State);ProactiveSlotReject=function(superClass){extend1(ProactiveSlotReject,superClass);function ProactiveSlotReject(){return ProactiveSlotReject.__super__.constructor.apply(this,arguments)}ProactiveSlotReject.prototype.persist=function(){return session.setState("ProactiveSlotReject")};ProactiveSlotReject.prototype.chatButton=function(){fsm.queue("slotRequest");return fsm.next(FacebookLoader)};ProactiveSlotReject.prototype.directRequest=function(operator_id){fsm.queue("directRequest",{operator_id:operator_id});return fsm.next(FacebookLoader)};return ProactiveSlotReject}(State);ProactivePassiveSocketConnect=function(superClass){extend1(ProactivePassiveSocketConnect,superClass);function ProactivePassiveSocketConnect(){return ProactivePassiveSocketConnect.__super__.constructor.apply(this,arguments)}ProactivePassiveSocketConnect.prototype.inputEnter=function(data){var text;text=chat_view.sendMessage();return fsm.queue("sendMessage",text)};ProactivePassiveSocketConnect.prototype.connect=function(){return fsm.next(ProactivePassiveSlotCreate)};ProactivePassiveSocketConnect.prototype.error=function(){return fsm.next(OfflineMessage)};ProactivePassiveSocketConnect.prototype.connectFailed=function(){return fsm.next(OfflineMessage)};ProactivePassiveSocketConnect.prototype.enter=function(){this.timer=setTimeout(function(){return fsm.event("timerFired")},State.timeout_connect);return slot.connect()};ProactivePassiveSocketConnect.prototype.timerFired=function(){return fsm.next(OfflineMessage)};ProactivePassiveSocketConnect.prototype.leave=function(callback){clearTimeout(this.timer);return callback()};return ProactivePassiveSocketConnect}(State);ProactivePassiveSlotCreate=function(superClass){extend1(ProactivePassiveSlotCreate,superClass);function ProactivePassiveSlotCreate(){return ProactivePassiveSlotCreate.__super__.constructor.apply(this,arguments)}ProactivePassiveSlotCreate.prototype.inputEnter=function(data){var text;text=chat_view.sendMessage();return fsm.queue("sendMessage",text)};ProactivePassiveSlotCreate.prototype.slotCreated=function(data){return fsm.next(ProactivePassiveSlotVerify,data)};ProactivePassiveSlotCreate.prototype.enter=function(){this.timer=setTimeout(function(){return fsm.event("timerFired")},State.timeout_connect);return slot.create({proactive:true})};ProactivePassiveSlotCreate.prototype.timerFired=function(){slot.disconnect();return fsm.next(OfflineMessage)};ProactivePassiveSlotCreate.prototype.leave=function(callback){clearTimeout(this.timer);return callback()};return ProactivePassiveSlotCreate}(State);ProactivePassiveSlotVerify=function(superClass){extend1(ProactivePassiveSlotVerify,superClass);function ProactivePassiveSlotVerify(){return ProactivePassiveSlotVerify.__super__.constructor.apply(this,arguments)}ProactivePassiveSlotVerify.prototype.enter=function(data){if(data.operator){return fsm.next(ProactivePassiveSlotStart,data)}else{return fsm.next(OfflineMessage)}};return ProactivePassiveSlotVerify}(State);ProactivePassiveSlotStart=function(superClass){extend1(ProactivePassiveSlotStart,superClass);function ProactivePassiveSlotStart(){return ProactivePassiveSlotStart.__super__.constructor.apply(this,arguments)}ProactivePassiveSlotStart.prototype.enter=function(data){session.set("id",data.id);session.setIfEmpty("uuid",data.uuid);session.set("chat_meta_id",data.chat_meta_id);session.set("was_proactive",true);session.resetStats();if(session.get("operator_id")===data.operator.id){session.setOperator(data.operator);tracking.startProactiveSlot();tracking_event.trigger("chat_connected");tracking_event.trigger("chat_connected_proactive");return fsm.next(Chat)}else{session.setOperator(data.operator);tracking.startProactiveSlot();chat_view.setProactiveMessage(config.proactive_message);return chat_view.displaySlot(data.operator.display_name,data.operator.url_image,config.status_message,function(){tracking_event.trigger("chat_connected");tracking_event.trigger("chat_connected_proactive");return fsm.next(Chat)})}};return ProactivePassiveSlotStart}(State);FacebookLoader=function(superClass){extend1(FacebookLoader,superClass);function FacebookLoader(){return FacebookLoader.__super__.constructor.apply(this,arguments)}FacebookLoader.prototype.enter=function(){if(!facebook&&config.facebook_integration==="load"){if(config.facebook_connect==="register"){return fsm.event("loadSync")}else{return fsm.event("loadAsync")}}else{return fsm.event("done")}};FacebookLoader.prototype.timerFired=function(){return fsm.event("done")};FacebookLoader.prototype.leave=function(callback){clearTimeout(this.timer);return callback()};FacebookLoader.prototype.loadAsync=function(){var e,error;window.fbAsyncInit=function(){FB.init({appId:config.facebook_app_id,status:true,cookies:true,xfbml:true});facebook=true;_ullog("FacebookLoader loaded integration="+config.facebook_integration+" facebook_ready="+facebook)};if(window.FB!==void 0){try{window.FB=null;delete window.FB}catch(error){e=error;_ullog("FacebookLoader cannot delete existing sdk")}}Loader.loadScript("connect.facebook.net/"+config.locale+"/all.js",function(){});return fsm.event("done")};FacebookLoader.prototype.loadSync=function(){var e,error;window.fbAsyncInit=function(_this){return function(){clearTimeout(_this.timer);FB.init({appId:config.facebook_app_id,status:true,cookies:true,xfbml:true});return fsm.event("done")}}(this);if(window.FB!==void 0){try{window.FB=null;delete window.FB}catch(error){e=error;_ullog("FacebookLoader cannot delete existing sdk")}}this.timer=setTimeout(function(){return fsm.event("timerFired")},State.timeout_load_script);return Loader.loadScript("connect.facebook.net/"+config.locale+"/all.js",function(){})};FacebookLoader.prototype.done=function(){facebook=window.FB!==void 0;_ullog("FacebookLoader integration="+config.facebook_integration+" facebook_ready="+facebook);return fsm.next(TwitterLoader)};return FacebookLoader}(State);TwitterLoader=function(superClass){extend1(TwitterLoader,superClass);function TwitterLoader(){return TwitterLoader.__super__.constructor.apply(this,arguments)}TwitterLoader.prototype.timerFired=function(){return fsm.event("done")};TwitterLoader.prototype.leave=function(callback){clearTimeout(this.timer);return callback()};TwitterLoader.prototype.enter=function(){if(config.twitter_integration==="disabled"){return fsm.event("done")}else if(config.twitter_integration==="load"){this.timer=setTimeout(function(){return fsm.event("timerFired")},State.timeout_load_script);Loader.loadScript("platform.twitter.com/widgets.js",function(){twitter=true;return _ullog("TwitterLoader integration="+config.twitter_integration+" twitter="+twitter)});return fsm.event("done")}else if(config.twitter_integration==="extern"){twitter=window.twttr!==void 0;return fsm.event("done")}};TwitterLoader.prototype.done=function(){_ullog("TwitterLoader integration="+config.twitter_integration+" twitter="+twitter);return fsm.next(EventSetup)};return TwitterLoader}(State);EventSetup=function(superClass){extend1(EventSetup,superClass);function EventSetup(){return EventSetup.__super__.constructor.apply(this,arguments)}EventSetup.prototype.done=function(data){return fsm.next(CheckDisclaimer,data)};return EventSetup}(ProactiveEventSetup);this.userlikeCallbackAvailableCheck=function(resp){_ullog("message="+(resp!=null?resp.message:void 0));slot.setCache(resp);if(resp.message==="GROUP_ONLINE"){return fsm.event("groupAvailable",resp)}else{return fsm.event("groupUnavailable")}};CheckDisclaimer=function(superClass){extend1(CheckDisclaimer,superClass);function CheckDisclaimer(){return CheckDisclaimer.__super__.constructor.apply(this,arguments)}CheckDisclaimer.prototype.enter=function(){if(config.disclaimer_show){return fsm.next(DisclaimerAvailableCheck)}else{return fsm.next(CheckPreChatFirst)}};return CheckDisclaimer}(State);CheckPreChatFirst=function(superClass){extend1(CheckPreChatFirst,superClass);function CheckPreChatFirst(){return CheckPreChatFirst.__super__.constructor.apply(this,arguments)}CheckPreChatFirst.prototype.enter=function(){if(config.mode_registration||config.mode_proactive_registration){return fsm.next(RegisterAvailableCheck)}else{return fsm.next(CheckPreChatSecond)}};return CheckPreChatFirst}(State);CheckPreChatSecond=function(superClass){extend1(CheckPreChatSecond,superClass);function CheckPreChatSecond(){return CheckPreChatSecond.__super__.constructor.apply(this,arguments)}CheckPreChatSecond.prototype.enter=function(){if(config.group_select_enabled){return fsm.next(GroupSelectAvailableCheck)}else{return fsm.next(CheckPreChatThird)}};return CheckPreChatSecond}(State);CheckPreChatThird=function(superClass){extend1(CheckPreChatThird,superClass);function CheckPreChatThird(){return CheckPreChatThird.__super__.constructor.apply(this,arguments)}CheckPreChatThird.prototype.enter=function(){if(config.pre_survey_enabled){return fsm.next(PreSurveyAvailableCheck)}else{return fsm.next(CheckSlotAvailable)}};return CheckPreChatThird}(State);CheckSlotAvailable=function(superClass){extend1(CheckSlotAvailable,superClass);function CheckSlotAvailable(){return CheckSlotAvailable.__super__.constructor.apply(this,arguments)}CheckSlotAvailable.prototype.enter=function(){this.timer=setTimeout(function(){return fsm.event("timerFired")},State.timeout);tracking_event.trigger("slot_check");return slot.checkAvailable("userlikeCallbackAvailableCheck")};CheckSlotAvailable.prototype.groupAvailable=function(){button.changeToOnlineText();tracking_event.trigger("slot_available");return fsm.next(CheckPreChatLast)};CheckSlotAvailable.prototype.groupUnavailable=function(){tracking_event.trigger("slot_unavailable");return fsm.next(OfflineMessage)};CheckSlotAvailable.prototype.timerFired=function(){return fsm.next(OfflineMessage)};CheckSlotAvailable.prototype.leave=function(callback){clearTimeout(this.timer);return callback()};return CheckSlotAvailable}(State);CheckPreChatLast=function(superClass){extend1(CheckPreChatLast,superClass);function CheckPreChatLast(){return CheckPreChatLast.__super__.constructor.apply(this,arguments)}CheckPreChatLast.prototype.transitionIn=function(callback){button.fadeOutEyecatcher();return chat_view.showConnectView(callback)};CheckPreChatLast.prototype.enter=function(){if(config.passive_connect){return fsm.next(PassiveConnectAvailableCheck)}else{return fsm.next(SocketConnect)}};return CheckPreChatLast}(State);this.userlikeCallbackPassiveConnectSlotCheck=function(resp){if(resp.operator!=null){return fsm.event("slotAvailable",resp)}else{return fsm.event("slotUnavailable",resp)}};PassiveConnectAvailableCheck=function(superClass){extend1(PassiveConnectAvailableCheck,superClass);function PassiveConnectAvailableCheck(){return PassiveConnectAvailableCheck.__super__.constructor.apply(this,arguments)}PassiveConnectAvailableCheck.prototype.enter=function(){this.timer=setTimeout(function(){return fsm.event("timerFired")},State.timeout);return slot.checkPassiveConnect("userlikeCallbackPassiveConnectSlotCheck")};PassiveConnectAvailableCheck.prototype.inputEnter=function(data){var text;text=chat_view.sendMessage();return fsm.queue("sendMessage",text)};PassiveConnectAvailableCheck.prototype.slotAvailable=function(data){return fsm.next(PassiveConnectStart,data)};PassiveConnectAvailableCheck.prototype.slotUnavailable=function(data){return fsm.next(OfflineMessage)};PassiveConnectAvailableCheck.prototype.timerFired=function(){return fsm.next(OfflineMessage)};PassiveConnectAvailableCheck.prototype.leave=function(callback){clearTimeout(this.timer);return callback()};return PassiveConnectAvailableCheck}(State);DisclaimerAvailableCheck=function(superClass){extend1(DisclaimerAvailableCheck,superClass);function DisclaimerAvailableCheck(){return DisclaimerAvailableCheck.__super__.constructor.apply(this,arguments)}DisclaimerAvailableCheck.prototype.enter=function(){this.timer=setTimeout(function(){return fsm.event("timerFired")},State.timeout);tracking_event.trigger("slot_check");
return slot.checkAvailable("userlikeCallbackAvailableCheck")};DisclaimerAvailableCheck.prototype.groupAvailable=function(){button.changeToOnlineText();tracking_event.trigger("slot_available");return fsm.next(Disclaimer)};DisclaimerAvailableCheck.prototype.groupUnavailable=function(){tracking_event.trigger("slot_unavailable");return fsm.next(OfflineMessage)};DisclaimerAvailableCheck.prototype.timerFired=function(){return fsm.next(OfflineMessage)};DisclaimerAvailableCheck.prototype.leave=function(callback){clearTimeout(this.timer);return callback()};return DisclaimerAvailableCheck}(State);Disclaimer=function(superClass){extend1(Disclaimer,superClass);function Disclaimer(){return Disclaimer.__super__.constructor.apply(this,arguments)}Disclaimer.prototype.enter=function(){button.fadeOutEyecatcher();return disclaimer_view.show(function(){})};Disclaimer.prototype.chatButton=function(){tracking_event.trigger("disclaimer_cancel");return popup.close(function(){return fsm.next(Idle)})};Disclaimer.prototype.closeButton=function(){tracking_event.trigger("disclaimer_cancel");return popup.close(function(){return fsm.next(Idle)})};Disclaimer.prototype.submitButton=function(){tracking_event.trigger("disclaimer_ok");return fsm.next(CheckPreChatFirst)};return Disclaimer}(State);RegisterAvailableCheck=function(superClass){extend1(RegisterAvailableCheck,superClass);function RegisterAvailableCheck(){return RegisterAvailableCheck.__super__.constructor.apply(this,arguments)}RegisterAvailableCheck.prototype.enter=function(){this.timer=setTimeout(function(){return fsm.event("timerFired")},State.timeout);tracking_event.trigger("slot_check");return slot.checkAvailable("userlikeCallbackAvailableCheck")};RegisterAvailableCheck.prototype.groupAvailable=function(){button.changeToOnlineText();tracking_event.trigger("slot_available");return fsm.next(RegisterOptions)};RegisterAvailableCheck.prototype.groupUnavailable=function(){tracking_event.trigger("slot_unavailable");return fsm.next(OfflineMessage)};RegisterAvailableCheck.prototype.timerFired=function(){return fsm.next(OfflineMessage)};RegisterAvailableCheck.prototype.leave=function(callback){clearTimeout(this.timer);return callback()};return RegisterAvailableCheck}(State);PreSurveyAvailableCheck=function(superClass){extend1(PreSurveyAvailableCheck,superClass);function PreSurveyAvailableCheck(){return PreSurveyAvailableCheck.__super__.constructor.apply(this,arguments)}PreSurveyAvailableCheck.prototype.enter=function(){this.timer=setTimeout(function(){return fsm.event("timerFired")},State.timeout);tracking_event.trigger("slot_check");return slot.checkAvailable("userlikeCallbackAvailableCheck")};PreSurveyAvailableCheck.prototype.groupAvailable=function(){button.changeToOnlineText();tracking_event.trigger("slot_available");return fsm.next(PreSurveyForm)};PreSurveyAvailableCheck.prototype.groupUnavailable=function(){tracking_event.trigger("slot_unavailable");return fsm.next(OfflineMessage)};PreSurveyAvailableCheck.prototype.timerFired=function(){return fsm.next(OfflineMessage)};PreSurveyAvailableCheck.prototype.leave=function(callback){clearTimeout(this.timer);return callback()};return PreSurveyAvailableCheck}(State);GroupSelectAvailableCheck=function(superClass){extend1(GroupSelectAvailableCheck,superClass);function GroupSelectAvailableCheck(){return GroupSelectAvailableCheck.__super__.constructor.apply(this,arguments)}GroupSelectAvailableCheck.prototype.enter=function(){this.timer=setTimeout(function(){return fsm.event("timerFired")},State.timeout);tracking_event.trigger("slot_check");return slot.checkAvailable("userlikeCallbackAvailableCheck")};GroupSelectAvailableCheck.prototype.groupAvailable=function(data){button.changeToOnlineText();tracking_event.trigger("slot_available");return fsm.next(GroupSelect,data)};GroupSelectAvailableCheck.prototype.groupUnavailable=function(){tracking_event.trigger("slot_unavailable");return fsm.next(OfflineMessage)};GroupSelectAvailableCheck.prototype.timerFired=function(){return fsm.next(OfflineMessage)};GroupSelectAvailableCheck.prototype.leave=function(callback){clearTimeout(this.timer);return callback()};return GroupSelectAvailableCheck}(State);Warning=function(superClass){extend1(Warning,superClass);function Warning(){return Warning.__super__.constructor.apply(this,arguments)}Warning.prototype.transitionOut=function(callback){return popup.close(callback)};Warning.prototype.chatButton=function(){return fsm.next(Idle)};Warning.prototype.closeButton=function(){return fsm.next(Idle)};Warning.prototype.enter=function(){return this.timer=setTimeout(function(){return fsm.event("timerFired")},State.timeout)};Warning.prototype.timerFired=function(){return fsm.next(Idle)};Warning.prototype.leave=function(callback){clearTimeout(this.timer);return callback()};return Warning}(State);NoCookiesMessage=function(superClass){extend1(NoCookiesMessage,superClass);function NoCookiesMessage(){return NoCookiesMessage.__super__.constructor.apply(this,arguments)}NoCookiesMessage.prototype.transitionIn=function(callback){button.fadeOutEyecatcher();return message_view.showNoCookiesMessage(callback)};NoCookiesMessage.prototype.chatButton=function(){return fsm.next(NoCookies)};NoCookiesMessage.prototype.closeButton=function(){return fsm.next(NoCookies)};NoCookiesMessage.prototype.enter=function(){return this.timer=setTimeout(function(){return fsm.event("timerFired")},State.timeout)};NoCookiesMessage.prototype.timerFired=function(){return fsm.next(NoCookies)};return NoCookiesMessage}(Warning);ErrorMessage=function(superClass){extend1(ErrorMessage,superClass);function ErrorMessage(){return ErrorMessage.__super__.constructor.apply(this,arguments)}ErrorMessage.prototype.enter=function(){return tracking_event.trigger("error_message")};ErrorMessage.prototype.transitionIn=function(callback){button.fadeOutEyecatcher();return message_view.showErrorMessage(callback)};return ErrorMessage}(Warning);ExpiredWarning=function(superClass){extend1(ExpiredWarning,superClass);function ExpiredWarning(){return ExpiredWarning.__super__.constructor.apply(this,arguments)}ExpiredWarning.prototype.enter=function(){button.fadeOutEyecatcher();return message_view.showExpiredWarning(function(){})};return ExpiredWarning}(Warning);OfflineMessage=function(superClass){extend1(OfflineMessage,superClass);function OfflineMessage(){return OfflineMessage.__super__.constructor.apply(this,arguments)}OfflineMessage.prototype.persist=function(){session.setState("Offline");return session.resetChatDuration()};OfflineMessage.prototype.enter=function(){tracking_event.trigger("offline_mode");if(config.offline_mode==="message"){return fsm.next(OfflineMessageForm)}else{return fsm.next(OfflineMessageFeedback)}};return OfflineMessage}(State);OfflineMessageForm=function(superClass){extend1(OfflineMessageForm,superClass);function OfflineMessageForm(){return OfflineMessageForm.__super__.constructor.apply(this,arguments)}OfflineMessageForm.prototype.enter=function(){if(config.geo_type==="browser"){session.getLocation()}tracking_event.trigger("offline_form_show");fsm.poll();return fsm.reset()};OfflineMessageForm.prototype.sendMessage=function(text){offline_message_view.showOfflineMessageForm();return offline_message_view.setTextareaVal(text)};OfflineMessageForm.prototype.transitionIn=function(callback){button.fadeOutEyecatcher();return offline_message_view.showOfflineMessageForm(callback)};OfflineMessageForm.prototype.chatButton=function(){return popup.close(function(){return fsm.next(Idle)})};OfflineMessageForm.prototype.closeButton=function(){return popup.close(function(){return fsm.next(Idle)})};OfflineMessageForm.prototype.submitButton=function(){if(offline_message_view.validateOfflineMessage()){return fsm.next(OfflineMessageProcess)}};OfflineMessageForm.prototype.slotRequest=function(){};OfflineMessageForm.prototype.locationchange=function(){};return OfflineMessageForm}(State);OfflineMessageFeedback=function(superClass){extend1(OfflineMessageFeedback,superClass);function OfflineMessageFeedback(){return OfflineMessageFeedback.__super__.constructor.apply(this,arguments)}OfflineMessageFeedback.prototype.enter=function(){tracking_event.trigger("offline_view_show");fsm.poll();return fsm.reset()};OfflineMessageFeedback.prototype.transitionIn=function(callback){button.fadeOutEyecatcher();return message_view.showOfflineMessageFeedback(callback)};return OfflineMessageFeedback}(OfflineMessageForm);OfflineMessageProcess=function(superClass){extend1(OfflineMessageProcess,superClass);function OfflineMessageProcess(){return OfflineMessageProcess.__super__.constructor.apply(this,arguments)}OfflineMessageProcess.prototype.enter=function(){if(offline_message_view.requestedScreenshot()){return fsm.next(OfflineMessageScreenshot)}else{return fsm.next(OfflineMessageSend)}};return OfflineMessageProcess}(State);OfflineMessageSend=function(superClass){extend1(OfflineMessageSend,superClass);function OfflineMessageSend(){return OfflineMessageSend.__super__.constructor.apply(this,arguments)}OfflineMessageSend.prototype.transitionIn=function(callback){return progress_view.show(callback)};OfflineMessageSend.prototype.success=function(data){return fsm.next(OfflineMessageDone,data)};OfflineMessageSend.prototype.error=function(){return fsm.next(ErrorMessage)};OfflineMessageSend.prototype.enter=function(){this.timer=setTimeout(function(){return fsm.event("timerFired")},State.timeout_connect);tracking_event.trigger("offline_form_submit");return offline_message_view.sendOfflineMessage()};OfflineMessageSend.prototype.timerFired=function(){return fsm.next(ErrorMessage)};OfflineMessageSend.prototype.leave=function(callback){clearTimeout(this.timer);return callback()};return OfflineMessageSend}(State);OfflineMessageDone=function(superClass){extend1(OfflineMessageDone,superClass);function OfflineMessageDone(){return OfflineMessageDone.__super__.constructor.apply(this,arguments)}OfflineMessageDone.prototype.enter=function(data){if(offline_message_view.requestedScreenshot()){if(data.id!=null){return fsm.next(OfflineMessageScreenshotSend,data)}else{return fsm.next(ErrorMessage)}}else{return fsm.next(OfflineMessageSent)}};return OfflineMessageDone}(State);OfflineMessageScreenshot=function(superClass){extend1(OfflineMessageScreenshot,superClass);function OfflineMessageScreenshot(){return OfflineMessageScreenshot.__super__.constructor.apply(this,arguments)}OfflineMessageScreenshot.prototype.transitionIn=function(callback){return progress_view.show(callback)};OfflineMessageScreenshot.prototype.screenshotTaken=function(){return fsm.next(OfflineMessageSend)};OfflineMessageScreenshot.prototype.screenshotError=function(){return fsm.next(OfflineMessageSent)};OfflineMessageScreenshot.prototype.enter=function(){this.timer=setTimeout(function(){return fsm.event("timerFired")},State.timeout_screenshot);return offline_message_view.takeOfflineScreenshot()};OfflineMessageScreenshot.prototype.timerFired=function(){return fsm.next(OfflineMessageSent)};OfflineMessageScreenshot.prototype.leave=function(callback){clearTimeout(this.timer);return callback()};return OfflineMessageScreenshot}(State);OfflineMessageScreenshotSend=function(superClass){extend1(OfflineMessageScreenshotSend,superClass);function OfflineMessageScreenshotSend(){return OfflineMessageScreenshotSend.__super__.constructor.apply(this,arguments)}OfflineMessageScreenshotSend.prototype.screenshotSent=function(){return fsm.next(OfflineMessageSent)};OfflineMessageScreenshotSend.prototype.enter=function(data){return offline_message_view.sendOfflineScreenshot(data.id)};return OfflineMessageScreenshotSend}(State);OfflineMessageSent=function(superClass){extend1(OfflineMessageSent,superClass);function OfflineMessageSent(){return OfflineMessageSent.__super__.constructor.apply(this,arguments)}OfflineMessageSent.prototype.transitionIn=function(callback){return offline_message_view.showOfflineMessageSent(callback)};OfflineMessageSent.prototype.transitionOut=function(callback){return popup.close(callback)};OfflineMessageSent.prototype.chatButton=function(){return popup.close(function(){return fsm.next(Idle)})};OfflineMessageSent.prototype.closeButton=function(){return popup.close(function(){return fsm.next(Idle)})};OfflineMessageSent.prototype.directRequest=function(){return popup.close(function(){return fsm.next(Idle)})};OfflineMessageSent.prototype.enter=function(){this.timer=setTimeout(function(){return fsm.event("timerFired")},State.timeout);return tracking.sendOfflineMessage()};OfflineMessageSent.prototype.timerFired=function(){return fsm.next(Idle)};OfflineMessageSent.prototype.leave=function(callback){clearTimeout(this.timer);return callback()};return OfflineMessageSent}(State);RegisterOptions=function(superClass){extend1(RegisterOptions,superClass);function RegisterOptions(){return RegisterOptions.__super__.constructor.apply(this,arguments)}RegisterOptions.prototype.enter=function(){var ref1,ref2;if(((ref1=session.get("client_name"))!=null?ref1.length:void 0)&&((ref2=session.get("client_email"))!=null?ref2.length:void 0)){return fsm.next(CheckPreChatSecond)}else if(config.facebook_connect!=="register"){return fsm.next(RegisterForm)}else if(!facebook){return fsm.next(RegisterForm)}else{this.timer=setTimeout(function(){return fsm.event("timerFired")},State.timeout/2);return FB.getLoginStatus(function(_this){return function(response){_ullog("getLoginStatus response=",response);if(response.status!=="connected"){session.set("facebook_connected",true);return fsm.next(RegisterFacebookLogin)}else{return fsm.next(RegisterFacebookApiMe)}}}(this))}};RegisterOptions.prototype.timerFired=function(){return fsm.next(RegisterForm)};RegisterOptions.prototype.leave=function(callback){clearTimeout(this.timer);return callback()};return RegisterOptions}(State);GroupSelect=function(superClass){extend1(GroupSelect,superClass);function GroupSelect(){return GroupSelect.__super__.constructor.apply(this,arguments)}GroupSelect.prototype.enter=function(data){this.data=data;if(this.data.available.length===1){return fsm.event("select",1)}else{button.fadeOutEyecatcher();group_select_view.show(this.data,function(){});return tracking_event.trigger("group_select_show")}};GroupSelect.prototype.chatButton=function(){tracking_event.trigger("group_select_cancel");return popup.close(function(){return fsm.next(Idle)})};GroupSelect.prototype.closeButton=function(){tracking_event.trigger("group_select_cancel");return popup.close(function(){return fsm.next(Idle)})};GroupSelect.prototype.select=function(v){if(!v){return}tracking_event.trigger("group_select_submit");session.set("group_select_id",this.data.available[v-1].id);return fsm.next(CheckPreChatThird)};return GroupSelect}(State);RegisterForm=function(superClass){extend1(RegisterForm,superClass);function RegisterForm(){return RegisterForm.__super__.constructor.apply(this,arguments)}RegisterForm.prototype.transitionIn=function(callback){button.fadeOutEyecatcher();return register_view.showRegisterForm(callback)};RegisterForm.prototype.enter=function(){return tracking_event.trigger("register_show")};RegisterForm.prototype.chatButton=function(){tracking_event.trigger("register_cancel");return popup.close(function(){return fsm.next(Idle)})};RegisterForm.prototype.directRequest=function(){tracking_event.trigger("register_cancel");return popup.close(function(){return fsm.next(Idle)})};RegisterForm.prototype.closeButton=function(){tracking_event.trigger("register_cancel");return popup.close(function(){return fsm.next(Idle)})};RegisterForm.prototype.submitButton=function(){tracking_event.trigger("register_submit");if(register_view.validateRegisterForm()){return fsm.next(CheckPreChatSecond)}};return RegisterForm}(State);RegisterFacebookLogin=function(superClass){extend1(RegisterFacebookLogin,superClass);function RegisterFacebookLogin(){return RegisterFacebookLogin.__super__.constructor.apply(this,arguments)}RegisterFacebookLogin.prototype.transitionIn=function(callback){button.fadeOutEyecatcher();return register_view.showRegisterFormFacebook(callback)};RegisterFacebookLogin.prototype.facebookLoginResponse=function(response){if(response.authResponse){tracking_event.trigger("facebook_login_success");return fsm.event("facebookApiMeRequest")}else{tracking_event.trigger("facebook_login_failure");_ullog("User cancelled login or did not fully authorize.");return fsm.next(RegisterForm)}};RegisterFacebookLogin.prototype.facebookApiMeRequest=function(){this.timer=setTimeout(function(){return fsm.event("timerFired")},State.timeout/2);return FB.api("/me",function(response){return fsm.event("facebookApiMeResponse",response)})};RegisterFacebookLogin.prototype.facebookApiMeResponse=function(response){if(response.email&&response.name){tracking_event.trigger("facebook_me_response");session.set("client_email",response.email);session.set("client_name",response.name);return fsm.next(CheckPreChatSecond)}else{_ullog("Incomplete Facebook ME Response.",response);return fsm.next(RegisterForm)}};RegisterFacebookLogin.prototype.timerFired=function(){return fsm.next(RegisterForm)};RegisterFacebookLogin.prototype.leave=function(callback){clearTimeout(this.timer);return callback()};return RegisterFacebookLogin}(RegisterForm);RegisterFacebookApiMe=function(superClass){extend1(RegisterFacebookApiMe,superClass);function RegisterFacebookApiMe(){return RegisterFacebookApiMe.__super__.constructor.apply(this,arguments)}RegisterFacebookApiMe.prototype.enter=function(){this.timer=setTimeout(function(){return fsm.event("timerFired")},State.timeout/2);return FB.api("/me",function(response){return fsm.event("facebookApiMeResponse",response)})};RegisterFacebookApiMe.prototype.facebookApiMeResponse=function(response){if(response.email&&response.name){tracking_event.trigger("facebook_me_response");session.set("client_email",response.email);session.set("client_name",response.name);return fsm.next(CheckPreChatSecond)}else{_ullog("Incomplete Facebook ME Response.",response);return fsm.next(RegisterForm)}};RegisterFacebookApiMe.prototype.timerFired=function(){return fsm.next(RegisterForm)};RegisterFacebookApiMe.prototype.leave=function(callback){clearTimeout(this.timer);return callback()};return RegisterFacebookApiMe}(State);PreSurveyForm=function(superClass){extend1(PreSurveyForm,superClass);function PreSurveyForm(){return PreSurveyForm.__super__.constructor.apply(this,arguments)}PreSurveyForm.prototype.transitionIn=function(callback){button.fadeOutEyecatcher();return survey_view.showPreSurvey(callback)};PreSurveyForm.prototype.enter=function(){return tracking_event.trigger("pre_survey_show")};PreSurveyForm.prototype.chatButton=function(){tracking_event.trigger("pre_survey_cancel");return popup.close(function(){return fsm.next(Idle)})};PreSurveyForm.prototype.closeButton=function(){tracking_event.trigger("pre_survey_cancel");return popup.close(function(){return fsm.next(Idle)})};PreSurveyForm.prototype.directRequest=function(){tracking_event.trigger("pre_survey_cancel");return popup.close(function(){return fsm.next(Idle)})};PreSurveyForm.prototype.select=function(v){tracking_event.trigger("pre_survey_submit");session.set("pre_survey_option",config["pre_survey_option0"+v]);return fsm.next(CheckSlotAvailable)};return PreSurveyForm}(State);PassiveConnectStart=function(superClass){extend1(PassiveConnectStart,superClass);function PassiveConnectStart(){return PassiveConnectStart.__super__.constructor.apply(this,arguments)}PassiveConnectStart.prototype.enter=function(data){session.setOperator(data.operator);tracking_event.trigger("chat_passive_connect");return chat_view.displaySlot(data.operator.display_name,data.operator.url_image,config.status_message,function(){return fsm.next(PassiveConnectOffer)})};return PassiveConnectStart}(State);PassiveConnectOffer=function(superClass){extend1(PassiveConnectOffer,superClass);function PassiveConnectOffer(){return PassiveConnectOffer.__super__.constructor.apply(this,arguments)}PassiveConnectOffer.prototype.enter=function(){return fsm.poll()};PassiveConnectOffer.prototype.transitionIn=function(callback){button.fadeOutEyecatcher();return chat_view.show(callback)};PassiveConnectOffer.prototype.inputEnter=function(data){var text;text=chat_view.sendMessage();fsm.queue("sendMessage",text);return fsm.next(PassiveConnectSocketConnect)};PassiveConnectOffer.prototype.sendMessage=function(text){fsm.unshift("sendMessage",text);return fsm.next(PassiveConnectSocketConnect)};PassiveConnectOffer.prototype.closeButton=function(){return popup.close(function(){return fsm.next(Idle)})};PassiveConnectOffer.prototype.minimizeButton=function(){return popup.close(function(){return fsm.next(Idle)})};PassiveConnectOffer.prototype.chatButton=function(){return popup.close(function(){return fsm.next(Idle)})};return PassiveConnectOffer}(State);PassiveConnectSocketConnect=function(superClass){extend1(PassiveConnectSocketConnect,superClass);function PassiveConnectSocketConnect(){return PassiveConnectSocketConnect.__super__.constructor.apply(this,arguments)}PassiveConnectSocketConnect.prototype.connect=function(){return fsm.next(PassiveConnectSlotCreate)};PassiveConnectSocketConnect.prototype.error=function(){return fsm.next(OfflineMessage)};PassiveConnectSocketConnect.prototype.connectFailed=function(){return fsm.next(OfflineMessage)};PassiveConnectSocketConnect.prototype.enter=function(){this.timer=setTimeout(function(){return fsm.event("timerFired")},State.timeout_connect);return slot.connect()};PassiveConnectSocketConnect.prototype.timerFired=function(){return fsm.next(OfflineMessage)};PassiveConnectSocketConnect.prototype.leave=function(callback){clearTimeout(this.timer);return callback()};PassiveConnectSocketConnect.prototype.inputEnter=function(data){var text;text=chat_view.sendMessage();return fsm.queue("sendMessage",text)};return PassiveConnectSocketConnect}(State);PassiveConnectSlotCreate=function(superClass){extend1(PassiveConnectSlotCreate,superClass);function PassiveConnectSlotCreate(){return PassiveConnectSlotCreate.__super__.constructor.apply(this,arguments)}PassiveConnectSlotCreate.prototype.inputEnter=function(data){var text;text=chat_view.sendMessage();return fsm.queue("sendMessage",text)};PassiveConnectSlotCreate.prototype.slotCreated=function(data){return fsm.next(PassiveConnectSlotVerify,data)};PassiveConnectSlotCreate.prototype.enter=function(){this.timer=setTimeout(function(){return fsm.event("timerFired")},State.timeout_connect);return slot.create({proactive:false,operator_group_id:session.get("group_select_id")})};PassiveConnectSlotCreate.prototype.timerFired=function(){return fsm.next(OfflineMessage)};PassiveConnectSlotCreate.prototype.leave=function(callback){clearTimeout(this.timer);return callback()};return PassiveConnectSlotCreate}(State);PassiveConnectSlotVerify=function(superClass){extend1(PassiveConnectSlotVerify,superClass);function PassiveConnectSlotVerify(){return PassiveConnectSlotVerify.__super__.constructor.apply(this,arguments)}PassiveConnectSlotVerify.prototype.enter=function(data){if(data.operator){return fsm.next(PassiveConnectSlotStart,data)}else{return fsm.next(OfflineMessage)}};return PassiveConnectSlotVerify}(State);PassiveConnectSlotStart=function(superClass){extend1(PassiveConnectSlotStart,superClass);function PassiveConnectSlotStart(){return PassiveConnectSlotStart.__super__.constructor.apply(this,arguments)}PassiveConnectSlotStart.prototype.enter=function(data){session.set("id",data.id);session.setIfEmpty("uuid",data.uuid);session.set("chat_meta_id",data.chat_meta_id);session.set("was_proactive",false);session.resetStats();if(session.get("operator_id")===data.operator.id){session.setOperator(data.operator);tracking.startSlot();tracking_event.trigger("chat_connected");return fsm.next(Chat)}else{session.setOperator(data.operator);tracking.startSlot();return chat_view.displaySlot(data.operator.display_name,data.operator.url_image,config.status_message,function(){tracking_event.trigger("chat_connected");return fsm.next(Chat)})}};return PassiveConnectSlotStart}(State);SocketConnect=function(superClass){extend1(SocketConnect,superClass);function SocketConnect(){return SocketConnect.__super__.constructor.apply(this,arguments)}SocketConnect.prototype.connecting=function(){return _ullog("Connecting")};SocketConnect.prototype.connect=function(){return fsm.next(SlotCreate,{proactive:false})};SocketConnect.prototype.error=function(){return fsm.next(OfflineMessage)};SocketConnect.prototype.connectFailed=function(){return fsm.next(OfflineMessage)};SocketConnect.prototype.enter=function(){this.timer=setTimeout(function(){return fsm.event("timerFired")},State.timeout_connect);return slot.connect()};SocketConnect.prototype.timerFired=function(){slot.disconnect();return fsm.next(OfflineMessage)};SocketConnect.prototype.leave=function(callback){clearTimeout(this.timer);return callback()};SocketConnect.prototype.inputEnter=function(data){var text;text=chat_view.sendMessage();return fsm.queue("sendMessage",text)};return SocketConnect}(State);SlotCreate=function(superClass){extend1(SlotCreate,superClass);function SlotCreate(){return SlotCreate.__super__.constructor.apply(this,arguments)}SlotCreate.prototype.slotCreated=function(data){return fsm.next(SlotVerify,data)};SlotCreate.prototype.enter=function(data){this.timer=setTimeout(function(){return fsm.event("timerFired")},State.timeout_connect*5);return fsm.poll()};SlotCreate.prototype.directRequest=function(data){return slot.direct(data)};SlotCreate.prototype.slotRequest=function(){return slot.create({proactive:false,operator_group_id:session.get("group_select_id")})};SlotCreate.prototype.timerFired=function(){slot.disconnect();return fsm.next(OfflineMessage)};SlotCreate.prototype.leave=function(callback){clearTimeout(this.timer);return callback()};SlotCreate.prototype.closeButton=function(){return fsm.next(ChatWaitQuit)};SlotCreate.prototype.minimizeButton=function(){return fsm.next(ChatWaitQuit)};SlotCreate.prototype.inputEnter=function(){var text;text=chat_view.sendMessage();return fsm.queue("sendMessage",text)};return SlotCreate}(State);SlotVerify=function(superClass){extend1(SlotVerify,superClass);function SlotVerify(){return SlotVerify.__super__.constructor.apply(this,arguments)}SlotVerify.prototype.enter=function(data){if(data.operator){return fsm.next(SlotStart,data)}else{return fsm.next(SlotErrorDisconnect,data)}};return SlotVerify}(State);SlotErrorDisconnect=function(superClass){extend1(SlotErrorDisconnect,superClass);function SlotErrorDisconnect(){return SlotErrorDisconnect.__super__.constructor.apply(this,arguments)}SlotErrorDisconnect.prototype.enter=function(data){slot.disconnect();return fsm.event("slotDisconnect",data)};SlotErrorDisconnect.prototype.slotDisconnect=function(data){return fsm.next(SlotErrorHandle,data)};return SlotErrorDisconnect}(State);SlotErrorHandle=function(superClass){extend1(SlotErrorHandle,superClass);function SlotErrorHandle(){return SlotErrorHandle.__super__.constructor.apply(this,arguments)}SlotErrorHandle.prototype.enter=function(data){_ullog("message="+(data!=null?data.message:void 0));if(data){if(data.message==="CUSTOMER_NOT_FOUND"){return fsm.next(ErrorMessage)}else if(data.message==="EXPIRED"){return fsm.next(OfflineMessage)}else if(data.message==="QUOTA_LIMIT_REACHED"){return fsm.next(OfflineMessage)}else if(data.message==="GROUP_OFFLINE"){return fsm.next(OfflineMessage)}else if(data.message==="NO_SLOT"){return fsm.next(OfflineMessage)}else{return fsm.next(OfflineMessage)}}else{return fsm.next(OfflineMessage)}};return SlotErrorHandle}(State);ChatUserQuit=function(superClass){extend1(ChatUserQuit,superClass);function ChatUserQuit(){return ChatUserQuit.__super__.constructor.apply(this,arguments)}ChatUserQuit.prototype.enter=function(){slot.queue("emit","quit");session.setState("Offline");session.deleteConfig();tracking_event.trigger("chat_quit");session.resetChatDuration();return fsm.event("done")};ChatUserQuit.prototype.done=function(){return fsm.next(ChatUserQuitDisconnect)};return ChatUserQuit}(State);ChatUserQuitDisconnect=function(superClass){extend1(ChatUserQuitDisconnect,superClass);function ChatUserQuitDisconnect(){return ChatUserQuitDisconnect.__super__.constructor.apply(this,arguments)}ChatUserQuitDisconnect.prototype.slotDisconnect=function(data){return fsm.next(CheckTranscriptForm)};return ChatUserQuitDisconnect}(SlotErrorDisconnect);CheckTranscriptForm=function(superClass){extend1(CheckTranscriptForm,superClass);function CheckTranscriptForm(){return CheckTranscriptForm.__super__.constructor.apply(this,arguments)}CheckTranscriptForm.prototype.enter=function(){if(config.transcript_enabled&&session.hasClientOriginating()){return fsm.next(TranscriptForm)}else{return fsm.next(CheckPostChatFirst)}};return CheckTranscriptForm}(State);TranscriptForm=function(superClass){extend1(TranscriptForm,superClass);function TranscriptForm(){return TranscriptForm.__super__.constructor.apply(this,arguments)}TranscriptForm.prototype.transitionIn=function(callback){return transcript_view.show(callback)};TranscriptForm.prototype.enter=function(){return tracking_event.trigger("transcript_show")};TranscriptForm.prototype.chatButton=function(){tracking_event.trigger("transcript_cancel");return popup.close(function(){return fsm.next(CheckPostChatFirst)})};TranscriptForm.prototype.directRequest=function(){tracking_event.trigger("transcript_cancel");return popup.close(function(){return fsm.next(CheckPostChatFirst)})};TranscriptForm.prototype.closeButton=function(){tracking_event.trigger("transcript_cancel");return popup.close(function(){return fsm.next(CheckPostChatFirst)})};TranscriptForm.prototype.submitButton=function(){tracking_event.trigger("transcript_submit");if(transcript_view.validateTranscriptForm()){return fsm.next(TranscriptSend)}};return TranscriptForm}(State);TranscriptSend=function(superClass){extend1(TranscriptSend,superClass);function TranscriptSend(){return TranscriptSend.__super__.constructor.apply(this,arguments)}TranscriptSend.prototype.transitionIn=function(callback){return progress_view.show(callback)};TranscriptSend.prototype.enter=function(){this.timer=setTimeout(function(){return fsm.event("timerFired")},State.timeout_disconnected);return slot.sendTranscript(function(){return fsm.event("sent")})};TranscriptSend.prototype.leave=function(callback){clearTimeout(this.timer);return callback()};TranscriptSend.prototype.timerFired=function(){return fsm.next(CheckPostChatFirst)};TranscriptSend.prototype.sent=function(){return fsm.next(CheckPostChatFirst)};return TranscriptSend}(State);CheckPostChatFirst=function(superClass){extend1(CheckPostChatFirst,superClass);function CheckPostChatFirst(){return CheckPostChatFirst.__super__.constructor.apply(this,arguments)}CheckPostChatFirst.prototype.enter=function(){if(config.rating_enabled&&session.hasClientOriginating()){return fsm.next(ChatFeedbackRatingComposite)}else{return fsm.next(CheckPostChatSecond)}};return CheckPostChatFirst}(State);CheckPostChatSecond=function(superClass){extend1(CheckPostChatSecond,superClass);function CheckPostChatSecond(){return CheckPostChatSecond.__super__.constructor.apply(this,arguments)}CheckPostChatSecond.prototype.enter=function(){if(config.post_survey_enabled){return fsm.next(PostSurveyForm)}else{return fsm.next(CheckPostChatThird)}};return CheckPostChatSecond}(State);CheckPostChatThird=function(superClass){extend1(CheckPostChatThird,superClass);function CheckPostChatThird(){return CheckPostChatThird.__super__.constructor.apply(this,arguments)}CheckPostChatThird.prototype.enter=function(){if(facebook&&config.facebook_like_enabled||twitter&&config.twitter_integration!=="disabled"){return fsm.next(SocialComposite)}else{return fsm.next(CheckPostChatLast)}};return CheckPostChatThird}(State);CheckPostChatLast=function(superClass){extend1(CheckPostChatLast,superClass);function CheckPostChatLast(){return CheckPostChatLast.__super__.constructor.apply(this,arguments)}CheckPostChatLast.prototype.enter=function(){return fsm.next(ChatQuit)};return CheckPostChatLast;
}(State);ChatFeedbackRatingComposite=function(superClass){extend1(ChatFeedbackRatingComposite,superClass);function ChatFeedbackRatingComposite(){return ChatFeedbackRatingComposite.__super__.constructor.apply(this,arguments)}ChatFeedbackRatingComposite.prototype.transitionIn=function(callback){return feedback_rating_composite_view.show(callback)};ChatFeedbackRatingComposite.prototype.enter=function(){return tracking_event.trigger("feedback_rating_show")};ChatFeedbackRatingComposite.prototype.closeButton=function(){tracking_event.trigger("feedback_rating_cancel");return fsm.next(CheckPostChatSecond)};ChatFeedbackRatingComposite.prototype.directRequest=function(operator_id){tracking_event.trigger("feedback_rating_cancel");return fsm.next(CheckPostChatSecond)};ChatFeedbackRatingComposite.prototype.chatButton=function(){tracking_event.trigger("feedback_rating_cancel");return fsm.next(CheckPostChatSecond)};ChatFeedbackRatingComposite.prototype.submitButton=function(){if(feedback_rating_composite_view.isValid()){return fsm.event("done")}else{return fsm.event("cancel")}};ChatFeedbackRatingComposite.prototype.done=function(){if(rating_view.isValid()){rating_view.send()}if(feedback_view.isValid()){feedback_view.send()}return fsm.next(CheckPostChatSecond)};return ChatFeedbackRatingComposite}(State);SocialComposite=function(superClass){extend1(SocialComposite,superClass);function SocialComposite(){return SocialComposite.__super__.constructor.apply(this,arguments)}SocialComposite.prototype.transitionIn=function(callback){return social_composite_view.show(callback)};SocialComposite.prototype.enter=function(){return tracking_event.trigger("social_composite_show")};SocialComposite.prototype.closeButton=function(){tracking_event.trigger("social_composite_cancel");return fsm.next(CheckPostChatLast)};SocialComposite.prototype.directRequest=function(operator_id){tracking_event.trigger("social_composite_cancel");return fsm.next(CheckPostChatLast)};SocialComposite.prototype.chatButton=function(){tracking_event.trigger("social_composite_cancel");return fsm.next(CheckPostChatLast)};return SocialComposite}(State);PostSurveyForm=function(superClass){extend1(PostSurveyForm,superClass);function PostSurveyForm(){return PostSurveyForm.__super__.constructor.apply(this,arguments)}PostSurveyForm.prototype.transitionIn=function(callback){return survey_view.showPostSurvey(callback)};PostSurveyForm.prototype.enter=function(){return tracking_event.trigger("post_survey_show")};PostSurveyForm.prototype.closeButton=function(){tracking_event.trigger("post_survey_cancel");return fsm.next(CheckPostChatThird)};PostSurveyForm.prototype.directRequest=function(operator_id){tracking_event.trigger("post_survey_cancel");return fsm.next(CheckPostChatThird)};PostSurveyForm.prototype.chatButton=function(){tracking_event.trigger("post_survey_cancel");return fsm.next(CheckPostChatThird)};PostSurveyForm.prototype.select=function(v){var s;tracking_event.trigger("post_survey_submit");s=new Survey;s.send(config["post_survey_option0"+v],v);return fsm.next(CheckPostChatThird)};return PostSurveyForm}(State);ChatQuit=function(superClass){extend1(ChatQuit,superClass);function ChatQuit(){return ChatQuit.__super__.constructor.apply(this,arguments)}ChatQuit.prototype.transitionIn=function(callback){return popup.close(callback)};ChatQuit.prototype.enter=function(){return fsm.next(Offline)};return ChatQuit}(State);ChatWaitQuit=function(superClass){extend1(ChatWaitQuit,superClass);function ChatWaitQuit(){return ChatWaitQuit.__super__.constructor.apply(this,arguments)}ChatWaitQuit.prototype.transitionIn=function(callback){return popup.close(callback)};ChatWaitQuit.prototype.slotCreated=function(data){return fsm.next(ChatSendQuit)};return ChatWaitQuit}(State);ChatSendQuit=function(superClass){extend1(ChatSendQuit,superClass);function ChatSendQuit(){return ChatSendQuit.__super__.constructor.apply(this,arguments)}ChatSendQuit.prototype.done=function(){return fsm.next(Offline)};return ChatSendQuit}(ChatUserQuit);ChatQuitWaitDisconnect=function(superClass){extend1(ChatQuitWaitDisconnect,superClass);function ChatQuitWaitDisconnect(){return ChatQuitWaitDisconnect.__super__.constructor.apply(this,arguments)}ChatQuitWaitDisconnect.prototype.slotDisconnect=function(data){return fsm.next(ChatQuitWait,data)};return ChatQuitWaitDisconnect}(SlotErrorDisconnect);ChatQuitWait=function(superClass){extend1(ChatQuitWait,superClass);function ChatQuitWait(){return ChatQuitWait.__super__.constructor.apply(this,arguments)}ChatQuitWait.prototype.transitionIn=function(callback){return popup.show(function(){chat_view.showOperatorQuitInfo();return callback()})};ChatQuitWait.prototype.enter=function(){fsm.reset();session.setState("Offline");session.deleteConfig();tracking_event.trigger("chat_quit");return session.resetChatDuration()};ChatQuitWait.prototype.closeButton=function(){return fsm.next(CheckTranscriptForm)};ChatQuitWait.prototype.minimizeButton=function(){return fsm.next(CheckTranscriptForm)};ChatQuitWait.prototype.directRequest=function(operator_id){return fsm.next(CheckTranscriptForm)};ChatQuitWait.prototype.chatButton=function(){return fsm.next(CheckTranscriptForm)};ChatQuitWait.prototype.inputEnter=function(data){tracking_event.trigger("chat_requested");fsm.queue("inputEnter",data);fsm.queue("slotRequest");return fsm.next(SocketConnect)};return ChatQuitWait}(State);ChatMinimizedQuitWaitDisconnect=function(superClass){extend1(ChatMinimizedQuitWaitDisconnect,superClass);function ChatMinimizedQuitWaitDisconnect(){return ChatMinimizedQuitWaitDisconnect.__super__.constructor.apply(this,arguments)}ChatMinimizedQuitWaitDisconnect.prototype.slotDisconnect=function(data){return fsm.next(ChatMinimizedQuitWait,data)};return ChatMinimizedQuitWaitDisconnect}(SlotErrorDisconnect);ChatMinimizedQuitWait=function(superClass){extend1(ChatMinimizedQuitWait,superClass);function ChatMinimizedQuitWait(){return ChatMinimizedQuitWait.__super__.constructor.apply(this,arguments)}ChatMinimizedQuitWait.prototype.enter=function(){session.setState("Offline");session.deleteConfig();tracking_event.trigger("chat_quit");return session.resetChatDuration()};ChatMinimizedQuitWait.prototype.chatButton=function(){return fsm.next(ChatQuitWait)};ChatMinimizedQuitWait.prototype.directRequest=function(operator_id){return fsm.next(ChatQuitWait)};return ChatMinimizedQuitWait}(State);SlotStart=function(superClass){extend1(SlotStart,superClass);function SlotStart(){return SlotStart.__super__.constructor.apply(this,arguments)}SlotStart.prototype.enter=function(data){session.set("id",data.id);session.setIfEmpty("uuid",data.uuid);session.set("chat_meta_id",data.chat_meta_id);session.set("was_proactive",false);session.resetStats();session.setOperator(data.operator);tracking.startSlot();return chat_view.displaySlot(data.operator.display_name,data.operator.url_image,config.status_message,function(){chat_view.sendWelcomeMessage();tracking_event.trigger("chat_connected");return fsm.next(Chat)})};return SlotStart}(State);Chat=function(superClass){extend1(Chat,superClass);function Chat(){return Chat.__super__.constructor.apply(this,arguments)}Chat.prototype.enter=function(){if(config.geo_type==="browser"){session.getLocation()}slot.queue("emit","chat");fsm.poll();return button.clear()};Chat.prototype.persist=function(){session.setState("Chat",State.timeout_offsite);return session.saveConfig()};Chat.prototype.slotRequest=function(){};Chat.prototype.transitionIn=function(callback){button.fadeOutEyecatcher();return chat_view.show(callback)};Chat.prototype.inputEnter=function(){var text;text=chat_view.sendMessage();return fsm.event("sendMessage",text)};Chat.prototype.chatButton=function(){return fsm.next(ChatMinimized)};Chat.prototype.minimizeButton=function(){return fsm.next(ChatMinimized)};Chat.prototype.directRequest=function(operator_id){return fsm.next(ChatMinimized)};Chat.prototype.closeButton=function(){return fsm.next(ChatUserQuit)};Chat.prototype.sendMessage=function(text){var was_proactive;if(!(text!=null?text.length:void 0)){return}fsm.event("persist");if(!session.hasClientOriginating()){session.startChatDuration();tracking_event.trigger("chat_started");was_proactive=session.get("was_proactive");if(was_proactive&&was_proactive!=="false"){tracking_event.trigger("chat_started_proactive")}}session.incClientOriginating();tracking.sendMessage();tracking_event.trigger("message_operator_terminating");slot.queue("emit","message",text);if(!(popup.isActive()&&config.audio_only_inactive)){return sound.play("message_sent")}};Chat.prototype.requestUrlInfo=function(data){return slot.urlinfo(data.url,data.callback)};Chat.prototype.goalReached=function(){return slot.queue("emit","update_info",session.packet())};Chat.prototype.locationchange=function(data){return slot.queue("emit","update_info",session.packet())};Chat.prototype.hashchange=function(data){return slot.queue("emit","update_info",session.packet())};Chat.prototype.pushstate=function(data){return slot.queue("emit","update_info",session.packet())};Chat.prototype.updateAPI=function(){session.updateUserData();return slot.queue("emit","update_info_api",session.packet())};Chat.prototype.livePreview=function(input_value){return slot.queue("emit","live_preview",input_value)};Chat.prototype.receiveMessage=function(data){fsm.event("persist");if(!session.hasClientTerminating()){tracking_event.trigger("message_client_terminating_first")}session.incClientTerminating();tracking.receiveMessage();tracking_event.trigger("message_client_terminating");if(!(popup.isActive()&&config.audio_only_inactive)){sound.play("message_received")}return chat_view.receiveMessage(data.from,data.body)};Chat.prototype.stateComposing=function(){return slot.queue("emit","composing")};Chat.prototype.statePaused=function(){return slot.queue("emit","paused")};Chat.prototype.stateActive=function(){return slot.queue("emit","active")};Chat.prototype.stateInactive=function(){return slot.queue("emit","inactive")};Chat.prototype.receiveComposing=function(data){if(config.emit_chat_state){return chat_view.stateComposing(data.from)}};Chat.prototype.receivePaused=function(data){if(config.emit_chat_state){return chat_view.statePaused(data.from)}};Chat.prototype.receiveBlock=function(){return fsm.next(ChatBlocked)};Chat.prototype.receiveInactive=function(data){return fsm.next(ChatInactive)};Chat.prototype.receiveQuit=function(data){return fsm.next(ChatQuitWaitDisconnect)};Chat.prototype.receiveSwitch=function(data){return fsm.next(SlotSwitchDisconnect)};Chat.prototype.receiveName=function(data){return session.set("client_name",data.name)};Chat.prototype.receiveEmail=function(data){return session.set("client_email",data.email)};Chat.prototype.receiveAdditional=function(data){return session.set("client_additional0"+data.num+"_value",data.value)};Chat.prototype.receiveReplaceText=function(data){return chat_view.replaceText(data)};Chat.prototype.receiveScreenshot=function(callback){return offline_message_view.takeScreenshot(callback)};Chat.prototype.screenshotTaken=function(data){return offline_message_view.sendScreenshot(data.callback)};Chat.prototype.screenshotSent=function(data){return data.callback(false,data.url)};Chat.prototype.screenshotError=function(data){return data.callback(true)};Chat.prototype.receivePush=function(data){var push;push=new Push;return push.send(data.url,data.callback)};Chat.prototype.receiveDownload=function(data){return chat_view.receiveDownload(data.from,data.url,data.name)};Chat.prototype.receiveOperatorDisconnect=function(){return fsm.next(ChatOperatorDisconnect)};Chat.prototype.receiveHibernate=function(){return fsm.next(ServerHibernate)};Chat.prototype.receiveSlot=function(data){session.setOperator(data.operator);return chat_view.displaySlot(data.operator.display_name,data.operator.url_image,config.status_message,function(){})};Chat.prototype.receiveForward=function(data){session.setOperator(data.operator);return chat_view.displaySlot(data.operator.display_name,data.operator.url_image,config.status_message,function(){return chat_view.sendForwardMessage()})};Chat.prototype.receiveOffline=function(data){slot.disconnect();return fsm.next(ChatOffline)};Chat.prototype.disconnect=function(){return fsm.next(ChatReconnectingIntermediate)};return Chat}(State);ChatMinimized=function(superClass){extend1(ChatMinimized,superClass);function ChatMinimized(){return ChatMinimized.__super__.constructor.apply(this,arguments)}ChatMinimized.prototype.enter=function(){tracking_event.trigger("chat_window_minimzed");return slot.queue("emit","minize")};ChatMinimized.prototype.persist=function(){session.setState("ChatMinimized",State.timeout_offsite);return session.saveConfig()};ChatMinimized.prototype.transitionIn=function(callback){return popup.hide(callback)};ChatMinimized.prototype.inputEnter=function(){};ChatMinimized.prototype.chatButton=function(){tracking_event.trigger("chat_window_maximized");return fsm.next(Chat)};ChatMinimized.prototype.directRequest=function(operator_id){tracking_event.trigger("chat_window_maximized");return fsm.next(Chat)};ChatMinimized.prototype.receiveMessage=function(data){var was_proactive;fsm.event("persist");if(!session.hasClientTerminating()){tracking_event.trigger("message_client_terminating_first");was_proactive=session.get("was_proactive");if(was_proactive&&was_proactive!=="false"){tracking_event.trigger("message_client_terminating_first_proactive")}}session.incClientTerminating();tracking.receiveMessage();tracking_event.trigger("message_client_terminating");if(!(popup.isActive()&&config.audio_only_inactive)){sound.play("message_received")}chat_view.receiveMessage(data.from,data.body,data.sent_at);return button.startFlash()};ChatMinimized.prototype.receiveQuit=function(data){return fsm.next(ChatMinimizedQuitWaitDisconnect)};return ChatMinimized}(Chat);ChatInactive=function(superClass){extend1(ChatInactive,superClass);function ChatInactive(){return ChatInactive.__super__.constructor.apply(this,arguments)}ChatInactive.prototype.enter=function(){return fsm.next(OfflineMessage)};return ChatInactive}(State);ChatBlocked=function(superClass){extend1(ChatBlocked,superClass);function ChatBlocked(){return ChatBlocked.__super__.constructor.apply(this,arguments)}ChatBlocked.prototype.transitionIn=function(callback){return popup.close(function(){return popup.hideTab(callback)})};ChatBlocked.prototype.enter=function(){return session.set("blocked",1)};return ChatBlocked}(State);ChatReconnectingIntermediate=function(superClass){extend1(ChatReconnectingIntermediate,superClass);function ChatReconnectingIntermediate(){return ChatReconnectingIntermediate.__super__.constructor.apply(this,arguments)}ChatReconnectingIntermediate.prototype.reconnect=function(){return fsm.next(Chat)};ChatReconnectingIntermediate.prototype.connect=function(){return fsm.next(Chat)};ChatReconnectingIntermediate.prototype.reconnectFailed=function(){return fsm.next(SlotErrorDisconnect)};ChatReconnectingIntermediate.prototype.timerFired=function(){return fsm.next(ChatReconnecting)};ChatReconnectingIntermediate.prototype.enter=function(){return this.timer=setTimeout(function(){return fsm.event("timerFired")},State.timeout)};ChatReconnectingIntermediate.prototype.leave=function(callback){clearTimeout(this.timer);return callback()};return ChatReconnectingIntermediate}(State);ChatReconnecting=function(superClass){extend1(ChatReconnecting,superClass);function ChatReconnecting(){return ChatReconnecting.__super__.constructor.apply(this,arguments)}ChatReconnecting.prototype.transitionIn=function(callback){return progress_view.show(callback)};ChatReconnecting.prototype.reconnect=function(){return fsm.next(Chat)};ChatReconnecting.prototype.connect=function(){return fsm.next(Chat)};ChatReconnecting.prototype.reconnectFailed=function(){return fsm.next(SlotErrorDisconnect)};ChatReconnecting.prototype.timerFired=function(){return fsm.next(SlotErrorDisconnect)};ChatReconnecting.prototype.enter=function(){return this.timer=setTimeout(function(){return fsm.event("timerFired")},State.timeout_disconnected)};ChatReconnecting.prototype.leave=function(callback){clearTimeout(this.timer);return callback()};return ChatReconnecting}(State);SlotSwitchDisconnect=function(superClass){extend1(SlotSwitchDisconnect,superClass);function SlotSwitchDisconnect(){return SlotSwitchDisconnect.__super__.constructor.apply(this,arguments)}SlotSwitchDisconnect.prototype.slotDisconnect=function(data){return fsm.next(SlotSwitch,data)};return SlotSwitchDisconnect}(SlotErrorDisconnect);SlotSwitch=function(superClass){extend1(SlotSwitch,superClass);function SlotSwitch(){return SlotSwitch.__super__.constructor.apply(this,arguments)}SlotSwitch.prototype.transitionIn=function(callback){return message_view.showTransfer(callback)};SlotSwitch.prototype.transitionOut=function(callback){return popup.close(callback)};SlotSwitch.prototype.chatButton=function(){return fsm.next(SlotSwitchIdle)};SlotSwitch.prototype.closeButton=function(){return fsm.next(SlotSwitchIdle)};SlotSwitch.prototype.minimizeButton=function(){return fsm.next(SlotSwitchIdle)};return SlotSwitch}(State);SlotSwitchIdle=function(superClass){extend1(SlotSwitchIdle,superClass);function SlotSwitchIdle(){return SlotSwitchIdle.__super__.constructor.apply(this,arguments)}SlotSwitchIdle.prototype.chatButton=function(){return fsm.next(SwitchSocketConnect)};SlotSwitchIdle.prototype.directRequest=function(operator_id){return fsm.next(SwitchSocketConnect)};return SlotSwitchIdle}(State);ChatReopen=function(superClass){extend1(ChatReopen,superClass);function ChatReopen(){return ChatReopen.__super__.constructor.apply(this,arguments)}ChatReopen.prototype.enter=function(data){fsm.event("receiveMessage",data);return fsm.next(Chat)};return ChatReopen}(Chat);ServerHibernate=function(superClass){extend1(ServerHibernate,superClass);function ServerHibernate(){return ServerHibernate.__super__.constructor.apply(this,arguments)}ServerHibernate.prototype.transitionIn=function(callback){return progress_view.show(callback)};ServerHibernate.prototype.connect=function(){return fsm.next(ServerHibernateWakeup)};ServerHibernate.prototype.reconnectFailed=function(){return fsm.next(ChatOffline)};ServerHibernate.prototype.timerFired=function(){return fsm.next(ChatOffline)};ServerHibernate.prototype.enter=function(){return this.timer=setTimeout(function(){return fsm.event("timerFired")},State.timeout_hibernate)};ServerHibernate.prototype.leave=function(callback){clearTimeout(this.timer);return callback()};return ServerHibernate}(State);ServerHibernateWakeup=function(superClass){extend1(ServerHibernateWakeup,superClass);function ServerHibernateWakeup(){return ServerHibernateWakeup.__super__.constructor.apply(this,arguments)}ServerHibernateWakeup.prototype.enter=function(){this.timer=setTimeout(function(){return fsm.event("timerFired")},State.timeout_hibernate);return slot.wakeup()};ServerHibernateWakeup.prototype.wakeupDone=function(data){return fsm.next(ServerHibernateWakeupSlotVerify,data)};ServerHibernateWakeup.prototype.timerFired=function(){return fsm.next(ChatOffline)};ServerHibernateWakeup.prototype.leave=function(callback){clearTimeout(this.timer);return callback()};return ServerHibernateWakeup}(State);ServerHibernateWakeupSlotVerify=function(superClass){extend1(ServerHibernateWakeupSlotVerify,superClass);function ServerHibernateWakeupSlotVerify(){return ServerHibernateWakeupSlotVerify.__super__.constructor.apply(this,arguments)}ServerHibernateWakeupSlotVerify.prototype.enter=function(data){if(data.operator){return fsm.next(Chat)}else{return fsm.next(ChatOffline)}};return ServerHibernateWakeupSlotVerify}(State);ChatOperatorDisconnect=function(superClass){extend1(ChatOperatorDisconnect,superClass);function ChatOperatorDisconnect(){return ChatOperatorDisconnect.__super__.constructor.apply(this,arguments)}ChatOperatorDisconnect.prototype.transitionIn=function(callback){return progress_view.show(callback)};ChatOperatorDisconnect.prototype.receiveOperatorReconnect=function(){return fsm.next(Chat)};ChatOperatorDisconnect.prototype.receiveOffline=function(data){slot.disconnect();return fsm.next(ChatOffline)};ChatOperatorDisconnect.prototype.receiveSlot=function(data){session.setOperator(data.operator);return chat_view.displaySlot(data.operator.display_name,data.operator.url_image,config.status_message,function(){return fsm.next(Chat)})};ChatOperatorDisconnect.prototype.receiveForward=function(data){session.setOperator(data.operator);return chat_view.displaySlot(data.operator.display_name,data.operator.url_image,config.status_message,function(){chat_view.sendForwardMessage();return fsm.next(Chat)})};ChatOperatorDisconnect.prototype.timerFired=function(){slot.disconnect();return fsm.next(ChatOffline)};ChatOperatorDisconnect.prototype.enter=function(){return this.timer=setTimeout(function(){return fsm.event("timerFired")},State.timeout_disconnected)};ChatOperatorDisconnect.prototype.leave=function(callback){clearTimeout(this.timer);return callback()};return ChatOperatorDisconnect}(State);ChatOffline=function(superClass){extend1(ChatOffline,superClass);function ChatOffline(){return ChatOffline.__super__.constructor.apply(this,arguments)}ChatOffline.prototype.enter=function(){return fsm.next(OfflineMessage)};return ChatOffline}(State);RestartSlot=function(superClass){extend1(RestartSlot,superClass);function RestartSlot(){return RestartSlot.__super__.constructor.apply(this,arguments)}RestartSlot.prototype.enter=function(){return fsm.next(RestartFacebookLoader)};return RestartSlot}(State);RestartFacebookLoader=function(superClass){extend1(RestartFacebookLoader,superClass);function RestartFacebookLoader(){return RestartFacebookLoader.__super__.constructor.apply(this,arguments)}RestartFacebookLoader.prototype.done=function(){_ullog("RestartFacebookLoader integration="+config.facebook_integration+" facebook="+facebook);return fsm.next(RestartTwitterLoader)};return RestartFacebookLoader}(FacebookLoader);RestartTwitterLoader=function(superClass){extend1(RestartTwitterLoader,superClass);function RestartTwitterLoader(){return RestartTwitterLoader.__super__.constructor.apply(this,arguments)}RestartTwitterLoader.prototype.done=function(){_ullog("RestartTwitterLoader integration="+config.twitter_integration+" twitter="+twitter);return fsm.next(RestartEventSetup)};return RestartTwitterLoader}(TwitterLoader);RestartEventSetup=function(superClass){extend1(RestartEventSetup,superClass);function RestartEventSetup(){return RestartEventSetup.__super__.constructor.apply(this,arguments)}RestartEventSetup.prototype.done=function(data){return fsm.next(RestartSocketConnect,data)};return RestartEventSetup}(EventSetup);RestartSocketConnect=function(superClass){extend1(RestartSocketConnect,superClass);function RestartSocketConnect(){return RestartSocketConnect.__super__.constructor.apply(this,arguments)}RestartSocketConnect.prototype.connect=function(){return fsm.next(RestartSlotCreate)};RestartSocketConnect.prototype.error=function(){return fsm.next(OfflineMessage)};RestartSocketConnect.prototype.connectFailed=function(){return fsm.next(OfflineMessage)};RestartSocketConnect.prototype.enter=function(){this.timer=setTimeout(function(){return fsm.event("timerFired")},State.timeout_connect);return slot.connect()};RestartSocketConnect.prototype.timerFired=function(){return fsm.next(OfflineMessage)};RestartSocketConnect.prototype.leave=function(callback){clearTimeout(this.timer);return callback()};return RestartSocketConnect}(State);RestartSlotCreate=function(superClass){extend1(RestartSlotCreate,superClass);function RestartSlotCreate(){return RestartSlotCreate.__super__.constructor.apply(this,arguments)}RestartSlotCreate.prototype.slotReconnceted=function(data){return fsm.next(RestartSlotVerify,data)};RestartSlotCreate.prototype.enter=function(){this.timer=setTimeout(function(){return fsm.event("timerFired")},State.timeout_connect);return slot.reconnect()};RestartSlotCreate.prototype.timerFired=function(){slot.disconnect();return fsm.next(OfflineMessage)};RestartSlotCreate.prototype.leave=function(callback){clearTimeout(this.timer);return callback()};return RestartSlotCreate}(State);RestartSlotVerify=function(superClass){extend1(RestartSlotVerify,superClass);function RestartSlotVerify(){return RestartSlotVerify.__super__.constructor.apply(this,arguments)}RestartSlotVerify.prototype.enter=function(data){if(data.status==="switch"){return fsm.next(RestartSlotPlayback,data)}else if(data.status==="noswitch"){slot.disconnect();return fsm.next(NoSwitch)}else{return fsm.next(Offline)}};return RestartSlotVerify}(State);RestartSlotPlayback=function(superClass){extend1(RestartSlotPlayback,superClass);function RestartSlotPlayback(){return RestartSlotPlayback.__super__.constructor.apply(this,arguments)}RestartSlotPlayback.prototype.slotPlayback=function(data){return fsm.next(RestartSlotStart,data)};RestartSlotPlayback.prototype.enter=function(data){session.setOperator(data.operator);return slot.playback()};return RestartSlotPlayback}(State);RestartSlotStart=function(superClass){extend1(RestartSlotStart,superClass);function RestartSlotStart(){return RestartSlotStart.__super__.constructor.apply(this,arguments)}RestartSlotStart.prototype.enter=function(data){tracking_event.trigger("chat_reconnect");chat_view.playbackSlot(data);if(session.getState()==="ChatMinimized"){return fsm.next(ChatMinimized)}else{return fsm.next(Chat)}};RestartSlotStart.prototype.requestUrlInfo=function(data){return slot.urlinfo(data.url,data.callback)};return RestartSlotStart}(State);SwitchSocketConnect=function(superClass){extend1(SwitchSocketConnect,superClass);function SwitchSocketConnect(){return SwitchSocketConnect.__super__.constructor.apply(this,arguments)}SwitchSocketConnect.prototype.connect=function(){return fsm.next(SwitchSlotCreate)};return SwitchSocketConnect}(RestartSocketConnect);SwitchSlotCreate=function(superClass){extend1(SwitchSlotCreate,superClass);function SwitchSlotCreate(){return SwitchSlotCreate.__super__.constructor.apply(this,arguments)}SwitchSlotCreate.prototype.slotSwitched=function(data){return fsm.next(RestartSlotVerify,data)};SwitchSlotCreate.prototype.enter=function(){this.timer=setTimeout(function(){return fsm.event("timerFired")},State.timeout_connect);return slot["switch"]()};return SwitchSlotCreate}(RestartSlotCreate);PreviewState=function(superClass){extend1(PreviewState,superClass);function PreviewState(){return PreviewState.__super__.constructor.apply(this,arguments)}PreviewState.prototype.enter=function(){};PreviewState.prototype.close=function(){return typeof userlikePreview!=="undefined"&&userlikePreview!==null?userlikePreview.stop():void 0};PreviewState.prototype.closeButton=function(){return typeof userlikePreview!=="undefined"&&userlikePreview!==null?userlikePreview.stop():void 0};PreviewState.prototype.minimizeButton=function(){return popup.hide()};PreviewState.prototype.submitButton=function(){return typeof userlikePreview!=="undefined"&&userlikePreview!==null?userlikePreview.cycleView():void 0};PreviewState.prototype.select=function(){return typeof userlikePreview!=="undefined"&&userlikePreview!==null?userlikePreview.cycleView():void 0};PreviewState.prototype.leave=function(callback){if(typeof userlikePreview!=="undefined"&&userlikePreview!==null){userlikePreview.setButton(config)}popup.setConfig(config).setupTheme();return callback()};return PreviewState}(State);Push=function(){function Push(){}Push.prototype.send=function(url,callback){var data,up;_ullog("Push::send  url="+url);up=new UrlParser(url);if(up.isOffsite()){if(_jq.browser.msie||isIE11()){return callback({action:"not_supported"})}if(up.isInsecure()){_ullog("Push::send offsite failed insecure url="+up.url());return callback({action:"insecure"})}_ullog("Push::send offsite url="+up.url());data={url:encodeURIComponent(up.url())};return _jq.ajaxJsonp({url:"https://api.userlike.com/api/client/iframe/?url="+encodeURIComponent(up.url()),success:function(resp){if(resp.status!=="200"||resp.xframe){return callback({action:"xframe"})}else{popup.injectIframe(up.url_inherit());return callback({action:"open"})}},error:function(resp){_ullog("Push::send offsite failed ajax url="+up.url());return callback({action:"failed"})}})}else{_ullog("Push::send onsite url="+up.original());if(up.isSame()){_ullog("Push::send onsite failed same url="+up.original());return callback({action:"same"})}return _jq.ajaxGet({url:up.original(),success:function(){_ullog("Push::send onsite navigate url="+up.original());window.location=up.original();return callback({action:"navigate"})},error:function(){_ullog("Push::send onsite failed url="+up.original());return callback({action:"failed"})}})}};return Push}();UrlParser=function(){function UrlParser(source1,force_absolute){this.source=source1;this.force_absolute=force_absolute!=null?force_absolute:false;if(this.isAbsolute()){this.addHttp()}this.loc=window.location;this.e=document.createElement("a");this.e.href=this.source}UrlParser.prototype.original=function(){return this.source};UrlParser.prototype.url=function(){var e;e=document.createElement("a");e.href=this.source;return e.href};UrlParser.prototype.url_inherit=function(){var e;e=document.createElement("a");e.href=this.source;e.protocol=this.loc.protocol;return e.href};UrlParser.prototype.url_http=function(){var e;e=document.createElement("a");e.href=this.source;e.protocol="http:";return e.href};UrlParser.prototype.url_https=function(){var e;e=document.createElement("a");e.href=this.source;e.protocol="https:";return e.href};UrlParser.prototype.isSame=function(){return this.loc.href===this.e.href};UrlParser.prototype.isInsecure=function(){return this.e.protocol==="http:"&&this.loc.protocol==="https:"};UrlParser.prototype.isOffsite=function(){return this.loc.hostname!==this.e.hostname&&this.e.hostname.length>0};UrlParser.prototype.isAbsolute=function(){var ref1;return this.force_absolute||((ref1=this.source.match(/(www\.|https?:\/\/)/))!=null?ref1.length:void 0)>0};UrlParser.prototype.addHttp=function(){if(!/^(?:f|ht)tps?\:\/\//.test(this.source)){return this.source="http://"+this.source}};return UrlParser}();Base64=function(){function Base64(){}Base64.key="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";Base64.encode=function(input){var chr1,chr2,chr3,enc1,enc2,enc3,enc4,i,output;output="";chr1=void 0;chr2=void 0;chr3=void 0;enc1=void 0;enc2=void 0;enc3=void 0;enc4=void 0;i=0;input=Base64._utf8_encode(input);while(i<input.length){chr1=input.charCodeAt(i++);chr2=input.charCodeAt(i++);chr3=input.charCodeAt(i++);enc1=chr1>>2;enc2=(chr1&3)<<4|chr2>>4;enc3=(chr2&15)<<2|chr3>>6;enc4=chr3&63;if(isNaN(chr2)){enc3=enc4=64}else{if(isNaN(chr3)){enc4=64}}output=output+Base64.key.charAt(enc1)+Base64.key.charAt(enc2)+Base64.key.charAt(enc3)+Base64.key.charAt(enc4)}return output};Base64.decode=function(input){var chr1,chr2,chr3,enc1,enc2,enc3,enc4,i,output;output="";i=0;input=input.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(i<input.length){enc1=Base64.key.indexOf(input.charAt(i++));enc2=Base64.key.indexOf(input.charAt(i++));enc3=Base64.key.indexOf(input.charAt(i++));enc4=Base64.key.indexOf(input.charAt(i++));chr1=enc1<<2|enc2>>4;chr2=(enc2&15)<<4|enc3>>2;chr3=(enc3&3)<<6|enc4;output=output+String.fromCharCode(chr1);if(enc3!==64){output=output+String.fromCharCode(chr2)}if(enc4!==64){output=output+String.fromCharCode(chr3)}}output=Base64._utf8_decode(output);return output};Base64._utf8_encode=function(string){var c,n,utftext;string=string.replace(/\r\n/g,"\n");utftext="";n=0;while(n<string.length){c=string.charCodeAt(n);if(c<128){utftext+=String.fromCharCode(c)}else if(c>127&&c<2048){utftext+=String.fromCharCode(c>>6|192);utftext+=String.fromCharCode(c&63|128)}else{utftext+=String.fromCharCode(c>>12|224);utftext+=String.fromCharCode(c>>6&63|128);utftext+=String.fromCharCode(c&63|128)}n++}return utftext};Base64._utf8_decode=function(utftext){var c,c1,c2,c3,i,string;string="";i=0;c=c1=c2=0;while(i<utftext.length){c=utftext.charCodeAt(i);if(c<128){string+=String.fromCharCode(c);
i++}else if(c>191&&c<224){c2=utftext.charCodeAt(i+1);string+=String.fromCharCode((c&31)<<6|c2&63);i+=2}else{c2=utftext.charCodeAt(i+1);c3=utftext.charCodeAt(i+2);string+=String.fromCharCode((c&15)<<12|(c2&63)<<6|c3&63);i+=3}}return string};return Base64}();hashCode=function(s){var c,hash,i;hash=0;if(s.length===0){return hash}i=0;while(i<s.length){c=s.charCodeAt(i);hash=(hash<<5)-hash+c;hash=hash&hash;i++}return hash};unpack=function(input){var output;output=Base64.decode(input);if(this.JSON!=null){return JSON.parse(output)}else{return eval("("+output+")")}};capitalize=function(input){if(input==null){input=""}if(typeof input!=="string"){input=input.toString()}return input.charAt(0).toUpperCase()+input.slice(1)};insertStringAtIndex=function(source,index,string){var output;output=source;if(index>0){output=source.substring(0,index)+string+source.substring(index,source.length)}else{output=string+source}return output};getMousePosition=function(e){var posx,posy;posx=0;posy=0;if(!e){e=window.event}if(e.pageX||e.pageY){posx=e.pageX;posy=e.pageY}else if(e.clientX||e.clientY){posx=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft;posy=e.clientY+document.body.scrollTop+document.documentElement.scrollTop}return{x:posx,y:posy}};overlapDiv=function(){var comparePositions,getPositions;getPositions=function(elem){var $el,height,pos,width;pos=void 0;width=void 0;height=void 0;$el=_jq(elem);pos=$el.offset();width=$el.width();height=$el.height();return[[pos.left,pos.left+width],[pos.top,pos.top+height]]};comparePositions=function(p1,p2){var r1,r2;r1=void 0;r2=void 0;r1=p1[0]<p2[0]?p1:p2;r2=p1[0]<p2[0]?p2:p1;return r1[1]>r2[0]||r1[0]===r2[0]};return function(a,b){var pos1,pos2;pos1=getPositions(a);pos2=getPositions(b);return comparePositions(pos1[0],pos2[0])&&comparePositions(pos1[1],pos2[1])}}();escapeRegExp=function(str){return str.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")};isElementInViewport=function(el){var e,error,rect;try{rect=el.getBoundingClientRect();return rect.top>=0&&rect.left>=0&&rect.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&rect.right<=(window.innerWidth||document.documentElement.clientWidth)}catch(error){e=error;return true}};rgb=function(c){var d,e,error;try{d=/rgba\( *(\d+)[^,]*, *(\d+)[^,]*, *(\d+)[^,]*,.*\)/.exec(c);return"rgb("+d[1]+","+d[2]+","+d[3]+")"}catch(error){e=error;_ullog("rgb: parse error",e);return"rgb(0,174,239)"}};serialize=function(obj){var p,str;str=[];for(p in obj){if(obj.hasOwnProperty(p)&&obj[p]){str.push(encodeURIComponent(p)+"="+encodeURIComponent(obj[p]))}}return str.join("&")};regex_url_full=new RegExp("(?:\\s|^)"+"(?:(?:https?|ftps?)://)?"+"(?:\\S+(?::\\S*)?@)?"+"(?:"+"(?!(?:10|127)(?:\\.\\d{1,3}){3})"+"(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})"+"(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})"+"(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])"+"(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}"+"(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))"+"|"+"(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)"+"(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*"+"(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))"+")"+"(?::\\d{2,5})?"+"(?:/\\S*)?"+"(?!\\S)","i");regex_email=/(?:\s|^)(([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,})+)(?!\S)/gi;isURL=function(url){var regex;regex=new RegExp("^"+regex_url_full.source);return regex.test(trim(url))};isIE11=function(){var re,rv;if(navigator.appName==="Netscape"){re=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})");if(re.exec(navigator.userAgent)!==null){rv=parseInt(parseFloat(RegExp.$1));return rv===11}}return false};isIE8=function(){return _jq.browser.msie&&parseInt(_jq.browser.version,10)<9};isAndroid=function(){return navigator.userAgent.toLowerCase().indexOf("android")>-1};has_css_animation_support=false;animationstring="animation";keyframeprefix="";domPrefixes="Webkit Moz O ms Khtml".split(" ");pfx="";elm=document.createElement("div");if(elm.style.animationName!==void 0){has_css_animation_support=true}if(has_css_animation_support===false){i=0;while(i<domPrefixes.length){if(elm.style[domPrefixes[i]+"AnimationName"]!==void 0){pfx=domPrefixes[i];animationstring=pfx+"Animation";keyframeprefix="-"+pfx.toLowerCase()+"-";has_css_animation_support=true;break}i++}}getInput=function(name){var $input;$input=_jq(name);if($input.val()===$input.data("default")){return void 0}else{return $input.val()}};adjustFontSize=function(element){var child,closest_fontsize,font_size,max_trials,parent_height,trials;max_trials=10;trials=0;child=element;closest_fontsize=-1;parent_height=child.parent().outerHeight();font_size=parseInt(child.css("font-size"));while(trials<max_trials){if(child.outerHeight()>parent_height){font_size--;child.css({"font-size":font_size+"px"}).importize()}else if(child.outerHeight()<parent_height){closest_fontsize=font_size;font_size++;child.css({"font-size":font_size+"px"}).importize()}else{trials=max_trials}trials++}if(closest_fontsize>0){return child.css({"font-size":closest_fontsize-1+"px"}).importize()}};applyTheme=function(theme,scope){var key,selector,val;if(scope==null){scope="#userlike"}if(theme==null){theme=config.theme}if(typeof scope==="string"){scope=_jq(scope)}for(key in theme){if(!hasProp.call(theme,key))continue;val=theme[key];selector=key.replace(/_/g,"-");scope.find(".userlike-theme-"+selector+".userlike-theme-bg").css({"background-color":val});scope.find(".userlike-theme-"+selector+".userlike-theme-text").css({color:val})}return scope.find(".userlike-icon-has-active-state").on("mouseenter",function(e){if(!_jq(this).hasClass("userlike-disabled")){return _jq(this).css({color:theme.icon_active_color})}}).on("mouseleave",function(e){if(!_jq(this).hasClass("userlike-disabled")){return _jq(this).css({color:theme.icon_default_color})}})};rgbaToRgb=function(color){var regex,rgba;regex=void 0;rgba=void 0;color=color.replace(" ","");if(color.indexOf("rgba(")!==0){return color}regex=/(.*?)rgba\((\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([0-9]+\.[0-9]+|\d)\s*\)/;rgba=regex.exec(color);if(!rgba){return color}return"rgb("+rgba.splice(2,3).join(",")+")"};getLocation=function(callback){if(navigator.geolocation){_ullog("getLocation request");return navigator.geolocation.getCurrentPosition(function(position){_ullog("SessionStorage::getLocation response=",position);return callback(position)})}else{return _ullog("getLocation not supported")}};setBadge=function(count){if(count>0){_jq("#userlike-message-badge-count").text(count);return _jq("#userlike-message-badge").addClass("userlike-show")}else{return _jq("#userlike-message-badge").removeClass("userlike-show")}};userlikeCallbackIframeCheck=function(resp){var blacklist,key;key="iframe_blacklist_"+hashCode(resp.url);blacklist=resp.status!=="200"||resp.xframe;_ullog("userlikeCallbackIframeCheck: url="+resp.url+" status="+resp.status+" xframe="+resp.xframe+" blacklist="+blacklist);return session.set(key,blacklist)};getOrientation=function(){if(window.orientation!=null){if(window.orientation===0){return"portrait"}else{return"landscape"}}if(window.innerHeight>window.innerWidth){return"portrait"}else{return"landscape"}};onKeyboardStateChange=function(fnShow,fnHide){var _originalSize,window_size;window_size=_jq.windowSize();_originalSize=window_size.width+window_size.height;return _jq.windowOn("resize",function(){var resized_window_size;resized_window_size=_jq.windowSize();if(resized_window_size.width+resized_window_size.height!==_originalSize){_ullog("onKeyboardStateChange: showFunction");return fnShow()}else{_ullog("onKeyboardStateChange: hideFunction");return fnHide()}})};trim=function(text){if(text.trim!=null){return text.trim()}return text.replace(/^[\s\uFEFF]+|[\s\uFEFF]+$/g,"")};trimPxSuffix=function(text){var px_index;if(typeof text==="string"){px_index=text.indexOf("px");return parseInt(text.substr(0,px_index),10)}return text};Screenshot=function(){var constructor;function Screenshot(){}constructor=function(){init_screenshot();return this.screentshot=null};Screenshot.prototype.take=function(callback){if(_jq.browser.msie&&parseInt(_jq.browser.version)<9){return callback(true)}return Loader.loadScripts({html2canvas:"dq4irj27fs462.cloudfront.net/html2canvas.0.5.0.min.js"},function(_this){return function(){var e,error;try{_jq(".userlike").attr("data-html2canvas-ignore","");_jq("#userlike").attr("data-html2canvas-ignore","");return html2canvas([document.body],{logging:document.cookie.indexOf("_uslk_debug=1")>-1,proxy:"https://www.userlike.com/api/proxy/image/",onrendered:function(canvas){_this.screentshot=canvas.toDataURL("image/png");return callback(false)}})}catch(error){e=error;_ullog("Screenshot::take error=%o",e);return callback(true)}}}(this))};Screenshot.prototype.crossDomainPost=function(url,args,callback){var data;data=JSON.stringify(args);return _jq.ajaxPost({url:url,data:data,success:function(response){return callback(false,JSON.parse(response))},error:function(){return callback(true)}})};Screenshot.prototype.attachToOfflineMessage=function(id,callback){return this.crossDomainPost("https://api.userlike.com/api/client/message/offline_message/screenshot/",{id:id,customer_id:config.customer_id,screenshot:this.screentshot},function(err,resp){return callback(err,resp!=null?resp.url:void 0)})};Screenshot.prototype.sendToOperator=function(id,callback){return this.crossDomainPost("https://api.userlike.com/api/client/message/chat_meta/screenshot/",{id:id,customer_id:config.customer_id,screenshot:this.screentshot,session_id:session.get("id")},function(err,resp){return callback(err,resp!=null?resp.url:void 0)})};return Screenshot}();SoundFactory=function(){function SoundFactory(){}SoundFactory.prototype.get=function(){if(config.audio_message_received||config.audio_message_sent){return new Sound}else{return new SoundDummy}};return SoundFactory}();SoundDummy=function(){function SoundDummy(){}SoundDummy.prototype.play=function(){};SoundDummy.prototype.load=function(){};return SoundDummy}();Sound=function(){function Sound(){}Sound.prototype.load=function(){var e,error;this.audio={message_received:document.createElement("audio"),message_sent:document.createElement("audio")};try{this.audio.message_received.setAttribute("src","//dq4irj27fs462.cloudfront.net/message_received.mp3");return this.audio.message_sent.setAttribute("src","//dq4irj27fs462.cloudfront.net/message_sent.mp3")}catch(error){e=error;return _ullog("Sound::load raised an exception ",e)}};Sound.prototype.play=function(name){var e,error;try{if(config["audio_"+name]){return this.audio[name].play()}}catch(error){e=error;return _ullog("Sound::play raised an exception ",e)}};return Sound}();(function(context){var Userlikecon,abbreviateNumber,canvas,currentFavicon,drawBubble,drawFavicon,faviconImage,getCanvas,getCurrentFavicon,getFaviconTag,options,originalFavicon,originalTitle,r,refreshFavicon,removeFaviconTag,round,setFaviconTag,size,ua,updateTitle;Userlikecon={};currentFavicon=null;originalFavicon=null;originalTitle=document.title;faviconImage=null;canvas=null;r=window.devicePixelRatio||1;size=16*r;options={width:7,height:9,font:10*r+"px arial",colour:"#ffffff",background:"#F00",fallback:true,crossOrigin:true,abbreviate:true};ua=function(){var agent;agent=navigator.userAgent.toLowerCase();return function(browser){return agent.indexOf(browser)!==-1}}();browser={ie:ua("msie")||ua("trident/7.0"),chrome:ua("chrome"),webkit:ua("chrome")||ua("safari"),safari:ua("safari")&&!ua("chrome"),mozilla:ua("mozilla")&&!ua("chrome")&&!ua("safari")};getFaviconTag=function(){var len,links;links=document.getElementsByTagName("link");i=0;len=links.length;while(i<len){if((links[i].getAttribute("rel")||"").match(/\bicon\b/)){return links[i]}i++}return false};removeFaviconTag=function(){var exists,head,len,links,results1;links=document.getElementsByTagName("link");head=document.getElementsByTagName("head")[0];i=0;len=links.length;results1=[];while(i<len){exists=typeof links[i]!=="undefined";if(exists&&(links[i].getAttribute("rel")||"").match(/\bicon\b/)){head.removeChild(links[i])}results1.push(i++)}return results1};getCurrentFavicon=function(){var tag;if(!originalFavicon||!currentFavicon){tag=getFaviconTag();originalFavicon=currentFavicon=tag?tag.getAttribute("href"):"/favicon.ico"}return currentFavicon};getCanvas=function(){if(!canvas){canvas=document.createElement("canvas");canvas.width=size;canvas.height=size}return canvas};setFaviconTag=function(url){var link;removeFaviconTag();link=document.createElement("link");link.type="image/x-icon";link.rel="icon";link.href=url;return document.getElementsByTagName("head")[0].appendChild(link)};drawFavicon=function(label,colour){var src;if(!getCanvas().getContext||browser.ie||browser.safari){return updateTitle(label)}context=getCanvas().getContext("2d");colour=colour||"#000000";src=getCurrentFavicon();faviconImage=document.createElement("img");faviconImage.onload=function(){context.clearRect(0,0,size,size);context.drawImage(faviconImage,0,0,faviconImage.width,faviconImage.height,0,0,size,size);if((label+"").length>0){drawBubble(context,label,colour)}return refreshFavicon()};if(!src.match(/^data/)&&options.crossOrigin){faviconImage.crossOrigin="anonymous"}return faviconImage.src=src};updateTitle=function(label){if(options.fallback){if((label+"").length>0){return document.title="("+label+") "+originalTitle}else{return document.title=originalTitle}}};drawBubble=function(context,label,colour){var bottom,height,left,len,radius,right,top,width;if(typeof label==="number"&&label>99&&options.abbreviate){label=abbreviateNumber(label)}len=(label+"").length-1;width=options.width*r+6*r*len;height=options.height*r;top=size-height;left=size-width-r;bottom=16*r;right=16*r;radius=2*r;context.font=(browser.webkit?"bold ":"")+options.font;context.fillStyle=options.background;context.strokeStyle=options.background;context.lineWidth=r;context.beginPath();context.moveTo(left+radius,top);context.quadraticCurveTo(left,top,left,top+radius);context.lineTo(left,bottom-radius);context.quadraticCurveTo(left,bottom,left+radius,bottom);context.lineTo(right-radius,bottom);context.quadraticCurveTo(right,bottom,right,bottom-radius);context.lineTo(right,top+radius);context.quadraticCurveTo(right,top,right-radius,top);context.closePath();context.fill();context.beginPath();context.strokeStyle="rgba(0,0,0,0.3)";context.moveTo(left+radius/2,bottom);context.lineTo(right-radius/2,bottom);context.stroke();context.fillStyle=options.colour;context.textAlign="right";context.textBaseline="top";return context.fillText(label,r===2?29:15,browser.mozilla?7*r:6*r)};refreshFavicon=function(){if(!getCanvas().getContext){return}return setFaviconTag(getCanvas().toDataURL())};abbreviateNumber=function(label){var metricPrefixes;metricPrefixes=[["G",1e9],["M",1e6],["k",1e3]];i=0;while(i<metricPrefixes.length){if(label>=metricPrefixes[i][1]){label=round(label/metricPrefixes[i][1])+metricPrefixes[i][0];break}++i}return label};round=function(value,precision){var number;number=new Number(value);return number.toFixed(precision)};return context.setBubble=function(label,colour){label=label||"";drawFavicon(label,colour);return this}})(this);CSS_EYECATCHER="#userlike-eyecatcher-message {\n    font-family: '{{FONT}}', Sans-Serif;\n}";Eyecatcher=function(superClass){extend1(Eyecatcher,superClass);function Eyecatcher(){return Eyecatcher.__super__.constructor.apply(this,arguments)}Eyecatcher.prototype.eyecatcherTimer=null;Eyecatcher.prototype.el=function(){return document.getElementById("userlike-eyecatcher")};Eyecatcher.prototype.elClose=function(){return document.getElementById("userlike-eyecatcher-close")};Eyecatcher.prototype.registerEvents=function(){var ref1,ref2;if((ref1=this.elClose())!=null){ref1.onclick=function(_this){return function(event){event.stopPropagation();_this.hide();return false}}(this)}return(ref2=this.el())!=null?ref2.onclick=function(_this){return function(){_this.hide();fsm.event("chatButton");return false}}(this):void 0};Eyecatcher.prototype.render=function(){var doc;this.registerEvents();this.setClasses();this.setText();this.setPicture();doc=CSS_EYECATCHER;doc=doc.replace("{{FONT}}",this.config.theme.font.split(":")[0]);return doc};Eyecatcher.prototype.setClasses=function(){var $eyecatcher;return $eyecatcher=_jq("#userlike-eyecatcher").removeClass("left").removeClass("right").removeClass("eyecatcher-01").removeClass("eyecatcher-02").removeClass("eyecatcher-03").addClass(this.config.theme.button_orientation).addClass(this.config.eyecatcher_type)};Eyecatcher.prototype.setText=function(){this.highlightText("#userlike-eyecatcher-message",this.config.eyecatcher_message);return _jq("#userlike-eyecatcher-message").css("font-family",this.config.theme.font.split(":")[0]+", Sans-Serif;").text(this.config.eyecatcher_message)};Eyecatcher.prototype.setOffset=function(){var $el;$el=_jq(this.el());$el.css({left:"auto",right:"auto"});return $el.css(this.config.theme.button_orientation,this.config.theme.button_offset_x+"%")};Eyecatcher.prototype.setPicture=function(){return _jq("#userlike-eyecatcher-picture").css("background-image","url(//"+this.config.eyecatcher_picture_url+")")};Eyecatcher.prototype.setWidth=function(){var button_width;button_width=_jq("#userlike-tab").outerWidth();_jq("#userlike-eyecatcher").width(button_width);return _jq("#userlike-eyecatcher-box").width(button_width)};Eyecatcher.prototype.show=function(delay){var _,trial;if(delay==null){delay=3e3}clearTimeout(this.eyecatcherTimer);this.setText();trial=100;_=function(_this){return function(){var el;el=_this.el();if(el){return _this.eyecatcherTimer=setTimeout(function(){_this.setWidth();_jq(el).css("display","block");return _jq(el).addClass("fadeIn")},delay)}else if(trial--){return _this.eyecatcherTimer=setTimeout(_,100)}}}(this);return _()};Eyecatcher.prototype.hide=function(){var el;clearTimeout(this.eyecatcherTimer);el=this.el();_jq(el).removeClass("fadeIn");return setTimeout(function(_this){return function(){return _jq(el).css("display","none")}}(this),200)};return Eyecatcher}(View);CSS_BUTTON="a#userlike-tab #userlike-button-text{\n    font-family: '{{FONT}}', Sans-Serif;\n}";Button=function(superClass){extend1(Button,superClass);Button.has_injected_style=false;Button.prototype.callbacks=[];Button.prototype.element_id="userlike-tab";Button.prototype.posMobile={top:0,left:0,right:0,bottom:0,width:"100%",height:"100%"};function Button(options){if(options==null){options={}}Button.__super__.constructor.call(this,options)}Button.prototype.slideOut=function(){};Button.prototype.changeToOfflineText=function(){};Button.prototype.changeToOnlineText=function(){};Button.prototype.delayProactive=function(){return 0};Button.prototype.render=function(){};Button.prototype.el=function(){return document.getElementById(this.element_id)};Button.prototype.addCallback=function(name){var fn;fn=window[name];if(typeof fn==="function"){return this.callbacks.push(fn)}};Button.prototype.replaceCallbacks=function(name){var fn;fn=window[name];if(typeof fn==="function"){return this.callbacks=[fn]}};Button.prototype.triggerCallbacks=function(visible){var callback,j,len1,ref1,results1;ref1=this.callbacks;results1=[];for(j=0,len1=ref1.length;j<len1;j++){callback=ref1[j];results1.push(callback(visible))}return results1};Button.prototype.registerEvents=function(){var ref1;return(ref1=this.el())!=null?ref1.onclick=function(_this){return function(){return _this.onButtonClick()}}(this):void 0};Button.prototype.onButtonClick=function(){fsm.event("chatButton");this.stopFlash();return false};Button.prototype.hide=function(){this.triggerCallbacks(false);if(this.el()!=null){return _jq(this.el()).hide()}};Button.prototype.show=function(delay){return this.triggerCallbacks(true)};Button.prototype.startFlash=function(){return _jq(this.el()).find("#userlike-button-icon").addClass("userlike-flash")};Button.prototype.stopFlash=function(){return _jq(this.el()).find("#userlike-button-icon").removeClass("userlike-flash")};Button.prototype.fadeOutEyecatcher=function(){};Button.prototype.writeCss=function(doc){var userlikestyle_element;if(Button.has_injected_style){return}userlikestyle_element=document.createElement("style");userlikestyle_element.type="text/css";if(userlikestyle_element.styleSheet){userlikestyle_element.styleSheet.cssText=doc}else{userlikestyle_element.appendChild(document.createTextNode(doc))}document.getElementsByTagName("head")[0].appendChild(userlikestyle_element);return Button.has_injected_style=true};Button.prototype.update=function(){};Button.prototype.clear=function(){clearInterval(this.timer);this.timer=void 0;return _ullog("Button::clear")};Button.prototype.destroy=function(){};return Button}(View);ButtonPreset=function(superClass){extend1(ButtonPreset,superClass);ButtonPreset.prototype.text_el=null;ButtonPreset.prototype["class"]="";function ButtonPreset(options){if(options==null){options={}}this.addCallback("userlikeButtonHandler");ButtonPreset.__super__.constructor.call(this,options);if(this.config.state==="offline"){this.changeToOfflineText()}else{this.changeToOnlineText()}}ButtonPreset.prototype.onButtonClick=function(){this.showSpinner();return ButtonPreset.__super__.onButtonClick.call(this)};ButtonPreset.prototype.showSpinner=function(){if(!has_css_animation_support){return}_jq(this.el()).find(".userlike-icon").css("display","none").importize();return _jq(this.el()).find(".userlike-button-spinner").css("display","block").importize()};ButtonPreset.prototype.hideSpinner=function(){if(!has_css_animation_support){return}_jq(this.el()).find(".userlike-icon").css("display","inline-block").importize();return _jq(this.el()).find(".userlike-button-spinner").css("display","none").importize()};ButtonPreset.prototype.changeToOfflineText=function(){this.state="offline";this.label=this.config.tab_text_offline;this.icon=this.config.theme.button_icon_offline;this.update();return this.fadeOutEyecatcher()};ButtonPreset.prototype.changeToOnlineText=function(){this.state="online";this.icon=this.config.theme.button_icon_online;this.label=this.config.tab_text_label;return this.update()};ButtonPreset.prototype.setClasses=function(){return _jq(this.el()).removeClass("userlike-left").removeClass("userlike-right").addClass("userlike-"+this.config.theme.button_orientation).addClass(this["class"])};ButtonPreset.prototype.setIcon=function(){var _addNewIconClasses,_removeOldIconClasses;_removeOldIconClasses=function(_this){return function(){var j,old_button_class_offline,old_button_class_online,results1;results1=[];for(i=j=1;j<=6;i=++j){old_button_class_online="userlike-button-0"+i;old_button_class_offline="userlike-button-offline-0"+i;_jq(_this.el()).find("#userlike-button-icon .userlike-icon").removeClass(old_button_class_online).removeClass(old_button_class_offline);results1.push(_jq(_this.el()).removeClass(old_button_class_online).removeClass(old_button_class_offline))}return results1}}(this);_addNewIconClasses=function(_this){return function(){var button_icon_class,new_button_cls;button_icon_class=_this.icon.replace(/_/g,"-");new_button_cls="userlike-"+button_icon_class;_jq(_this.el()).find("#userlike-button-icon .userlike-icon").addClass(new_button_cls);return _jq(_this.el()).addClass(new_button_cls)}}(this);_removeOldIconClasses();return _addNewIconClasses()};ButtonPreset.prototype.setText=function(){this.highlightText(this.text_el,this.label);return _jq(this.text_el).text(this.label)};ButtonPreset.prototype.update=function(){if(!this.el()){return}this.setClasses();this.setText();this.setIcon();return this.setOffset()};ButtonPreset.prototype.setOffline=function(){this.changeToOfflineText();return this.update()};ButtonPreset.prototype.setOnline=function(){this.changeToOnlineText();return this.update()};ButtonPreset.prototype.setOffset=function(){var $el;if(this.config.theme.button_offset_x){$el=_jq(this.el());$el.css({left:"auto",right:"auto"});return $el.css(this.config.theme.button_orientation,this.config.theme.button_offset_x+"%")}};ButtonPreset.prototype.delayProactive=function(){return 3};ButtonPreset.prototype.slide=function(delay){if(delay==null){delay=0}return setTimeout(function(_this){return function(){_jq(_this.el()).addClass("userlike-slideup");return _this.triggerCallbacks(true)}}(this),delay)};ButtonPreset.prototype.slideOut=function(){return _jq(this.el()).removeClass("userlike-slideup")};ButtonPreset.prototype.popupPosition=function(){var pos;if(is_mobile){pos=this.posMobile}else if(this.config.theme.button_orientation==="left"){pos={top:"auto",left:0,right:"auto",bottom:0}}else if(this.config.theme.button_orientation==="right"){pos={top:"auto",right:0,left:"auto",bottom:0}}return pos};ButtonPreset.prototype.clear=function(){this.hideSpinner();return ButtonPreset.__super__.clear.call(this)};ButtonPreset.prototype.destroy=function(){ButtonPreset.__super__.destroy.call(this);return _jq(this.el()).removeClass(this["class"])};return ButtonPreset}(Button);ButtonBig=function(superClass){extend1(ButtonBig,superClass);function ButtonBig(){return ButtonBig.__super__.constructor.apply(this,arguments)}ButtonBig.prototype.text_el="#userlike-button-text";ButtonBig.prototype["class"]="userlike-button-big";ButtonBig.prototype.fadeOutEyecatcher=function(){var ref1;return(ref1=this.eyecatcher)!=null?ref1.hide():void 0};ButtonBig.prototype.render=function(){var doc,offset;offset=this.config.theme.font!=="sans-serif"?1:0;doc=CSS_BUTTON.replace("{{FONT}}",this.config.theme.font.split(":")[0]);this.eyecatcher=new Eyecatcher({config:this.config});doc+=this.eyecatcher.render();this.writeCss(doc);this.update();return this};ButtonBig.prototype.show=function(delay){if(delay==null){delay=0}this.update();if(typeof delay==="boolean"&&delay===true){delay=1500}if(this.config.eyecatcher_enabled&&this.state==="online"){this.eyecatcher.show()}else{this.fadeOutEyecatcher()}this.slide(delay);return this};ButtonBig.prototype.slideOut=function(){var ref1;ButtonBig.__super__.slideOut.call(this);return(ref1=this.eyecatcher)!=null?ref1.hide():void 0};ButtonBig.prototype.setOffset=function(){var ref1;ButtonBig.__super__.setOffset.call(this);return(ref1=this.eyecatcher)!=null?ref1.setOffset():void 0};ButtonBig.prototype.destroy=function(){var ref1;ButtonBig.__super__.destroy.call(this);return(ref1=this.eyecatcher)!=null?ref1.hide():void 0};return ButtonBig}(ButtonPreset);ButtonBubble=function(superClass){var fadeIn;extend1(ButtonBubble,superClass);function ButtonBubble(){this.onWindowResize=bind(this.onWindowResize,this);return ButtonBubble.__super__.constructor.apply(this,arguments)}ButtonBubble.prototype.text_el="#userlike-button-hover-text";ButtonBubble.prototype["class"]="userlike-button-bubble";fadeIn=function(){};ButtonBubble.prototype.registerEvents=function(){var that;ButtonBubble.__super__.registerEvents.call(this);that=this;this.fadeIn=function(){return that.fadeInHoverText()};this.fadeOut=function(){return that.fadeOutHoverText()};if(!is_mobile){_jq(this.el()).on("mouseleave",this.fadeOut);return _jq(this.el()).on("mouseenter",this.fadeIn)}};ButtonBubble.prototype.unregisterEvents=function(){_jq(this.el()).off("mouseleave",this.fadeOut);return _jq(this.el()).off("mouseenter",this.fadeIn)};ButtonBubble.prototype.render=function(){var doc,offset;offset=this.config.theme.font!=="sans-serif"?1:0;doc=CSS_BUTTON.replace("{{FONT}}",this.config.theme.font.split(":")[0]);this.writeCss(doc);this.update();_jq.windowOff("resize",this.onWindowResize);_jq.windowOn("resize",this.onWindowResize);return this};ButtonBubble.prototype.onWindowResize=function(){return this.setHoverTextOffset()};ButtonBubble.prototype.slideOut=function(){ButtonBubble.__super__.slideOut.call(this);return this.fadeOutHoverText()};ButtonBubble.prototype.setClasses=function(){ButtonBubble.__super__.setClasses.call(this);return _jq("#userlike-hover-text-container").removeClass("userlike-left").removeClass("userlike-right").addClass("userlike-"+this.config.theme.button_orientation)};ButtonBubble.prototype.setOffset=function(){ButtonBubble.__super__.setOffset.call(this);return this.setHoverTextOffset()};ButtonBubble.prototype.setHoverTextOffset=function(){var $el,$hover_text_container,element_offset,element_width,hover_text_width,new_left_pos,padding;$el=_jq(this.el());element_offset=$el.offset().left;element_width=$el.width();padding=22;$hover_text_container=_jq("#userlike-hover-text-container");hover_text_width=Math.max($hover_text_container.outerWidth(),$hover_text_container.width());if(this.config.theme.button_orientation==="left"){new_left_pos=element_offset+element_width+padding}else if(this.config.theme.button_orientation==="right"){new_left_pos=element_offset-hover_text_width-padding}return $hover_text_container.css("left",new_left_pos)};ButtonBubble.prototype.setText=function(){ButtonBubble.__super__.setText.call(this);if(userlikePreview.isActive()){return this.fadeInHoverText()}};ButtonBubble.prototype.update=function(){ButtonBubble.__super__.update.call(this);return this.setArrowColor()};ButtonBubble.prototype.setArrowColor=function(){var arrow_border_color;if(this.config.theme.button_orientation==="right"){arrow_border_color="transparent transparent transparent "+this.config.theme.button_bg_color}if(this.config.theme.button_orientation==="left"){arrow_border_color="transparent "+this.config.theme.button_bg_color+" transparent transparent"}return _jq("#userlike-hover-text-arrow").css("border-color",arrow_border_color)};ButtonBubble.prototype.fadeInHoverText=function(){_jq("#userlike-hover-text-container").css("display","block");_jq("#userlike-hover-text-container").addClass("fadeIn");return this.setHoverTextOffset()};ButtonBubble.prototype.fadeOutHoverText=function(){return _jq("#userlike-hover-text-container").removeClass("fadeIn")};ButtonBubble.prototype.fadeOutEyecatcher=function(){};ButtonBubble.prototype.show=function(delay){if(delay==null){delay=0}this.update();if(typeof delay==="boolean"&&delay===true){delay=1500}this.slide(delay);return this};ButtonBubble.prototype.destroy=function(){ButtonBubble.__super__.destroy.call(this);this.unregisterEvents();return this.fadeOutHoverText()};return ButtonBubble}(ButtonPreset);ButtonCustom=function(superClass){extend1(ButtonCustom,superClass);ButtonCustom.prototype.element_id="userlikeCustomTab";function ButtonCustom(options){var callback,ref1;if(options==null){options={}}this.addCallback("userlikeButtonHandler");callback=(ref1=this.el().attributes.getNamedItem("data-callback"))!=null?ref1.value:void 0;this.replaceCallbacks(callback);ButtonCustom.__super__.constructor.call(this,options)}ButtonCustom.prototype.show=function(){return this.triggerCallbacks(true)};ButtonCustom.prototype.popupPosition=function(){var $el,bottom,custom_tab,data,h,key,left,margin,offset,orientation,pos,relativeTo,right,sleft,stop,top,w;if(is_mobile){return this.posMobile}margin=15;custom_tab=document.getElementById("userlikeCustomTab");$el=_jq(custom_tab);data=$el.data();relativeTo=(data!=null?data.position:void 0)||"window";orientation="center";if((data!=null?data.orientation:void 0)!=null){orientation=data!=null?data.orientation:void 0}else if((data!=null?data.left:void 0)||(data!=null?data.right:void 0)||(data!=null?data.bottom:void 0)||(data!=null?data.top:void 0)){orientation=null}w=$el.outerWidth();h=$el.outerHeight();offset=$el.offset();pos={top:"auto",right:"auto",bottom:"auto",left:"auto"};if(relativeTo==="window"){pos.position="fixed";if(orientation==="bottomLeft"){left=data.left||"0";bottom=data.bottom||"0";pos.left=left+"px";pos.bottom=bottom+"px"}else if(orientation==="bottomRight"){right=data.right||"0";bottom=data.bottom||"0";pos.right=right+"px";pos.bottom=bottom+"px"}else if(orientation==="top"){top=data.top||"0";pos.top=top+"px";pos.left=Math.max(0,(document.documentElement.clientWidth-_jq("#userlike-popup").width())/2)+"px"}else if(orientation==="topRight"){right=data.right||"0";top=data.top||"0";pos.right=right+"px";pos.top=top+"px"}else if(orientation==="topLeft"){left=data.left||"0";top=data.top||"0";pos.left=left+"px";pos.top=top+"px"}else if(orientation==="bottom"){bottom=data.bottom||"0";
pos.left=Math.max(0,(document.documentElement.clientWidth-_jq("#userlike-popup").width())/2)+"px";pos.bottom=bottom+"px"}else if(orientation==="left"){left=data.left||"0";pos.top=Math.max(0,(document.documentElement.clientHeight-_jq("#userlike-popup").height())/2)+"px";pos.left=left+"px"}else if(orientation==="right"){right=data.right||"0";pos.top=Math.max(0,(document.documentElement.clientHeight-_jq("#userlike-popup").height())/2)+"px";pos.right=right+"px"}else if(orientation==="center"){pos.top=Math.max(0,(document.documentElement.clientHeight-_jq("#userlike-popup").height())/2)+"px";pos.left=Math.max(0,(document.documentElement.clientWidth-_jq("#userlike-popup").width())/2)+"px"}else{for(key in pos){if(!hasProp.call(pos,key))continue;if(data[key]){pos[key]=data[key]+"px"}}}}if(relativeTo==="button"){pos.position="absolute";if($el.css("position")==="fixed"){stop=document.body.scrollTop;sleft=document.body.scrollLeft}else{stop=0;sleft=0}if(orientation==="left"){pos.top=offset.top-stop+"px";pos.left=offset.left+w+margin-sleft+"px"}else if(orientation==="right"){pos.top=offset.top-stop+"px";pos.left=offset.left-_jq("#userlike-popup").width()-margin-sleft+"px"}else if(orientation==="topLeft"){pos.top=offset.top+h+margin-stop+"px";pos.left=offset.left-sleft+"px"}else if(orientation==="topRight"){pos.top=offset.top+h+margin-stop+"px";pos.left=offset.left-_jq("#userlike-popup").width()-sleft+"px"}else if(orientation==="bottomLeft"){pos.left=offset.left-sleft+"px";pos.bottom=document.documentElement.clientHeight-offset.top+margin+stop+"px"}else if(orientation==="bottomRight"){pos.left=offset.left-_jq("#userlike-popup").width()+"px";pos.bottom=document.documentElement.clientHeight-offset.top+margin+stop+"px"}else if(orientation==="center"){pos.top=Math.max(0,(document.documentElement.clientHeight-_jq("#userlike-popup").height())/2)+"px";pos.left=Math.max(0,(document.documentElement.clientWidth-_jq("#userlike-popup").width())/2)+"px"}else{pos.top=offset.top-_jq("#userlike-popup").height()-margin;pos.left=offset.left}}return pos};return ButtonCustom}(Button);ButtonFactory=function(superClass){extend1(ButtonFactory,superClass);function ButtonFactory(){return ButtonFactory.__super__.constructor.apply(this,arguments)}ButtonFactory.prototype.makeButton=function(){if(document.getElementById("userlikeCustomTab")){return new ButtonCustom({config:this.config})}else if(this.config.theme.button_style==="bubble"){return new ButtonBubble({config:this.config})}else{return new ButtonBig({config:this.config})}};return ButtonFactory}(View);this.userlikeCallbackIframeCheck=function(resp){var blacklist,key;key="iframe_blacklist_"+hashCode(resp.url);blacklist=resp.status!=="200"||resp.xframe;_ullog("userlikeCallbackIframeCheck: url="+resp.url+" status="+resp.status+" xframe="+resp.xframe+" blacklist="+blacklist);return session.set(key,blacklist)};Popup=function(superClass){extend1(Popup,superClass);Popup.TIMEOUT=5e3;Popup.FADE=50;Popup.prototype.last_scroll_pos=null;Popup.prototype.is_visible=false;function Popup(options){var css,userlikestyle_element;Popup.__super__.constructor.call(this,options);this.tab_active=true;css=userlike_css.replace("{{FONT}}",this.config.theme.font.split(":")[0]);css=css.replace("{{ICON_FONT}}","userlike_"+this.config.theme.icon_set);userlikestyle_element=document.createElement("style");userlikestyle_element.type="text/css";document.getElementsByTagName("head")[0].appendChild(userlikestyle_element);if(userlikestyle_element.styleSheet){userlikestyle_element.styleSheet.cssText=css}else{userlikestyle_element.appendChild(document.createTextNode(css))}}Popup.prototype.setup=function(){this.setupDomReferences();this.setupEventHandlers();this.position=new Position;this.position.update();this.setView(idle_view);if(isAndroid()){this.keyhandler=(new KeyHandlerFactoryAndroid).get(this.$input,fsm)}else{this.keyhandler=(new KeyHandlerFactory).get(this.$input,fsm)}this.emojiPopover=new EmojiPopoverView;return this.setupLayout()};Popup.prototype.setupDomReferences=function(){this.$popup=_jq("#userlike-popup");this.$input=_jq("#userlike-chat-textarea");this.$content=_jq("#userlike-chat-content");this.$header=_jq("#userlike-chatHeadline");this.$headerbar_text=_jq("#userlike-headerbar-headline");this.$data_privacy=_jq("#userlike-data-privacy");this.$data_privacy_link=_jq("#userlike-data-privacy a");return this.$message_headline=_jq("#userlike-message-headline")};Popup.prototype.setConfig=function(config){this.config=_jq.extend({},this.config,config);return this};Popup.prototype.setHeaderbarText=function(){var headerbar_text;headerbar_text=this.view.getHeaderbarText();if(headerbar_text!=null){this.highlightText(this.$headerbar_text,headerbar_text);return this.$headerbar_text.text(headerbar_text)}};Popup.prototype.setupEventHandlers=function(){_jq("#userlike-close").on("click",function(e){fsm.event("closeButton");_jq.event(e).preventDefault();return _jq.event(e).stopPropagation()});_jq("#userlike-minimize").on("click",function(e){fsm.event("minimizeButton");_jq.event(e).preventDefault();return _jq.event(e).stopPropagation()});_jq(".userlike-fieldset-wrapper div").on("click",function(e){var $select,$target;$target=_jq(_jq.event(e).target);$select=$target.data("select")||$target.parent().data("select");if($select){fsm.event("select",$select)}_jq.event(e).preventDefault();return _jq.event(e).stopPropagation()});_jq("#userlike-register-form,#userlike-offline-email,#userlike-offline-name,#userlike-feedback-form,#userlike-transcript-form").on("keypress",function(e){var $e;$e=_jq.event(e);if($e.which===13){return fsm.event("submitButton")}});_jq.windowOn("resize",function(_this){return function(){return _this.position.update()}}(this));_jq.windowOn("focus",function(_this){return function(){_ullog("Popup::focus");return _this.tab_active=true}}(this));_jq("body").on("gesturestart",function(_this){return function(){return _this.position.update()}}(this));_jq.windowOn("blur",function(_this){return function(){_ullog("Popup::blur");return _this.tab_active=false}}(this));if(is_mobile){return _jq('textarea, input[type="text"], input[type="email"]').on("focus",function(){return window.setTimeout(function(_this){return function(){if(_this.scrollIntoViewIfNeeded!=null){return _this.scrollIntoViewIfNeeded()}else if(_this.scrollIntoView!=null){return _this.scrollIntoView()}}}(this),250)})}};Popup.prototype.setupLayout=function(){if(this.config.show_data_privacy_link){this.$data_privacy.css("display","block");this.$data_privacy_link.attr("href",this.config.data_privacy_link);this.$data_privacy_link.text(this.config.data_privacy_name)}else{this.$data_privacy.hide()}if(this.config.hide_poweredby){this.$popup.find("#userlike-poweredby").hide()}else{this.$popup.find("#userlike-poweredby").show()}if(this.view.is_minimizable){_jq("#userlike-minimize").css("display","inline-block").importize()}else{_jq("#userlike-minimize").css("display","none").importize()}if(!has_css_animation_support&&!_jq("#userlike").hasClass("userlike-no-css-animation")){return _jq("#userlike").addClass("userlike-no-css-animation")}};Popup.prototype.setupTheme=function(){var _this,key,ref1,ref2,val;_this=this;if(isIE8()){ref1=this.config.theme;for(key in ref1){if(!hasProp.call(ref1,key))continue;val=ref1[key];if(typeof val==="string"&&val.indexOf("rgba(")!==-1){this.config.theme[key]=rgbaToRgb(val)}}}applyTheme(this.config.theme);return(ref2=this.position)!=null?ref2.update():void 0};Popup.prototype.isActive=function(){if(!this.$popup){this.setupDomReferences()}return this.tab_active&&this.$popup.css("display")==="block"};Popup.prototype.isVisible=function(){return this.is_visible};Popup.prototype.hideTab=function(callback){return _jq("#userlike-tab").fadeOut(Popup.FADE,callback)};Popup.prototype.hide=function(callback){if(callback==null){callback=function(){}}this.is_visible=false;if(!this.$popup){if(button!=null){button.show()}callback();return}return this.$popup.fadeOut(Popup.FADE,function(){tracking_event.trigger("window_invisible");if(button!=null){button.show()}return callback()})};Popup.prototype.show=function(callback){this.reset();this.is_visible=true;return this.transition(this.view,callback)};Popup.prototype.startDisableBodyScroll=function(){if(this.last_scroll_pos==null){this.last_scroll_pos=_jq("body").scrollTop()}return _jq("body").addClass("userlike-disable-body-scroll")};Popup.prototype.stopDisableBodyScroll=function(){_jq("body").removeClass("userlike-disable-body-scroll");if(this.last_scroll_pos!=null){_jq("body").scrollTop(this.last_scroll_pos);return this.last_scroll_pos=null}};Popup.prototype.reset=function(){button.clear();chat_view.incoming_messages=0;if(is_mobile){return setBadge(0)}else if(this.config.favicon_enabled){return setBubble(0)}};Popup.prototype.close=function(callback){if(callback==null){callback=function(){}}return this.hide(function(_this){return function(){_this.reset();_this.view.el().hide();_this.$content.empty();_this.$input.val("");return callback()}}(this))};Popup.prototype.setView=function(next_view){this.view=next_view;if(is_mobile){return this.view.height_mobile}return this.view.height};Popup.prototype.transition=function(next_view,callback){var height;_ullog("Popup::transition next="+next_view.el().attr("id"));this.is_visible=true;if(!this.$popup||!this.position){this.setup()}if(this.view!=null&&this.view.el().get()!==next_view.el().get()){this.view.el().hide();this.view.destroy()}if(this.$popup.css("display")!=="block"){tracking_event.trigger("window_visible")}height=this.setView(next_view);this.setHeaderbarText();this.$popup.css({height:height});this.position.update();this.reset();this.setupLayout();this.$popup.fadeIn({duration:Popup.FADE,queue:false});this.view.el().fadeIn({duration:Popup.FADE,queue:false,complete:callback});return adjustFontSize(this.view.el().find(".userlike-adjust-text"))};Popup.prototype.injectIframe=function(url){var $iframe,iframe_container;if(session.get("iframe_blacklist_"+hashCode(url))||_jq.browser.msie){return window.open(url)}iframe_container=document.createElement("div");iframe_container.id="userlikePushIframe";$iframe=_jq(iframe_container);$iframe.html('<i id="userlikePushIframeClose" class="userlike-icon userlike-icon-close userlike-theme-text userlike-theme-headbar-text-color"></i>\n<div id="userlikePushIframeOpen"></div>\n<div id="userlikeSpinnerIframe">\n  <div id="userlikeBounce1"></div>\n  <div id="userlikeBounce2"></div>\n  <div id="userlikeBounce3"></div>\n</div>\n<iframe id="userlikePushIframe" src="'+url+'" style="border:none">');_jq("#userlikePushIframe").remove();_jq("body").append($iframe);_jq("#userlikePushIframeClose").on("click",function(){return _jq("#userlikePushIframe").remove()});_jq("#userlikePushIframeOpen").on("click",function(){window.open(url);return _jq("#userlikePushIframe").remove()});return setTimeout(function(){return _jq("#userlikeSpinnerIframe").remove()},5e3)};Popup.prototype.clearInput=function(name,def,val){var $e,has_changed_default;$e=_jq(name);has_changed_default=$e.data("default")&&$e.data("default")!==def;$e.data("default",def);if(!val){val=def}if(!$e.val().length&&!$e.hasFocus()){$e.val(val);$e.css({color:this.config.theme.input_default_text_color})}if(has_changed_default){if(typeof userlikePreview!=="undefined"&&userlikePreview!==null?userlikePreview.isActive():void 0){this.highlightText($e,val)}$e.val(def);$e.css({color:this.config.theme.input_default_text_color})}$e.off("focus");$e.focus(function(_this){return function(){def=$e.data("default");$e.css({"border-color":_this.config.theme.icon_active_color});if($e.val()===def){$e.val("");return $e.css({color:_this.config.theme.text_default_color})}}}(this));$e.off("blur");return $e.blur(function(_this){return function(){if($e.val()===""){$e.val(def).css({color:_this.config.theme.input_default_text_color})}return $e.css({"border-color":_this.config.theme.border_color.replace("1.0","0.4")})}}(this))};return Popup}(View);Loader=function(){function Loader(){}Loader.loadLib=function(callback){var scripts;scripts={userlikelib:"dq4irj27fs462.cloudfront.net/userlikelib.min.js"};return Loader.loadScripts(scripts,function(){return callback()})};Loader.loadScripts=function(scripts,callback){var count,p,results1,src,srcs;srcs=[];for(p in scripts){if(!hasProp.call(scripts,p))continue;if(!(p in window)){srcs.push(scripts[p])}}count=srcs.length;if(count===0){callback()}i=0;results1=[];while(i<srcs.length){src=srcs[i];Loader.loadScript(src,function(){if(--count===0){return callback()}});results1.push(i++)}return results1};Loader.loadScript=function(src,callback){var script;_ullog("loadScript: "+src);script=document.createElement("script");script.setAttribute("type","text/javascript");script.setAttribute("src","https://"+src);script.onload=script.onreadystatechange=function(){var state;state=script.readyState;if(!callback.done&&(!state||/loaded|complete/.test(state))){callback.done=true;return callback()}};return document.getElementsByTagName("head")[0].appendChild(script)};Loader.loadFont=function(fontName){var e,error,s,wf;try{window.WebFontConfig={google:{families:[fontName]}};wf=document.createElement("script");wf.src="https://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js";wf.type="text/javascript";wf.async="true";s=document.getElementsByTagName("script")[0];return s.parentNode.insertBefore(wf,s)}catch(error){e=error;return _ullog("Error loading font ",e)}};Loader.loadTheme=function(){var theme_style_element;theme_style_element=document.createElement("style");theme_style_element.type="text/css";if(theme_style_element.styleSheet){theme_style_element.styleSheet.cssText=config.theme_css}else{theme_style_element.appendChild(document.createTextNode(config.theme_css))}return document.getElementsByTagName("head")[0].appendChild(theme_style_element)};Loader.loadCustomCss=function(){var custom_style_element;custom_style_element=document.createElement("style");custom_style_element.type="text/css";if(custom_style_element.styleSheet){custom_style_element.styleSheet.cssText=config.custom_css}else{custom_style_element.appendChild(document.createTextNode(config.custom_css))}return document.getElementsByTagName("head")[0].appendChild(custom_style_element)};Loader.injectMarkup=function(callback){var div,el,j,len1,ref,ref1,trial,wait;if(callback==null){callback=function(){}}div=document.createElement("div");div.className="userlike";div.innerHTML=userlike_html.replace(/{{POWEREDBY_LINK}}/g,config.poweredby_link).replace(/{{POWEREDBY_SLOGAN}}/g,config.poweredby_slogan);ref1=["body","frameset","head"];for(j=0,len1=ref1.length;j<len1;j++){ref=ref1[j];el=document.getElementsByTagName(ref);if(el[0]){el[0].appendChild(div);break}}trial=100;wait=function(){if((!document.getElementById("userlike")||!document.getElementById("userlike-offline-message-submit")||!document.getElementById("userlike-register-submit"))&&trial--){_ullog("Popup::inject wait");return window.setTimeout(wait,300)}else{return callback(!document.getElementById("userlike")&&!document.getElementById("userlike-offline-message-submit")&&!document.getElementById("userlike-register-submit"))}};return wait()};return Loader}();IdleView=function(superClass){extend1(IdleView,superClass);function IdleView(){return IdleView.__super__.constructor.apply(this,arguments)}IdleView.prototype.height=216;IdleView.prototype.el=function(){return _jq("#userlike-idle")};IdleView.prototype.show=function(callback){return popup.transition(this,callback)};return IdleView}(View);ChatView=function(superClass){extend1(ChatView,superClass);ChatView.preview_connecting_timeout=null;ChatView.prototype.height=568;ChatView.prototype.is_minimizable=true;ChatView.prototype.update_timestamps_interval=null;ChatView.prototype.chat_state_message=null;ChatView.prototype.incoming_messages=0;function ChatView(options){this.scrollDownDelayed=bind(this.scrollDownDelayed,this);this.onKeyboardHide=bind(this.onKeyboardHide,this);this.onKeyboardShow=bind(this.onKeyboardShow,this);ChatView.__super__.constructor.call(this,options)}ChatView.prototype.el=function(){return _jq("#userlike-chat")};ChatView.prototype.setupDomReferences=function(){this.$popup=_jq("#userlike-popup");this.$input=_jq("#userlike-chat-textarea");this.$content=_jq("#userlike-chat-content");return this.$};ChatView.prototype.scrollDown=function(){return this.$content.scrollTop(1e4)};ChatView.prototype._hasChangedPreviewText=function(key){var ref1;if((typeof userlikePreview!=="undefined"&&userlikePreview!==null?(ref1=userlikePreview.last_config)!=null?ref1[key]:void 0:void 0)==null){return false}return(typeof userlikePreview!=="undefined"&&userlikePreview!==null?userlikePreview.last_config[key]:void 0)!==this.config[key]};ChatView.prototype.showPreview=function(){var should_display_slot,should_show_dummy_messages;if(!this.$popup){this.setupDomReferences()}this.setMomentLocale();this._reset();should_show_dummy_messages=false;should_display_slot=true;if(this._hasChangedPreviewText("connect_message")){this.showConnectView();should_display_slot=false}else if(this._hasChangedPreviewText("quit_message")){this.setOperatorInfo(this.config.operator_display_name,true,this.config.quit_message);should_display_slot=false}else if(this._hasChangedPreviewText("default_message")){this.sendWelcomeMessage(this.config.operator_display_name)}else if(this._hasChangedPreviewText("status_message")){should_show_dummy_messages=true}else if(this._hasChangedPreviewText("inactivity_message")){this.sendInactivityMessage(this.config.operator_display_name)}else if(this._hasChangedPreviewText("forward_message")){this.sendForwardMessage(this.config.operator_display_name)}else if(this._hasChangedPreviewText("proactive_message")){this.sendProactiveMessage(this.config.operator_display_name)}else{should_show_dummy_messages=true}if(should_display_slot){this.displaySlot(this.config.operator_display_name,this.config.operator_url_image,this.config.status_message)}if(should_show_dummy_messages){this.sendWelcomeMessage(this.config.operator_display_name);this.addMessage("co","Hello, I have a Question");this.addMessage("ct","Hey, how can i help you?")}this.show();if(typeof userlikePreview!=="undefined"&&userlikePreview!==null){userlikePreview.last_config=this.config}return this};ChatView.prototype._reset=function(){return this.$content.html("")};ChatView.prototype.show=function(callback){if(callback==null){callback=function(){}}this.setMomentLocale();if(!this.$popup){this.setupDomReferences()}if(this.update_timestamps_interval==null){this.startTimstampUpdate()}popup.clearInput("#userlike-chat-textarea",this.config.default_textarea);popup.transition(this,function(_this){return function(){_this.scrollDown();return callback()}}(this));if(is_mobile){onKeyboardStateChange(this.onKeyboardShow,this.onKeyboardHide);return _jq(document).on("focusout",this.onKeyboardHide)}else{return this.registerOperatorZoom()}};ChatView.prototype.onKeyboardShow=function(){this.scrollDownDelayed();if(getOrientation()==="landscape"){return _jq("#userlike").addClass("userlike-chat-textarea-fullscreen")}else{return _jq("#userlike").removeClass("userlike-chat-textarea-fullscreen")}};ChatView.prototype.onKeyboardHide=function(){return _jq("#userlike").removeClass("userlike-chat-textarea-fullscreen")};ChatView.prototype.scrollDownDelayed=function(){return window.setTimeout(function(_this){return function(){return _this.scrollDown()}}(this),250)};ChatView.prototype.registerOperatorZoom=function(){var $el,_setZoomed,t;t=null;$el=_jq("#userlike-subheader-operator-image-zoomed");_setZoomed=function(should_zoom){clearTimeout(t);t=null;if(should_zoom){return $el.addClass("userlike-zoom")}else{return $el.removeClass("userlike-zoom")}};_jq("#userlike-subheader-operator-image-zoomed").on("click",function(){var should_zoom;should_zoom=!$el.hasClass("userlike-zoom");return _setZoomed(should_zoom)});_jq("#userlike-subheader-operator-image-zoomed").on("mouseenter",function(){if(t===null){return t=setTimeout(function(){return _setZoomed(true)},500)}});return _jq("#userlike-subheader-operator-image-zoomed").on("mouseleave",function(){return _setZoomed(false)})};ChatView.prototype.setMomentLocale=function(){if(this.config.lang!==userlikeMoment.locale()){userlikeMoment.locale(this.config.lang);return this.updateTimestamps()}};ChatView.prototype.startTimstampUpdate=function(){return this.update_timestamps_interval=window.setInterval(this.updateTimestamps,1e4)};ChatView.prototype.updateTimestamps=function(){var timestamps;timestamps=_jq(".userlike-message-timestamp");if(timestamps.size()){return timestamps.each(function(i,el){var sentAt;sentAt=el.data("timestamp");if(sentAt!=null){return el.text(userlikeMoment(parseInt(sentAt,10)).fromNow())}})}};ChatView.prototype.stopTimstampUpdate=function(){return window.clearInterval(this.update_timestamps_interval)};ChatView.prototype.isEmptyMessage=function(message){if(message==null){return false}return message.charCodeAt(0)===10};ChatView.prototype.isValidMessage=function(message){var has_content,has_valid_length;if(message==null){return false}has_content=message.length>0;has_valid_length=message.length<=5e3;return has_content&&has_valid_length};ChatView.prototype.sendMessage=function(){var raw_text,ref1,text;text=getInput("#userlike-chat-textarea");if(this.isEmptyMessage(text)){_jq("#userlike-chat-textarea").val("");text=getInput("#userlike-chat-textarea")}if(!this.isValidMessage(text)){return}this.checkAndRequestURLInfo(text,"co");raw_text=text;this.$input.val("");text=text.replace(/\r/g,"");this.addMessage("co",text);if(is_mobile){if((ref1=this.$input.get())!=null){if(typeof ref1.blur==="function"){ref1.blur()}}this.scrollDownDelayed()}return raw_text};ChatView.prototype.sendWelcomeMessage=function(name_overwrite){var operator_name,text;operator_name=name_overwrite||session.get("operator_display_name");text=this.replaceName(this.config.default_message,operator_name);return this.addMessage("ct",text)};ChatView.prototype.sendProactiveMessage=function(name_overwrite){var operator_name,text;operator_name=name_overwrite||session.get("operator_display_name");text=this.replaceName(this.config.proactive_message,operator_name);return this.addMessage("ct",text)};ChatView.prototype.sendForwardMessage=function(name_overwrite){var operator_name,text;operator_name=name_overwrite||session.get("operator_display_name");text=this.replaceName(this.config.forward_message,operator_name);return this.addMessage("ct",text)};ChatView.prototype.sendQuitMessage=function(name_overwrite){var operator_name,text;operator_name=name_overwrite||session.get("operator_display_name");text=this.replaceName(this.config.quit_message,operator_name);return this.addMessage("ct",text)};ChatView.prototype.sendInactivityMessage=function(name_overwrite){var operator_name,text;operator_name=name_overwrite||session.get("operator_display_name");text=this.replaceName(this.config.quit_message,operator_name);return this.addMessage("ct",this.config.inactivity_message)};ChatView.prototype.setOperatorInfo=function(name,url,text){if(name&&text){return this.setInfoBar({text:this.replaceName(text,name),url:url})}};ChatView.prototype.showOperatorQuitInfo=function(){this.setOperatorInfo(session.get("operator_display_name"),true,config.quit_message);return this.removeChatState()};ChatView.prototype.setProactiveMessage=function(text){if(text!=null){return this.config.proactive_message=text}};ChatView.prototype.checkAndRequestURLInfo=function(text,type){var up;if(!text){return}if(isURL(text)){text=text.split("#")[0];up=new UrlParser(text,true);return fsm.event("requestUrlInfo",{url:up.url(),callback:function(_this){return function(data){return _this.addUrlInfo(data,type)}}(this)})}};ChatView.prototype.addUrlInfo=function(data,type){var existing_messages,link_markup,message_to_replace,url_info_markup,url_info_message;if(data==null){return}link_markup=this.replaceUrls(data.url);url_info_markup=link_markup+'<br><br>\n<div class="userlike-url-info-title">'+data.title+"</div><br>\n"+data.description+'<br>\n<img class="userlike-url-info-image "src="'+data.screenshot_url+'" alt="'+data.url+'">';url_info_message=this.createMessageContainer(type,url_info_markup);message_to_replace=null;existing_messages=_jq(".userlike-message-container-"+type);existing_messages.each(function(i,el){var message_text,up;message_text=el.find(".userlike-chat-message-text").text();up=new UrlParser(message_text,true);if(up.url()===data.url){return el.html(url_info_message.html())}});return this.scrollDown()};ChatView.prototype.replaceName=function(text,name){return text.replace("{{name}}",name)};ChatView.prototype.replaceText=function(data){var $el,ct_bubbles;ct_bubbles=this.$content.find(".userlike-message-bubble-ct").get();if(ct_bubbles.length){if(this.chat_state_message!=null){$el=_jq(ct_bubbles[ct_bubbles.length-2])}else{$el=_jq(ct_bubbles[ct_bubbles.length-1])}}else if(ct_bubbles!=null){$el=_jq(ct_bubbles)}return $el!=null?$el.find(".userlike-chat-message-text").text($el.text().replace(data[1],data[2])):void 0};ChatView.prototype.checkIframe=function(url){if(session.get("iframe_blacklist_"+hashCode(url))!==void 0){return}return Loader.loadScript("api.userlike.com/api/client/iframe/?url="+encodeURIComponent(url)+"&callback=userlikeCallbackIframeCheck",function(){})};ChatView.prototype.replaceLinkOffsite=function(url){return'<a style="color: '+rgb(this.config.theme.link_text_color)+'" href="'+url+'" target="_blank">'+url+"</a>"};ChatView.prototype.replaceLinkOnsite=function(url){return'<a style="color: '+rgb(this.config.theme.link_text_color)+'" href="'+url+'">'+url+"</a>"};ChatView.prototype.replaceEmails=function(email){return'<a style="color: '+rgb(this.config.theme.link_text_color)+'" href="mailto:'+email+'">'+email+"</a>"};ChatView.prototype.replaceUrls=function(item){var replacement,up;up=new UrlParser(item,true);if(up.isOffsite()){if(this.config.links_offsite==="new"){replacement=this.replaceLinkOffsite(up.original())}else{replacement=this.replaceLinkOnsite(up.original())}}else{if(this.config.links_onsite==="new"){replacement=this.replaceLinkOffsite(up.original())}else{replacement=this.replaceLinkOnsite(up.original())}}return replacement};ChatView.prototype.replaceLinks=function(text){text=this.regex_replace(text,regex_email,this.replaceEmails);return text=this.regex_replace(text,regex_url_full,this.replaceUrls)};ChatView.prototype.regex_replace=function(text,regex,replace_func){var end,item,match,replacement,start,text_end,text_start;regex=new RegExp(regex.source,"i");while(true){match=regex.exec(text);if(match){start=match.index;end=start+match[0].length;item=match[0];if(/^\s/.test(item)){start+=1;item=trim(item)}replacement=replace_func.apply(this,[item]);if(replacement){text_start=text.substr(0,start);text_end=text.substr(end);text=text_start+replacement+text_end;continue}}break}return text};ChatView.prototype.escapeTag=function(text){return(""+text).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};ChatView.prototype.escapeUrl=function(text){return(""+text).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};ChatView.prototype.replaceNewlines=function(text){return(""+text).replace(/(?:\r\n|\r|\n)/g,"<br />")};ChatView.prototype.addMessage=function(type,text,sent_at){text=this.escapeTag(text);text=emotify(text.replace(/&gt;/g,">"));text=this.replaceLinks(text);text=this.replaceNewlines(text);this.addToContent(type,text,sent_at);if(type==="co"||(typeof userlikePreview!=="undefined"&&userlikePreview!==null?userlikePreview.isActive():void 0)){this.incoming_messages=0}else{this.incoming_messages++}if(is_mobile){return setBadge(this.incoming_messages)}else if(this.config.favicon_enabled){return setBubble(this.incoming_messages)}};ChatView.prototype.createMessageContainer=function(type,text,sent_at){var message_bubble,message_container,message_text,message_timestamp,sent_at_moment;message_container=_jq(document.createElement("div")).addClass("userlike-message-container").addClass("userlike-message-container-"+type);message_bubble=_jq(document.createElement("div")).addClass("userlike-message-bubble").addClass("userlike-message-bubble-"+type).addClass("userlike-theme-bg");message_text=_jq(document.createElement("span")).addClass("userlike-chat-message-text").addClass("userlike-theme-text").addClass("userlike-theme-chat-text-color-1").html(text);message_bubble.append(message_text);if(type==="co"){message_bubble.addClass("userlike-theme-chat-bg-color-2")}else if(type==="ct"){message_bubble.addClass("userlike-theme-chat-bg-color-1")}if(sent_at==null){sent_at=+new Date}sent_at_moment=userlikeMoment(sent_at);message_timestamp=_jq(document.createElement("div")).addClass("userlike-message-timestamp").addClass("userlike-message-timestamp-"+type).addClass("userlike-theme-text").addClass("userlike-theme-link-text-color").data("timestamp",+sent_at_moment).text(sent_at_moment.fromNow());message_container.append(message_bubble).append(message_timestamp);applyTheme(this.config.theme,message_container);return message_container};ChatView.prototype.addToContent=function(type,text,sent_at){var message_container;if(type==="ct"){this.removeChatState()}message_container=this.createMessageContainer(type,text,sent_at);this.$content.append(message_container);this.scrollDown();return message_container};ChatView.prototype.showChatState=function(text){var spinner_markup;this.removeChatState();spinner_markup=null;if(has_css_animation_support){spinner_markup='<div id="userlike-spinner">\n  <div id="userlike-bounce-1" class="userlike-theme-bg userlike-theme-icon-active-color"></div>\n  <div id="userlike-bounce-2" class="userlike-theme-bg userlike-theme-icon-active-color"></div>\n  <div id="userlike-bounce-3" class="userlike-theme-bg userlike-theme-icon-active-color"></div>\n</div>'}else{spinner_markup='<img id="userlike-spinner" src="//dq4irj27fs462.cloudfront.net/spinner.gif"/>'}this.chat_state_message=this.addToContent("ct",spinner_markup);return window.setTimeout(function(_this){return function(){return _this.removeChatState()}}(this),6e4)};ChatView.prototype.removeChatState=function(){if(this.chat_state_message!=null){this.chat_state_message.remove();return this.chat_state_message=null}};ChatView.prototype.showInfoMessage=function(text){this.removeChatState();this.addToContent("ct",text);return this.scrollDown()};ChatView.prototype.receiveDownload=function(from,url,name){return this.addToContent("ct",this.config.feedback_download_link+(' <a style="color: '+rgb(this.config.theme.link_text_color)+'" href="'+url+'" target="_blank">'+name+"</a>"))};ChatView.prototype.receiveMessage=function(from,body,sent_at){this.checkAndRequestURLInfo(body,"ct");return this.addMessage("ct",body,sent_at)};ChatView.prototype.stateComposing=function(from){return this.showChatState()};ChatView.prototype.statePaused=function(from){return this.removeChatState()};ChatView.prototype.showConnectView=function(callback){if(callback==null){callback=function(){}}_jq("#userlike-subheader-operator-image-zoomed").hide();return this.show(function(_this){return function(){_this.setInfoBar({text:_this.config.connect_message});_this.scrollDown();return callback()}}(this))};ChatView.prototype.displaySlot=function(name,url,status_text,callback){if(callback==null){callback=function(){}}if(!this.$popup){this.setupDomReferences()}if(status_text){this.setOperatorInfo(name,url,status_text)}_ullog("displaySlot name="+name+" status_text="+status_text+" url="+url);this.scrollDown();this.enable();return callback()};ChatView.prototype.setInfoBar=function(options){if(options.text){_jq("#userlike-subheader-operator-info-text").text(options.text)}if(options.url){_jq(".userlike-operator-connect-spinner").hide();if(typeof options.url==="string"){_jq("#userlike-subheader-operator-image").attr("src",options.url);_jq("#userlike-subheader-operator-image-zoomed").attr("src",options.url);_jq("#userlike-subheader-operator-image-zoomed").show()}return _jq("#userlike-subheader-operator-image").show();
}else{if(has_css_animation_support){_jq("#userlike-subheader-operator-image").hide();return _jq(".userlike-operator-connect-spinner").show()}else{_jq("#userlike-subheader-operator-image").show();return _jq("#userlike-subheader-operator-image").attr("src","//dq4irj27fs462.cloudfront.net/spinner.gif")}}};ChatView.prototype.playbackSlot=function(buffer){var item,j,len1,results1;results1=[];for(j=0,len1=buffer.length;j<len1;j++){item=buffer[j];if(item.type==="co"){this.checkAndRequestURLInfo(item.body,"co");results1.push(this.addMessage("co",item.body,item.sent_at))}else if(item.type==="ct"){this.checkAndRequestURLInfo(item.body,"ct");results1.push(this.addMessage("ct",item.body,item.sent_at))}else if(item.type==="op"){results1.push(this.displaySlot(session.get("operator_display_name"),item.url,config.status_message))}else{results1.push(void 0)}}return results1};ChatView.prototype.disable=function(){return _jq("#userlikeTextarea").attr("disabled","disabled")};ChatView.prototype.enable=function(){return _jq("#userlikeTextarea").removeAttr("disabled")};ChatView.prototype.destroy=function(){_jq("#userlike-subheader-operator-image-zoomed").hide();return this.stopTimstampUpdate()};return ChatView}(View);DisclaimerView=function(superClass){extend1(DisclaimerView,superClass);function DisclaimerView(){return DisclaimerView.__super__.constructor.apply(this,arguments)}DisclaimerView.prototype.el=function(){return _jq("#userlike-disclaimer")};DisclaimerView.prototype.setupEventHandlers=function(){return _jq("#userlike-disclaimer-submit").on("click",function(_this){return function(e){fsm.event("submitButton");_jq.event(e).preventDefault();return _jq.event(e).stopPropagation()}}(this))};DisclaimerView.prototype.show=function(callback){this.setupEventHandlers();this.highlightText("#userlike-disclaimer-headline",this.config.disclaimer_headline);this.highlightText("#userlike-disclaimer-text",this.config.disclaimer_text);_jq("#userlike-disclaimer-headline").text(this.config.disclaimer_headline);_jq("#userlike-disclaimer-text").text(this.config.disclaimer_text);return popup.transition(this,callback)};DisclaimerView.prototype.destroy=function(){return _jq("#userlike-disclaimer-submit").off("click")};return DisclaimerView}(View);FacebookView=function(superClass){extend1(FacebookView,superClass);function FacebookView(){return FacebookView.__super__.constructor.apply(this,arguments)}FacebookView.prototype.el=function(){return _jq("#userlike-facebook-like")};FacebookView.prototype.show=function(callback){var _fixFacebookWidth,b,e,error,headline_margin_right,layout,max_trials,ref1,trial;_jq("#userlike-facebook-like-headline").text(this.config.facebook_like_headline);if(is_mobile){layout="button"}else{layout=this.config.facebook_like_layout}if(_jq("#userlike-facebook-like-button").size()===0){b='<div id="userlike-facebook-like-button" class="fb-like" ';b+='data-send="false" data-width="200" ';b+='data-show-faces="'+this.config.facebook_like_show_faces+'" ';b+='data-action="'+this.config.facebook_like_verb+'" ';if((ref1=this.config.facebook_like_href)!=null?ref1.length:void 0){b+='data-href="'+this.config.facebook_like_href+'" '}b+='data-layout="'+layout+'">';_jq("#userlike-facebook-like-wrapper").html(b);_ullog("Popup::showFacebookLikeView: b="+b);try{FB.XFBML.parse(_jq("#userlike").get());headline_margin_right=16;max_trials=100;trial=0;_fixFacebookWidth=function(){var available_width,button_width,text_width;trial++;button_width=_jq("#userlike-facebook-like-button > span").width();if(button_width>0){available_width=_jq("#userlike-facebook-like").width();text_width=_jq("#userlike-facebook-like-headline").width();if(available_width-text_width<button_width){return _jq(".userlike-facebook-like").addClass("userlike-break-facebook-line")}else{_jq("#userlike-facebook-like-headline").css("max-width","100%");return _jq("#userlike-facebook-like-headline").css("width",available_width-button_width-headline_margin_right).importize()}}else if(trial<max_trials){return window.setTimeout(_fixFacebookWidth,100)}};_fixFacebookWidth()}catch(error){e=error;_ullog("showFacebookLikeView: err=",e)}}return this.el().show()};return FacebookView}(View);TwitterView=function(superClass){extend1(TwitterView,superClass);function TwitterView(){return TwitterView.__super__.constructor.apply(this,arguments)}TwitterView.prototype.el=function(){return _jq("#userlike-twitter-tweet")};TwitterView.prototype.show=function(callback){var b,e,error,twitter_tweet_button;_jq("#userlike-twitter-tweet-headline").text(this.config.twitter_headline);_jq("#userlike-twitter-tweetButton").remove();b="";if(this.config.twitter_type==="share"){b+='<a href="https://twitter.com/share" ';b+='data-size="large" ';b+='data-lang="'+this.config.lang+'" ';b+='class="twitter-share-button" ';b+='data-text="'+this.config.twitter_share_text+'" ';b+='data-via="'+this.config.twitter_share_via+'" ';b+='data-hashtags="'+this.config.twitter_share_hashtag+'" ';if(!this.config.twitter_share_show_count){b+='data-count="none" '}b+="></a>"}else if(this.config.twitter_type==="follow"){b+='<a href="https://twitter.com/'+this.config.twitter_follow_user+'" ';b+='data-size="large" ';b+='data-show-count="false" ';b+='data-lang="'+this.config.lang+'" ';b+='class="twitter-follow-button" ';if(!this.config.twitter_follow_show_username){b+='data-show-screen-name="false" '}b+="></a>"}else if(this.config.twitter_type==="mention"){b+='<a href="https://twitter.com/intent/tweet?screen_name='+this.config.twitter_mention_user+"&text="+this.config.twitter_mention_text+'" ';b+='data-size="large" ';b+='data-lang="'+this.config.lang+'" ';b+='class="twitter-mention-button" ';b+="></a>"}_ullog("Popup::showTwitterTweetView: b="+b);twitter_tweet_button=document.createElement("div");twitter_tweet_button.id="userlike-twitter-tweetButton";twitter_tweet_button=_jq(twitter_tweet_button);_jq("#userlike-twitter-tweet-wrapper").append(twitter_tweet_button);twitter_tweet_button.html(b);try{twttr.widgets.load();twttr.events.bind("tweet",function(){return tracking_event.trigger("twitter_tweet_tweeted")})}catch(error){e=error;_ullog("showTwitterTweetView: err=",e)}return this.el().show()};return TwitterView}(View);SocialCompositeView=function(superClass){extend1(SocialCompositeView,superClass);function SocialCompositeView(){return SocialCompositeView.__super__.constructor.apply(this,arguments)}SocialCompositeView.prototype.el=function(){return _jq("#userlike-social-composite")};SocialCompositeView.prototype.show=function(callback){if(callback==null){callback=function(){}}return popup.transition(this,function(_this){return function(){if(facebook&&_this.config.facebook_like_enabled){facebook_view.show()}if(!isIE8()&&twitter&&_this.config.twitter_integration){twitter_view.show()}return callback()}}(this))};return SocialCompositeView}(View);FeedbackView=function(superClass){extend1(FeedbackView,superClass);function FeedbackView(){return FeedbackView.__super__.constructor.apply(this,arguments)}FeedbackView.prototype.el=function(){return _jq("#userlike-feedback")};FeedbackView.prototype.setupEventHandlers=function(){_jq("#userlike-feedback-textarea").on("keyup",function(_this){return function(){if(getInput("#userlike-feedback-textarea")){return _this.enableSubmit()}}}(this));return _jq("#userlike-feedback-submit").on("click",function(e){if(!_jq("#userlike-feedback-submit").hasClass("userlike-disabed")){fsm.event("submitButton");_jq.event(e).preventDefault();return _jq.event(e).stopPropagation()}})};FeedbackView.prototype.show=function(callback){this.el().show();this.setupEventHandlers();return popup.clearInput("#userlike-feedback-textarea",this.config.feedback_default_textarea,this.config.feedback_default_textarea)};FeedbackView.prototype.hasInputValue=function(){var $textarea;$textarea=_jq("#userlike-feedback-textarea");return $textarea.val()!==$textarea.data("default")&&$textarea.val()!==""};FeedbackView.prototype.isValid=function(){return this.validateFeedback()};FeedbackView.prototype.validateFeedback=function(){var feedback_message;feedback_message=getInput("#userlike-feedback-textarea");if(!feedback_message){return false}if(feedback_message.length>1e4){_jq("#userlike-feedback-textarea").focus();return false}return true};FeedbackView.prototype.send=function(){var data,feedback_message;tracking_event.trigger("feedback_submit");feedback_message=getInput("#userlike-feedback-textarea");data={operator_id:session.get("operator_id"),customer_id:this.config.customer_id,chat_meta_id:session.get("chat_meta_id"),feedback_message:feedback_message};_ullog("FeedbackValidate::send "+data);return _jq.ajaxJsonp({url:"https://api.userlike.com/api/client/feedback/",data:data,error:function(err){return _ullog("FeedbackValidate::sendError "+err)},success:function(resp){return _ullog("FeedbackValidate::sendSuccess "+resp)}})};FeedbackView.prototype.enableSubmit=function(){return _jq("#userlike-feedback-submit").removeClass("userlike-disabled")};FeedbackView.prototype.destroy=function(){_jq("#userlike-feedback-submit").off("click");return _jq("#userlike-feedback-textarea").on("keyup")};return FeedbackView}(View);RatingView=function(superClass){extend1(RatingView,superClass);function RatingView(){return RatingView.__super__.constructor.apply(this,arguments)}RatingView.prototype.el=function(){return _jq("#userlike-rating")};RatingView.prototype.show=function(callback){this.highlightText("#userlike-rating-headline",this.config.feedback_header);_jq("#userlike-rating-headline").text(this.config.feedback_header);this.setupStarHover();this.setupStarClick();return this.el().show()};RatingView.prototype.selectedRating=null;RatingView.prototype.isValid=function(){return this.selectedRating!==null};RatingView.prototype.setupStarClick=function(){return _jq("#userlike-star-rating .userlike-icon").on("click",function(_this){return function(e){var $target,selected_rating_index;$target=_jq(_jq.event(e).target);selected_rating_index=$target.data("rating");_this.selectedRating=selected_rating_index;_this.setStarsHighlight(_this.selectedRating);return _this.enableSubmit()}}(this))};RatingView.prototype.setupStarHover=function(){var $stars;$stars=_jq("#userlike-star-rating .userlike-rating");$stars.on("mouseenter",function(_this){return function(e){var $target,selected_rating_index;$target=_jq(_jq.event(e).target);selected_rating_index=$target.data("rating");selected_rating_index=parseInt(selected_rating_index,10);return _this.setStarsHighlight(selected_rating_index)}}(this));return _jq("#userlike-star-rating").on("mouseleave",function(_this){return function(){if(_this.selectedRating){return _this.setStarsHighlight(_this.selectedRating)}else{return _this.setStarsHighlight(0)}}}(this))};RatingView.prototype.setStarsHighlight=function(till_index){var $stars;$stars=_jq("#userlike-star-rating .userlike-rating");return $stars.each(function(_this){return function(i,$star){if(i+1<=till_index){return $star.removeClass("userlike-icon-rating-inactive").addClass("userlike-icon-rating").css({color:_this.config.theme.icon_active_color})}else{return $star.removeClass("userlike-icon-rating").addClass("userlike-icon-rating-inactive").css({color:_this.config.theme.icon_default_color})}}}(this))};RatingView.prototype.send=function(){var r;tracking_event.trigger("rating_submit");r=new Rating;return r.send(rating_view.getRating())};RatingView.prototype.getRating=function(){return this.selectedRating};RatingView.prototype.enableSubmit=function(){return _jq("#userlike-feedback-submit").removeClass("userlike-disabled")};RatingView.prototype.destroy=function(){_jq("#userlike-star-rating .userlike-icon").off("mouseenter");return _jq("#userlike-star-rating .userlike-icon").off("click")};return RatingView}(View);FeedbackRatingCompositeView=function(superClass){extend1(FeedbackRatingCompositeView,superClass);function FeedbackRatingCompositeView(){return FeedbackRatingCompositeView.__super__.constructor.apply(this,arguments)}FeedbackRatingCompositeView.prototype.el=function(){return _jq("#userlike-feedback-rating-composite")};FeedbackRatingCompositeView.prototype.show=function(callback){if(callback==null){callback=function(){}}return popup.transition(this,function(_this){return function(){rating_view=new RatingView({config:_this.config});rating_view.show();feedback_view=new FeedbackView({config:_this.config});feedback_view.show();return callback()}}(this))};FeedbackRatingCompositeView.prototype.isValid=function(){return rating_view.isValid()||feedback_view.isValid()};return FeedbackRatingCompositeView}(View);GroupSelectView=function(superClass){extend1(GroupSelectView,superClass);function GroupSelectView(){return GroupSelectView.__super__.constructor.apply(this,arguments)}GroupSelectView.prototype.el=function(){return _jq("#userlike-group-select")};GroupSelectView.prototype.show=function(data,callback){var $userlikeGroupSelect;if(data==null){data=this.config.data}$userlikeGroupSelect=this.el();this.highlightText("#userlike-group-select-headline",this.config.group_select_headline);_jq("#userlike-group-select-headline").text(this.config.group_select_headline);$userlikeGroupSelect.find(".userlike-fieldset-wrapper>div").each(function(i,el){var $el,group_data,ref1;$el=_jq(el);if(i<data.available.length){group_data=data.available[i];$el.find("input").removeAttr("checked");$el.find(".userlike-label").text(group_data.name);if((ref1=group_data.first)!=null?ref1.url_image:void 0){$el.find(".userlike-group-select-operator-image").attr("src",group_data.first.url_image);$el.find("input").hide()}else{$el.find(".userlike-group-select-operator-image").hide();$el.find("input").show()}return $el.show()}else{return $el.hide()}});return popup.transition(this,callback)};return GroupSelectView}(View);MessageView=function(superClass){extend1(MessageView,superClass);function MessageView(){return MessageView.__super__.constructor.apply(this,arguments)}MessageView.prototype.height=216;MessageView.prototype.el=function(){return _jq("#userlike-message")};MessageView.prototype.show=function(text,callback){_ullog("Popup::showMessageView "+text);this.highlightText("#userlike-message-headline",text);_jq("#userlike-message-headline").text(text);return popup.transition(this,callback)};MessageView.prototype.showTransfer=function(callback){popup.reset();return this.show(this.config.feedback_transfer,callback)};MessageView.prototype.showExpiredWarning=function(callback){popup.reset();return this.show(this.config.feedback_expired,callback)};MessageView.prototype.showNoCookiesMessage=function(callback){popup.reset();return this.show(this.config.feedback_no_cookies,callback)};MessageView.prototype.showErrorMessage=function(callback){popup.reset();return this.show(this.config.feedback_error,callback)};MessageView.prototype.showOfflineMessageFeedback=function(callback){popup.reset();return this.show(this.config.feedback_offline,callback)};MessageView.prototype.destroy=function(){return _jq("#userlike-message-headline").text("")};return MessageView}(View);OfflineMessageView=function(superClass){extend1(OfflineMessageView,superClass);function OfflineMessageView(options){if(options==null){options={}}this.onKeyboardHide=bind(this.onKeyboardHide,this);this.onKeyboardShow=bind(this.onKeyboardShow,this);OfflineMessageView.__super__.constructor.call(this,options);this.screenshot=new Screenshot}OfflineMessageView.prototype.height=568;OfflineMessageView.prototype.el=function(){return _jq("#userlike-offline-message")};OfflineMessageView.prototype.showOfflineMessageSent=function(callback){popup.reset();return message_view.show(this.config.offline_message_response,callback)};OfflineMessageView.prototype.setupEventHandlers=function(){return _jq("#userlike-offline-message-submit").on("click",function(_this){return function(e){fsm.event("submitButton");_jq.event(e).preventDefault();return _jq.event(e).stopPropagation()}}(this))};OfflineMessageView.prototype.showOfflineMessageForm=function(callback){popup.reset();this.highlightText("#userlike-screenshot-label",this.config.offline_message_send_screenshot);_jq("#userlike-screenshot-label").text(this.config.offline_message_send_screenshot);popup.clearInput("#userlike-offline-email",this.config.offline_message_enter_email,session.get("client_email"));popup.clearInput("#userlike-offline-name",this.config.offline_message_enter_name,session.get("client_name"));popup.clearInput("#userlike-offline-textarea",this.config.offline_message_default_textarea,this.config.offline_message_default_textarea);this.setupEventHandlers();this.highlightText("#userlike-offline-message-headline",this.config.offline_message_header);this.highlightText("#userlike-offline-message-text",this.config.offline_message_body);_jq("#userlike-offline-message-headline").text(this.config.offline_message_header);_jq("#userlike-offline-message-text").text(this.config.offline_message_body);if(this.config.screenshot_enabled){_jq("#userlike-screenshot-wrapper").show()}else{_jq("#userlike-screenshot-wrapper").hide()}popup.transition(this,callback);if(is_mobile){onKeyboardStateChange(this.onKeyboardShow,this.onKeyboardHide);return _jq(document).on("focusout",this.onKeyboardHide)}};OfflineMessageView.prototype.onKeyboardShow=function(){if(getOrientation()==="landscape"){return _jq("#userlike").addClass("userlike-chat-textarea-fullscreen")}else{return _jq("#userlike").removeClass("userlike-chat-textarea-fullscreen")}};OfflineMessageView.prototype.onKeyboardHide=function(){return _jq("#userlike").removeClass("userlike-chat-textarea-fullscreen")};OfflineMessageView.prototype.setTextareaVal=function(text){var $t,current_text;$t=_jq("#userlike-offline-textarea");current_text=$t.val().replace(this.config.offline_message_default_textarea,"");return $t.val(current_text+text+"\n")};OfflineMessageView.prototype.appendTextareaVal=function(text){var $t;$t=_jq("#userlike-offline-textarea");return $t.val($t.val()+text+"\n")};OfflineMessageView.prototype.validateOfflineMessage=function(){var email,message,name;email=getInput("#userlike-offline-email");name=getInput("#userlike-offline-name");message=getInput("#userlike-offline-textarea");if(!Validator.validateName(name)){_jq("#userlike-offline-name").focus();return false}if(!Validator.validateEmail(email)){_jq("#userlike-offline-email").focus();return false}if(!message){_jq("#userlike-offline-textarea").focus();return false}if(message.length>1e4){_jq("#userlike-offline-textarea").focus();return false}session.set("client_email",email);session.set("client_name",name);return true};OfflineMessageView.prototype.requestedScreenshot=function(){return _jq("#userlike-screenshot-checkbox").get().checked};OfflineMessageView.prototype.sendOfflineMessage=function(){var custom,e,error,info,message,packet;message=getInput("#userlike-offline-textarea");_jq("#userlike-offline-textarea").val("");info=session.packet();try{custom=JSON.stringify(info.custom)}catch(error){e=error;custom=void 0}packet={chat_widget_id:this.config.chat_widget_id,customer_id:this.config.customer_id,client_name:info.client_name,client_email:info.client_email,visits:info.visits,page_impressions:info.page_impressions,url:info.url,message:message,custom:custom,latitude:session.get("latitude"),longitude:session.get("longitude")};_ullog("OfflineMessage::send");return _jq.ajaxJsonp({url:"https://api.userlike.com/api/client/message/offline_message/",data:packet,error:function(err){_ullog("OfflineMessage::sendError "+err);return fsm.event("error",err)},success:function(resp){_ullog("OfflineMessage::sendSuccess "+resp);return fsm.event("success",resp)}})};OfflineMessageView.prototype.takeOfflineScreenshot=function(){return this.screenshot.take(function(err){if(err){return fsm.event("screenshotError")}else{return fsm.event("screenshotTaken")}})};OfflineMessageView.prototype.sendOfflineScreenshot=function(id){return this.screenshot.attachToOfflineMessage(id,function(){return fsm.event("screenshotSent")})};OfflineMessageView.prototype.takeScreenshot=function(callback){return this.screenshot.take(function(err){if(err){return fsm.event("screenshotError",{callback:callback})}else{return fsm.event("screenshotTaken",{callback:callback})}})};OfflineMessageView.prototype.sendScreenshot=function(callback){return this.screenshot.sendToOperator(session.get("chat_meta_id"),function(err,url){if(err){return fsm.event("screenshotError",{callback:callback})}else{return fsm.event("screenshotSent",{callback:callback,url:url})}})};OfflineMessageView.prototype.destroy=function(){return _jq("#userlike-offline-message-submit").off("click")};return OfflineMessageView}(View);ProgressView=function(superClass){extend1(ProgressView,superClass);function ProgressView(){return ProgressView.__super__.constructor.apply(this,arguments)}ProgressView.prototype.height=216;ProgressView.prototype.el=function(){return _jq("#userlike-progress")};ProgressView.prototype.show=function(callback){if(!has_css_animation_support){_jq("#userlike-spinner-gif").show()}_jq("#userlike-close").on("click",this.onCloseClick);return popup.transition(this,callback)};ProgressView.prototype.onCloseClick=function(){return popup.hide()};ProgressView.prototype.destroy=function(){_jq("#userlike-close").off("click",this.onCloseClick);return ProgressView.__super__.destroy.call(this)};return ProgressView}(View);RegisterView=function(superClass){extend1(RegisterView,superClass);function RegisterView(){return RegisterView.__super__.constructor.apply(this,arguments)}RegisterView.prototype.height=568;RegisterView.prototype.el=function(){return _jq("#userlike-register")};RegisterView.prototype.setupEventHandlers=function(){_jq("#userlike-register-submit").on("click",function(_this){return function(e){fsm.event("submitButton");_jq.event(e).preventDefault();return _jq.event(e).stopPropagation()}}(this));return _jq("#userlike-facebook-connect-submit").on("click",function(_this){return function(e){FB.login(function(response){return fsm.event("facebookLoginResponse",response)},{scope:"email"});_jq.event(e).preventDefault();return _jq.event(e).stopPropagation()}}(this))};RegisterView.prototype.showRegisterFormFacebook=function(callback){_jq("#userlike-facebook-connect-submit").show();return this.show(callback)};RegisterView.prototype.showRegisterForm=function(callback){_jq("#userlike-facebook-connect-submit").hide();return this.show(callback)};RegisterView.prototype.show=function(callback){var j,len1,ref1;this.setupEventHandlers();popup.clearInput("#userlike-register-email",this.config.register_enter_email,session.get("client_email"));popup.clearInput("#userlike-register-name",this.config.register_enter_name,session.get("client_name"));this.highlightText("#userlike-register-headline",this.config.register_header);this.highlightText("#userlike-register-text",this.config.register_body);_jq("#userlike-register-headline").text(this.config.register_header);_jq("#userlike-register-text").text(this.config.register_body);ref1=[1,2,3];for(j=0,len1=ref1.length;j<len1;j++){i=ref1[j];if(this.config["register_additional0"+i+"_enabled"]){_jq("#userlike-register-additional0"+i).show();popup.clearInput("#userlike-register-additional0"+i,this.config["register_additional0"+i+"_default"],session.get("client_additional0"+i+"_value"))}else{_jq("#userlike-register-additional0"+i).hide()}}return popup.transition(this,callback)};RegisterView.prototype.validateRegisterForm=function(){var email,name,validateAdditional;validateAdditional=function(_this){return function(){var j,len1,ref1,value;ref1=[1,2,3];for(j=0,len1=ref1.length;j<len1;j++){i=ref1[j];if(_this.config["register_additional0"+i+"_enabled"]){value=getInput("#userlike-register-additional0"+i);if(!_this.config["register_additional0"+i+"_optional"]){if(!value||value.length>100){_jq("#userlike-register-additional0"+i).focus();return false}}if(_this.config["register_additional0"+i+"_optional"]){if(value&&value.length>100){_jq("#userlike-register-additional0"+i).focus();return false}}if(value){session.set("client_additional0"+i+"_value",value)}}}return true}}(this);name=getInput("#userlike-register-name");email=getInput("#userlike-register-email");if(this.config.optional_registration){if(!name&&!email){session["delete"]("client_name");session["delete"]("client_email")}else if(!email){session.set("client_name",name);session["delete"]("client_email")}else if(!Validator.validateEmail(email)){_jq("#userlike-register-email").focus();return false}else if(!Validator.validateName(name)){session["delete"]("client_name");session.set("client_email",email)}else{session.set("client_name",name);session.set("client_email",email)}}else{if(!Validator.validateName(name)){_jq("#userlike-register-name").focus();return false}if(!Validator.validateEmail(email)){_jq("#userlike-register-email").focus();return false}session.set("client_email",email);session.set("client_name",name)}return validateAdditional()};return RegisterView}(View);EmojiPopoverView=function(superClass){extend1(EmojiPopoverView,superClass);EmojiPopoverView.prototype.el_id="userlike-emoji-button";EmojiPopoverView.prototype.is_visible=false;EmojiPopoverView.prototype.textarea_caret_postion=null;EmojiPopoverView.prototype.template='<span style="cursor:pointer" data-code="$$code">\n  <div title="$$name" class="userlike-emoji userlike-emoji-$$class_name"></div>\n</span>';function EmojiPopoverView(options){if(options==null){options={}}this.onDocumentClick=bind(this.onDocumentClick,this);this.onEmojiClick=bind(this.onEmojiClick,this);this.onPopupButtonClick=bind(this.onPopupButtonClick,this);EmojiPopoverView.__super__.constructor.call(this,options);this.$el=_jq("#"+this.el_id);this.$el.on("click",this.onPopupButtonClick);this.$emoji_list=null}EmojiPopoverView.prototype.onPopupButtonClick=function(){if(this.is_visible){return this.hide()}else{return this.show()}};EmojiPopoverView.prototype.onEmojiClick=function(e){var clicked_emoji_code;e=_jq.event(e);clicked_emoji_code=_jq(e.target).parent().data("code");if(clicked_emoji_code==null){return}_jq("#userlike-chat-textarea").val(function(_this){return function(chatMessage){var chat_message_trimmed,emoji_code_whitespaced,text_with_emoji;chat_message_trimmed=chatMessage.replace(_this.config.default_textarea,"");emoji_code_whitespaced=" "+clicked_emoji_code+" ";text_with_emoji=insertStringAtIndex(chat_message_trimmed,_this.textarea_caret_postion,emoji_code_whitespaced);_this.textarea_caret_postion+=emoji_code_whitespaced.length;return text_with_emoji}}(this));return this.hide()};EmojiPopoverView.prototype.onDocumentClick=function(e){var $drag_container,$target;e=_jq.event(e);$target=_jq(e.target);$drag_container=_jq(".userlike-drag");if(!$target.contains(this.$emoji_list)&&!$target.contains(this.$el)&&!$target.hasClass("userlike-drag")){return this.hide()}};EmojiPopoverView.prototype.show=function(){this.textarea_caret_postion=document.querySelector("#userlike-chat-textarea").selectionStart;if(this.$emoji_list!=null){_jq("#userlike-emoji-list").addClass("show")}else{this.compileTemplate();_jq("#userlike-chat-scroll-textarea").append(this.$emoji_list);applyTheme(null,"#userlike-chat-scroll-textarea");_jq("#userlike-emoji-list .userlike-emoji").on("click",this.onEmojiClick)}_jq(document).on("click",this.onDocumentClick);return this.is_visible=true};EmojiPopoverView.prototype.hide=function(){_jq("#userlike-emoji-list").removeClass("show");_jq("#userlike-chat-textarea").focus();document.querySelector("#userlike-chat-textarea").selectionStart=this.textarea_caret_postion;document.querySelector("#userlike-chat-textarea").selectionEnd=this.textarea_caret_postion;_jq(document).off("click",this.onDocumentClick);return this.is_visible=false};EmojiPopoverView.prototype.compileTemplate=function(){var class_name,emoji,emoji_list,j,len1,list_markup;emoji_list=document.createElement("div");emoji_list.id="userlike-emoji-list";emoji_list.className="show userlike-theme-bg userlike-theme-window-bg-color";list_markup="";for(j=0,len1=UL_EMOTICONS.length;j<len1;j++){emoji=UL_EMOTICONS[j];class_name=emoji.image.substr(0,emoji.image.indexOf(".png"));list_markup+=this.template.replace("$$code",emoji.code).replace("$$name",emoji.name).replace("$$class_name",class_name)}emoji_list.innerHTML=list_markup;this.$emoji_list=_jq(emoji_list);return this.$emoji_list};return EmojiPopoverView}(View);SurveyView=function(superClass){extend1(SurveyView,superClass);function SurveyView(){return SurveyView.__super__.constructor.apply(this,arguments)}SurveyView.prototype.el=function(){return _jq("#userlike-survey")};SurveyView.prototype.show=function(prefix,callback){var $userlikeSurvey;$userlikeSurvey=this.el();this.highlightText("#userlike-survey-headline",this.config[prefix+"_survey_question"]);_jq("#userlike-survey-headline").text(this.config[prefix+"_survey_question"]);$userlikeSurvey.find(".userlike-fieldset-wrapper>div").each(function(_this){return function(i,el){var $el,ref1;$el=_jq(el);if((ref1=_this.config[prefix+"_survey_option0"+(i+1)])!=null?ref1.length:void 0){_this.highlightText($el.find(".userlike-label"),_this.config[prefix+"_survey_option0"+(i+1)]);$el.find(".userlike-label").text(_this.config[prefix+"_survey_option0"+(i+1)]);$el.find("input").removeAttr("checked");return $el.show()}else{return $el.hide()}}}(this));return popup.transition(this,callback)};SurveyView.prototype.showPreSurvey=function(callback){return this.show("pre",callback)};SurveyView.prototype.showPostSurvey=function(callback){return this.show("post",callback)};SurveyView.prototype.destroy=function(){this.el().find(".userlike-label").text("");return this.el().find("#userlike-survey-headline").text("")};return SurveyView}(View);TranscriptView=function(superClass){extend1(TranscriptView,superClass);function TranscriptView(){return TranscriptView.__super__.constructor.apply(this,arguments)}TranscriptView.prototype.el=function(){return _jq("#userlike-transcript")};TranscriptView.prototype.setupEventHandlers=function(){return _jq("#userlike-transcript-submit").on("click",function(_this){return function(e){fsm.event("submitButton");_jq.event(e).preventDefault();return _jq.event(e).stopPropagation()}}(this))};TranscriptView.prototype.show=function(callback){this.setupEventHandlers();popup.clearInput("#userlike-transcript-email",this.config.register_enter_email,session.get("client_email"));_jq("#userlike-transcript-headline").text(this.config.transcript_header);_jq("#userlike-transcript-text").text(this.config.transcript_body);return popup.transition(this,callback)};TranscriptView.prototype.validateTranscriptForm=function(){var email;email=getInput("#userlike-transcript-email");if(!Validator.validateEmail(email)){_jq("#userlike-transcript-email").focus();return false}session.set("client_email",email);return true};TranscriptView.prototype.destroy=function(){return _jq("#userlike-transcript-submit").off("click")};return TranscriptView}(View);WidgetGoal=function(){function WidgetGoal(){}WidgetGoal.prototype.check=function(){var j,len1,ref1,ref2,results1,target;if(!config.goals.length){return _ullog("WidgetGoal::check no goals")}else{ref1=config.goals;results1=[];for(j=0,len1=ref1.length;j<len1;j++){target=ref1[j];_ullog("WidgetGoal::check "+target.url+" == "+document.location.href);if(((ref2=document.location.href)!=null?ref2.indexOf(target.url):void 0)>-1){_ullog("WidgetGoal::check match "+target.url);if(session.get("uuid")&&!session.getGoal(target.key)){session.setGoal(target.key);session.set("goal",target.name);this.send(target);fsm.event("goalReached")}break}else{results1.push(void 0)}}return results1}};WidgetGoal.prototype.send=function(target){var img,url;url="//api.userlike.com/api/client/goal/";url+="?chat_meta_id="+encodeURIComponent(session.get("chat_meta_id"));url+="&customer_id="+encodeURIComponent(config.customer_id);url+="&goal_key="+encodeURIComponent(target.key);url+="&_="+ +new Date;_ullog("WidgetGoal::send "+url);img=document.createElement("img");img.setAttribute("src",url);img.setAttribute("width",1);img.setAttribute("height",1);return document.body.appendChild(img)};return WidgetGoal}();Rating=function(){
function Rating(){}Rating.prototype.send=function(rate){var data,url;url="//api.userlike.com/api/client/rate/";_ullog("Rating::send "+url);data={operator_id:session.get("operator_id"),customer_id:config.customer_id,chat_meta_id:session.get("chat_meta_id"),session_id:session.get("id"),rate:rate};return _jq.ajaxJsonp({url:url,data:data,error:function(err){return _ullog("Rating::sendError "+err)},success:function(resp){return _ullog("Rating::sendSuccess "+resp)}})};return Rating}();Survey=function(){function Survey(){}Survey.prototype.send=function(option,index){var data,url;url="//api.userlike.com/api/client/survey/";_ullog("Survey::send "+url);data={operator_id:session.get("operator_id"),customer_id:config.customer_id,chat_meta_id:session.get("chat_meta_id"),option:option,index:index};return _jq.ajaxJsonp({url:url,data:data,error:function(err){return _ullog("Survey::sendError "+err)},success:function(resp){return _ullog("Survey::sendSuccess "+resp)}})};return Survey}();Slot=function(){function Slot(){this.socket=null;this.requests=[];this.queue_timer=null;this.cache=null;this.timer=null}Slot.prototype.resetCache=function(){_ullog("Slot::resetCache");return this.cache=null};Slot.prototype.setCache=function(data){_ullog("Slot::setCache data=",data);this.cache=data;clearTimeout(this.timer);return this.timer=setTimeout(function(_this){return function(){return _this.resetCache()}}(this),15*1e3)};Slot.prototype.checkCache=function(callback){if(this.cache){_ullog("Slot::checkCache found callback="+callback+" data=",this.cache);eval(callback)(this.cache);return true}return false};Slot.prototype.checkButton=function(jsonp_callback){if(this.checkCache(jsonp_callback)){return}return Loader.loadScript("api.userlike.com/api/chat/button/check/?customer_id="+config.customer_id+"&chat_widget_id="+config.chat_widget_id+"&callback="+jsonp_callback,function(){})};Slot.prototype.checkAvailable=function(jsonp_callback){if(this.checkCache(jsonp_callback)){return}return Loader.loadScript("api.userlike.com/api/chat/slot/available/?customer_id="+config.customer_id+"&chat_widget_id="+config.chat_widget_id+"&callback="+jsonp_callback,function(){})};Slot.prototype.checkProactive=function(jsonp_callback){var operator_id;operator_id=session.getOperatorBinding(config.operator_group_id);if(operator_id){return Loader.loadScript("api.userlike.com/api/chat/slot/proactive/?customer_id="+config.customer_id+"&chat_widget_id="+config.chat_widget_id+"&operator_id="+operator_id+"&operator_group_id="+config.operator_group_id+"&callback="+jsonp_callback,function(){})}else{return Loader.loadScript("api.userlike.com/api/chat/slot/proactive/?customer_id="+config.customer_id+"&chat_widget_id="+config.chat_widget_id+"&operator_group_id="+config.operator_group_id+"&callback="+jsonp_callback,function(){})}};Slot.prototype.checkPassiveConnect=function(jsonp_callback){var group_select_id,operator_id;group_select_id=session.get("group_select_id");if(group_select_id){return Loader.loadScript("api.userlike.com/api/chat/slot/passive/?customer_id="+config.customer_id+"&chat_widget_id="+config.chat_widget_id+"&operator_group_id="+group_select_id+"&callback="+jsonp_callback,function(){})}else{operator_id=session.getOperatorBinding(config.operator_group_id);if(operator_id){return Loader.loadScript("api.userlike.com/api/chat/slot/passive/?customer_id="+config.customer_id+"&chat_widget_id="+config.chat_widget_id+"&operator_id="+operator_id+"&operator_group_id="+config.operator_group_id+"&callback="+jsonp_callback,function(){})}else{return Loader.loadScript("api.userlike.com/api/chat/slot/passive/?customer_id="+config.customer_id+"&chat_widget_id="+config.chat_widget_id+"&operator_group_id="+config.operator_group_id+"&callback="+jsonp_callback,function(){})}}};Slot.prototype.checkSlotStats=function(callback){var jsonp_callback;jsonp_callback="userlikeCallback"+ +new Date;window[jsonp_callback]=function(data){return callback(data)};return Loader.loadScript("api.userlike.com/api/chat/slot/stats/?customer_id="+config.customer_id+"&chat_widget_id="+config.chat_widget_id+"&callback="+jsonp_callback,function(){})};Slot.prototype.checkOperatorStatus=function(callback){var jsonp_callback;jsonp_callback="userlikeCallbackOperatorStatus";window[jsonp_callback]=function(data){return callback(data)};return Loader.loadScript("api.userlike.com/api/chat/operator/status/?customer_id="+config.customer_id+"&callback="+jsonp_callback,function(){})};Slot.prototype.sendTranscript=function(callback){var jsonp_callback;jsonp_callback="userlikeCallbackSendTranscript";Loader.loadScript("api.userlike.com/api/client/message/chat_meta/email/?customer_id="+config.customer_id+"&chat_meta_id="+session.get("chat_meta_id")+"&client_email="+encodeURIComponent(session.get("client_email"))+"&client_uuid="+encodeURIComponent(session.get("uuid"))+"&callback="+jsonp_callback,function(){});return window[jsonp_callback]=function(data){return callback(data)}};Slot.prototype.create=function(data){var packet;if(data.operator_group_id){packet={customer_id:config.customer_id,chat_widget_id:config.chat_widget_id,operator_group_id:data.operator_group_id,proactive:false,info:session.packet()}}else{packet={customer_id:config.customer_id,chat_widget_id:config.chat_widget_id,operator_id:session.getOperatorBinding(config.operator_group_id),operator_group_id:config.operator_group_id,info:session.packet(),proactive:data.proactive}}return this.queue("emit","create",packet,function(resp){return fsm.event("slotCreated",resp)})};Slot.prototype.direct=function(data){var packet;packet={customer_id:config.customer_id,chat_widget_id:config.chat_widget_id,operator_id:data.operator_id,info:session.packet(),operator_group_id:config.operator_group_id,proactive:false};return this.queue("emit","direct",packet,function(resp){return fsm.event("slotCreated",resp)})};Slot.prototype.reconnect=function(callback){var packet;packet={id:session.get("id"),info:session.packet()};return this.queue("emit","reconnect",packet,function(resp){return fsm.event("slotReconnceted",resp)})};Slot.prototype["switch"]=function(callback){var packet;packet={id:session.get("id"),info:session.packet()};return this.queue("emit","switch",packet,function(resp){return fsm.event("slotSwitched",resp)})};Slot.prototype.playback=function(){return this.queue("emit","playback",null,function(data){return fsm.event("slotPlayback",data)})};Slot.prototype.urlinfo=function(url,callback){return this.queue("emit","urlinfo",url,function(data){return callback(data)})};Slot.prototype.wakeup=function(){var packet;packet={id:session.get("id"),info:session.packet()};return this.queue("emit","wakeup",packet,function(data){return fsm.event("wakeupDone",data)})};Slot.prototype.disconnect=function(){var e,error;_ullog("Slot::disconnect");clearInterval(this.queue_timer);if(this.socket){try{this.socket.removeAllListeners("disconnect");this.socket.removeAllListeners("connect");this.socket.removeAllListeners("connecting");this.socket.removeAllListeners("reconnect");this.socket.removeAllListeners("reconnecting");this.socket.disconnect()}catch(error){e=error;_ullog("Slot::disconnect raised an exception ",e)}return delete this.socket}};Slot.prototype.queue=function(func,command,data,callback){return this.requests.push([func,command,data,callback])};Slot.prototype.emit=function(name,data,callback){return this.socket.emit(name,data,callback)};Slot.prototype.connect=function(){var e,error,port,transport;try{if(_jq.browser.msie&&parseInt(_jq.browser.version)<9){transport="jsonp-polling"}else{transport="xhr-polling"}port="443";this.socket=userlikeIO.connect("https://chat.userlike.com",{resource:"chat","connect timeout":5e3,reconnect:true,"reconnection delay":100,"reconnection limit":1e3,"max reconnection attempts":120,"force new connection":true,"sync disconnect on unload":true,"try multiple transports":false,transports:[transport],port:port},_ullog("Slot:connect transport="+transport+" port="+port))}catch(error){e=error;_ullog("Slot::connect raised an exception ",e);fsm.signal("error");return}this.queue_timer=setInterval(function(_this){return function(){var r;if(_this.requests.length){r=_this.requests.shift();return _this[r[0]](r[1],r[2],r[3])}}}(this),100);this.socket.on("error",function(){return fsm.signal("error")});this.socket.on("connect",function(){return fsm.signal("connect")});this.socket.on("connecting",function(transport){return fsm.signal("connecting",transport)});this.socket.on("connect_failed",function(){return fsm.signal("connectFailed")});this.socket.on("disconnect",function(){return fsm.signal("disconnect")});this.socket.on("reconnect",function(){return fsm.signal("reconnect")});this.socket.on("reconnecting",function(delay,count){return fsm.signal("reconnecting",{delay:delay,count:count})});this.socket.on("reconnect_failed",function(_this){return function(){return fsm.signal("reconnectFailed")}}(this));this.socket.on("message",function(data){return fsm.event("receiveMessage",data)});this.socket.on("composing",function(data){return fsm.event("receiveComposing",data)});this.socket.on("paused",function(data){return fsm.event("receivePaused",data)});this.socket.on("block",function(){return fsm.signal("receiveBlock")});this.socket.on("replace",function(data){return fsm.event("receiveReplaceText",data)});this.socket.on("name",function(data){return fsm.event("receiveName",data)});this.socket.on("email",function(data){return fsm.event("receiveEmail",data)});this.socket.on("additional",function(data){return fsm.event("receiveAdditional",data)});this.socket.on("offline",function(data){return fsm.signal("receiveOffline")});this.socket.on("inactive",function(data){return fsm.event("receiveInactive")});this.socket.on("operator_disconnect",function(data){return fsm.signal("receiveOperatorDisconnect")});this.socket.on("operator_reconnect",function(data){return fsm.signal("receiveOperatorReconnect")});this.socket.on("quit",function(){return fsm.signal("receiveQuit")});this.socket.on("switch",function(){return fsm.signal("receiveSwitch")});this.socket.on("screenshot",function(_this){return function(data,callback){return fsm.signal("receiveScreenshot",callback)}}(this));this.socket.on("slot",function(_this){return function(data){return fsm.signal("receiveSlot",data)}}(this));this.socket.on("forward",function(_this){return function(data){return fsm.signal("receiveForward",data)}}(this));this.socket.on("push",function(_this){return function(data,callback){data.callback=callback;return fsm.event("receivePush",data)}}(this));this.socket.on("download",function(_this){return function(data){return fsm.event("receiveDownload",data)}}(this));return this.socket.on("hibernate",function(_this){return function(){return fsm.signal("receiveHibernate")}}(this))};return Slot}();Singleton=function(){var instance;function Singleton(){}instance=null;Singleton.get=function(){if(this.instance==null){this.instance=new this}return this.instance};return Singleton}();App=function(superClass){extend1(App,superClass);function App(){return App.__super__.constructor.apply(this,arguments)}App.prototype.run=function(app_key,widget_key,data){fsm=new FSM;return fsm.start({app_key:app_key,widget_key:widget_key,config:unpack(data)})};return App}(Singleton);this.userlikeInit=function(app_key,widget_key,data){return App.get().run(app_key,widget_key,data)};this.userlikeMonitorGoal=function(){return goal!=null?goal.check():void 0};this.userlikeQuitChat=function(){return fsm.event("receiveQuit")};this.userlikeStartChat=function(e){fsm.event("chatButton");if(e!=null){return _jq.event(e).preventDefault()}};this.userlikeChatButton=function(e){fsm.event("chatButton");if(e!=null){return _jq.event(e).preventDefault()}};this.userlikeCloseButton=function(e){fsm.event("closeButton");if(e!=null){return _jq.event(e).preventDefault()}};this.userlikeUpdateAPI=function(){return session!=null?session.updateUserData():void 0};this.userlikePushState=function(){return fsm.event("pushstate")};this.userlikeInputEnter=function(e){fsm.event("inputEnter");if(e!=null){return _jq.event(e).preventDefault()}};this.userlikeCheckOperatorStatus=function(callback){return slot.checkOperatorStatus(callback)};this.userlikeCheckSlotStats=function(callback){return slot.checkSlotStats(callback)};this.userlikeRequestOperatorChat=function(operator_id){return fsm.event("directRequest",operator_id)};this.userlikeChatState=function(){return session.getState()};this.userlikeSendEvent=function(name,data){return fsm.event(name,data)};this.userlikeDeleteCookies=function(){Storage.memory.removeAllItems();Storage.localStorage.removeAllItems();Cookies.remove("uslk_e");Cookies.remove("uslk_s");userlikeEnableDebug();return window.location.reload()};this.userlikeResetState=function(){session.setState("");session.yieldConfig();return window.location.reload()};this.userlikeGetFsmStateName=function(){return fsm.state.getName()};this.userlikeIsFsmStateFrozen=function(){return fsm.freeze};this.userlikeEnableDebug=function(){return session.set("debug",true)};this.userlikeDisableDebug=function(){return session.set("debug",false)};this.userlikeEnableNoState=function(){return window.userlike.nostate=true};this.userlikeDisableNoState=function(){return window.userlike.nostate=false};this.userlikeRemoteApiModeNormal=function(){return fsm.event("normal")};this.userlikeRemoteApiModeProactivePassive=function(timeout,message){return fsm.event("proactive_passive",{timeout:timeout,message:message})};this.userlikeRemoteApiModeProactiveActive=function(timeout,message){_ullog("####################################################################");_ullog("# WARNING: userlikeRemoteApiModeProactiveActive is deprecated");_ullog("####################################################################");return fsm.event("proactive_passive",{timeout:timeout,message:message})};this.userlikeRemoteApiModeProactivePassiveAndRegister=function(timeout,message){return fsm.event("proactive_passive_register",{timeout:timeout,message:message})};this.userlikeRemoteApiModeProactiveActiveAndRegister=function(timeout,message){_ullog("####################################################################");_ullog("# WARNING: userlikeRemoteApiModeProactiveActiveAndRegister is deprecated");_ullog("####################################################################");return fsm.event("proactive_passive_register",{timeout:timeout,message:message})};this.userlikeRemoteApiModeRegister=function(){return fsm.event("register")};this.userlikeRemoteApiResetState=function(){return fsm.event("reset")};this.userlikeFacebookLoginCallback=function(response){return fsm.event("facebookLoginResponse",response)};this.userlikeSelectValue=function(v){return fsm.event("select",v)};this.userlikeDebugViews=function(){return typeof userlikePreview!=="undefined"&&userlikePreview!==null?userlikePreview.cycleView():void 0};this.userlikeTesting={BackendMemory:BackendMemory,BackendLocalStorage:BackendLocalStorage,BackendCookie:BackendCookie,BackendSessionCookie:BackendSessionCookie,BackendContainerCookie:BackendContainerCookie,BackendSessionContainerCookie:BackendSessionContainerCookie,BackendExpireContainerCookie:BackendExpireContainerCookie,BackendExpireCookie:BackendExpireCookie,SessionFactory:SessionFactory,Storage:Storage,Session:Session,SessionStorage:SessionStorage,SessionStoragePrivacy:SessionStoragePrivacy,Cookies:Cookies,fsm:fsm,config:config};this.userlikeDebugLivePreview=function(){var _,val;val="a";_=function(){val=val+"a";fsm.event("livePreview",val);if(val.length<20){return setTimeout(_,1e3)}else{return fsm.event("sendMessage",val)}};return _()};TrackingFactory=function(){function TrackingFactory(widget){this.widget=widget}TrackingFactory.prototype.get=function(client){_ullog("TrackingFactory type="+config.tracking);if(config.tracking==="ga"){return new TrackingGoogleComposite(client)}else if(config.tracking==="piwik"){return new TrackingPiwik(client)}else if(config.tracking==="kissmetr"){return new TrackingKissMetrics(client)}else if(config.tracking==="mixpanel"){return new TrackingMixpanel(client)}else{return new TrackingDummy}};return TrackingFactory}();TrackingDummy=function(){function TrackingDummy(){}TrackingDummy.prototype.sendOfflineMessage=function(){};TrackingDummy.prototype.offerProactiveChat=function(){};TrackingDummy.prototype.sendMessage=function(){};TrackingDummy.prototype.receiveMessage=function(){};TrackingDummy.prototype.startSlot=function(){};TrackingDummy.prototype.startProactiveSlot=function(){};return TrackingDummy}();TrackingGoogleComposite=function(superClass){extend1(TrackingGoogleComposite,superClass);function TrackingGoogleComposite(client){this.trackers=[new TrackingGA(client),new TrackingGAUniversal(client)]}TrackingGoogleComposite.prototype._executeTrackingFunction=function(trackingFunctionName){var j,len1,ref1,results1,tracker;ref1=this.trackers;results1=[];for(j=0,len1=ref1.length;j<len1;j++){tracker=ref1[j];results1.push(tracker[trackingFunctionName]())}return results1};TrackingGoogleComposite.prototype.sendOfflineMessage=function(){return this._executeTrackingFunction("sendOfflineMessage")};TrackingGoogleComposite.prototype.offerProactiveChat=function(){return this._executeTrackingFunction("offerProactiveChat")};TrackingGoogleComposite.prototype.sendMessage=function(){return this._executeTrackingFunction("sendMessage")};TrackingGoogleComposite.prototype.receiveMessage=function(){return this._executeTrackingFunction("receiveMessage")};TrackingGoogleComposite.prototype.startSlot=function(){return this._executeTrackingFunction("startSlot")};TrackingGoogleComposite.prototype.startProactiveSlot=function(){return this._executeTrackingFunction("startProactiveSlot")};return TrackingGoogleComposite}(TrackingDummy);TrackingGA=function(superClass){extend1(TrackingGA,superClass);function TrackingGA(){return TrackingGA.__super__.constructor.apply(this,arguments)}TrackingGA.prototype.sendOfflineMessage=function(){return typeof _gaq!=="undefined"&&_gaq!==null?_gaq.push(["_trackEvent","Userlike_Chat","Offline_message_sent",""]):void 0};TrackingGA.prototype.offerProactiveChat=function(){return typeof _gaq!=="undefined"&&_gaq!==null?_gaq.push(["_trackEvent","Userlike_Chat","Proactive_chat_offered_to_webuser","Operator_"+session.get("operator_name")]):void 0};TrackingGA.prototype.sendMessage=function(){return typeof _gaq!=="undefined"&&_gaq!==null?_gaq.push(["_trackEvent","Userlike_Chat","Webuser_sent_message","Operator_"+session.get("operator_name")]):void 0};TrackingGA.prototype.receiveMessage=function(){return typeof _gaq!=="undefined"&&_gaq!==null?_gaq.push(["_trackEvent","Userlike_Chat","Webuser_received_message","Operator_"+session.get("operator_name")]):void 0};TrackingGA.prototype.startSlot=function(){return typeof _gaq!=="undefined"&&_gaq!==null?_gaq.push(["_trackEvent","Userlike_Chat","Chat_session_started","Operator_"+session.get("operator_name")]):void 0};TrackingGA.prototype.startProactiveSlot=function(){return typeof _gaq!=="undefined"&&_gaq!==null?_gaq.push(["_trackEvent","Userlike_Chat","Proactive_chat_session_started","Operator_"+session.get("operator_name")]):void 0};return TrackingGA}(TrackingDummy);TrackingGAUniversal=function(superClass){extend1(TrackingGAUniversal,superClass);function TrackingGAUniversal(){return TrackingGAUniversal.__super__.constructor.apply(this,arguments)}TrackingGAUniversal.prototype.sendOfflineMessage=function(){return typeof ga==="function"?ga("send","event","Userlike_Chat","Offline_message_sent",""):void 0};TrackingGAUniversal.prototype.offerProactiveChat=function(){return typeof ga==="function"?ga("send","event","Userlike_Chat","Proactive_chat_offered_to_webuser","Operator_"+session.get("operator_name")):void 0};TrackingGAUniversal.prototype.sendMessage=function(){return typeof ga==="function"?ga("send","event","Userlike_Chat","Webuser_sent_message","Operator_"+session.get("operator_name")):void 0};TrackingGAUniversal.prototype.receiveMessage=function(){return typeof ga==="function"?ga("send","event","Userlike_Chat","Webuser_received_message","Operator_"+session.get("operator_name")):void 0};TrackingGAUniversal.prototype.startSlot=function(){return typeof ga==="function"?ga("send","event","Userlike_Chat","Chat_session_started","Operator_"+session.get("operator_name")):void 0};TrackingGAUniversal.prototype.startProactiveSlot=function(){return typeof ga==="function"?ga("send","event","Userlike_Chat","Proactive_chat_session_started","Operator_"+session.get("operator_name")):void 0};return TrackingGAUniversal}(TrackingDummy);TrackingPiwik=function(superClass){extend1(TrackingPiwik,superClass);function TrackingPiwik(){return TrackingPiwik.__super__.constructor.apply(this,arguments)}TrackingPiwik.prototype.sendOfflineMessage=function(){if(typeof _paq!=="undefined"&&_paq!==null){_paq.push(["setCustomVariable",1,"Offline_message_sent",""])}return typeof _paq!=="undefined"&&_paq!==null?_paq.push(["trackPageView"]):void 0};TrackingPiwik.prototype.offerProactiveChat=function(){if(typeof _paq!=="undefined"&&_paq!==null){_paq.push(["setCustomVariable",2,"Proactive_chat_offered_to_webuser","Operator_"+session.get("operator_name")])}return typeof _paq!=="undefined"&&_paq!==null?_paq.push(["trackPageView"]):void 0};TrackingPiwik.prototype.startProactiveSlot=function(){if(typeof _paq!=="undefined"&&_paq!==null){_paq.push(["setCustomVariable",3,"Proactive_chat_session_started","Operator_"+session.get("operator_name")])}return typeof _paq!=="undefined"&&_paq!==null?_paq.push(["trackPageView"]):void 0};TrackingPiwik.prototype.startSlot=function(){if(typeof _paq!=="undefined"&&_paq!==null){_paq.push(["setCustomVariable",4,"Chat_session_started","Operator_"+session.get("operator_name")])}return typeof _paq!=="undefined"&&_paq!==null?_paq.push(["trackPageView"]):void 0};TrackingPiwik.prototype.sendMessage=function(){};TrackingPiwik.prototype.receiveMessage=function(){};return TrackingPiwik}(TrackingDummy);TrackingKissMetrics=function(superClass){extend1(TrackingKissMetrics,superClass);function TrackingKissMetrics(){if(typeof _kmq!=="undefined"&&_kmq!==null){_kmq.push(["identify",session.get("uuid")])}}TrackingKissMetrics.prototype.sendOfflineMessage=function(){return typeof _kmq!=="undefined"&&_kmq!==null?_kmq.push(["record","Userlike_Chat",{action:"Offline_message_sent",operator:""}]):void 0};TrackingKissMetrics.prototype.offerProactiveChat=function(){return typeof _kmq!=="undefined"&&_kmq!==null?_kmq.push(["record","Userlike_Chat",{action:"Proactive_chat_offered_to_webuser",operator:session.get("operator_name")}]):void 0};TrackingKissMetrics.prototype.startProactiveSlot=function(){return typeof _kmq!=="undefined"&&_kmq!==null?_kmq.push(["record","Userlike_Chat",{action:"Proactive_chat_session_started",operator:session.get("operator_name")}]):void 0};TrackingKissMetrics.prototype.startSlot=function(){return typeof _kmq!=="undefined"&&_kmq!==null?_kmq.push(["record","Userlike_Chat",{action:"Chat_session_started",operator:session.get("operator_name")}]):void 0};TrackingKissMetrics.prototype.sendMessage=function(){return typeof _kmq!=="undefined"&&_kmq!==null?_kmq.push(["record","Userlike_Chat",{action:"Webuser_sent_message",operator:session.get("operator_name")}]):void 0};TrackingKissMetrics.prototype.receiveMessage=function(){return typeof _kmq!=="undefined"&&_kmq!==null?_kmq.push(["record","Userlike_Chat",{action:"Webuser_received_message",operator:session.get("operator_name")}]):void 0};return TrackingKissMetrics}(TrackingDummy);TrackingMixpanel=function(superClass){extend1(TrackingMixpanel,superClass);function TrackingMixpanel(){if(typeof mixpanel!=="undefined"&&mixpanel!==null){mixpanel.identify(session.get("uuid"))}}TrackingMixpanel.prototype.sendOfflineMessage=function(){return typeof mixpanel!=="undefined"&&mixpanel!==null?mixpanel.track("Userlike_Chat",{action:"Offline_message_sent",operator:""}):void 0};TrackingMixpanel.prototype.offerProactiveChat=function(){return typeof mixpanel!=="undefined"&&mixpanel!==null?mixpanel.track("Userlike_Chat",{action:"Proactive_chat_offered_to_webuser",operator:session.get("operator_name")}):void 0};TrackingMixpanel.prototype.startProactiveSlot=function(){return typeof mixpanel!=="undefined"&&mixpanel!==null?mixpanel.track("Userlike_Chat",{action:"Proactive_chat_session_started",operator:session.get("operator_name")}):void 0};TrackingMixpanel.prototype.startSlot=function(){return typeof mixpanel!=="undefined"&&mixpanel!==null?mixpanel.track("Userlike_Chat",{action:"Chat_session_started",operator:session.get("operator_name")}):void 0};TrackingMixpanel.prototype.sendMessage=function(){return typeof mixpanel!=="undefined"&&mixpanel!==null?mixpanel.track("Userlike_Chat",{action:"Webuser_sent_message",operator:session.get("operator_name")}):void 0};TrackingMixpanel.prototype.receiveMessage=function(){return typeof mixpanel!=="undefined"&&mixpanel!==null?mixpanel.track("Userlike_Chat",{action:"Webuser_received_message",operator:session.get("operator_name")}):void 0};return TrackingMixpanel}(TrackingDummy);TrackingEvent=function(){function TrackingEvent(){}TrackingEvent.prototype.events_chat={rating_show:true,rating_cancel:true,rating_submit:true,feedback_show:true,feedback_cancel:true,feedback_submit:true,post_survey_show:true,post_survey_cancel:true,post_survey_submit:true,facebook_like_show:true,facebook_like_cancel:true,twitter_tweet_show:true,twitter_tweet_tweeted:true,twitter_tweet_cancel:true,chat_connected:true,chat_connected_proactive:true,chat_started:true,chat_started_proactive:true,chat_quit:true,chat_window_minimzed:true,chat_window_maximized:true,chat_reconnect:true,message_operator_terminating:true,message_client_terminating:true,message_client_terminating_first:true,proactive_offer:true,proactive_reject:true};TrackingEvent.prototype.events={chat_passive_connect:true,register_show:true,register_cancel:true,register_submit:true,group_select_show:true,group_select_cancel:true,group_select_submit:true,pre_survey_show:true,pre_survey_cancel:true,pre_survey_submit:true,button_hidden:true,button_displayed:true,chat_requested:true,proactive_timer:true,proactive_unavailable:true,slot_check:true,slot_available:true,slot_unavailable:true,slot_connect:true,error_message:true,offline_mode:true,offline_form_show:true,offline_view_show:true,offline_form_submit:true,facebook_login_timeout:true,facebook_login_status_response:true,facebook_login_success:true,facebook_login_failure:true,facebook_me_response:true,window_visible:true,window_invisible:true};TrackingEvent.prototype.globalCTX=function(){var global_ctx;global_ctx={widget_id:config.chat_widget_id,widget_lang:config.lang,operator_group_id:config.operator_group_id,client_uuid:session.get("uuid")};return global_ctx};TrackingEvent.prototype.sessionCTX=function(name){var session_ctx;session_ctx={client_name:session.get("client_name"),client_email:session.get("client_email"),session_id:session.get("id"),chat_id:void 0,custom_data:(typeof userlikeData!=="undefined"&&userlikeData!==null?userlikeData.custom:void 0)!=null,duration:session.getChatDuration(),operator_id:void 0,operator_name:void 0};if(this.events_chat[name]!=null){session_ctx.operator_id=session.get("operator_id");session_ctx.operator_name=session.get("operator_name");session_ctx.chat_id=session.get("chat_meta_id")}return session_ctx};TrackingEvent.prototype.trigger=function(name){var e,error;if(typeof userlikeTrackingEvent!=="function"){return}try{return userlikeTrackingEvent(name,this.globalCTX(),session.addAdditionalRegisterValues(this.sessionCTX(name)))}catch(error){e=error;return _ullog("TrackingEvent::trigger exception=",e)}};return TrackingEvent}();window.userlikePreview=userlikePreview=function(){function userlikePreview(){}userlikePreview.has_registered_events=false;userlikePreview.current_view_index=-1;userlikePreview.last_config={};userlikePreview.view_functions=["showChat","showOfflineMessageForm","showRegister","showPreSurvey","showGroupSelect","showPostSurvey","showFeedbackRatingComposite","showTranscript","showDisclaimer","showTransfer","showProgress","showError","showButton"];userlikePreview.init=function(options){if(userlikePreview!=null){userlikePreview.registerEvents()}if(userlikePreview!=null){userlikePreview.setUIState()}if(userlikePreview!=null){userlikePreview.setOperatorInfo(options)}return userlikePreview!=null?userlikePreview.last_config=_jq.extend({},config,options):void 0};userlikePreview.setOperatorInfo=function(options){if(userlikePreview!=null){userlikePreview.operator_display_name=options.operator_display_name}return userlikePreview!=null?userlikePreview.operator_url_image=options.operator_url_image:void 0};userlikePreview.start=function(){var is_in_valid_state,j,len1,state,states_preview_can_start_in;is_in_valid_state=false;states_preview_can_start_in=[Idle,PreviewState,Offline,ProactiveSlotReject];for(j=0,len1=states_preview_can_start_in.length;j<len1;j++){state=states_preview_can_start_in[j];if(fsm.state instanceof state){is_in_valid_state=true}}if(is_in_valid_state){if(!this.isActive()){fsm.next(PreviewState)}if(userlikePreview!=null){userlikePreview.setUIState()}userlikePreview.resetPosition();return true}else{_ullog("userlikePreview::start: Cannot start preview, not in Idle mode");return false}};userlikePreview.resetPosition=function(){var ref1,ref2;return popup!=null?(ref1=popup.position)!=null?(ref2=ref1.drag)!=null?ref2.snap=true:void 0:void 0:void 0};userlikePreview.isActive=function(){return fsm.state instanceof PreviewState};userlikePreview.stop=function(){if(userlikePreview!=null){userlikePreview.reset()}fsm.next(Idle);if(userlikePreview!=null){userlikePreview.setUIState()}if(userlikePreview!=null){userlikePreview.setButton(config)}if(typeof button.registerEvents==="function"){button.registerEvents()}return typeof button.fadeOutHoverText==="function"?button.fadeOutHoverText():void 0};userlikePreview.destroy=function(){return userlikePreview!=null?userlikePreview.unregisterEvents():void 0};userlikePreview.reset=function(){if(popup.view){return popup.close()}};userlikePreview.showOfflineMessageForm=function(options){if(!(userlikePreview!=null?userlikePreview.start():void 0)){return}if(options==null){options=userlikePreview.last_config}return new OfflineMessageView({config:options}).showOfflineMessageForm()};userlikePreview.showOfflineMessageSent=function(options){if(!(userlikePreview!=null?userlikePreview.start():void 0)){return}if(options==null){options=userlikePreview.last_config}return new OfflineMessageView({config:options}).showOfflineMessageSent()};userlikePreview.showRegister=function(options){if(!(userlikePreview!=null?userlikePreview.start():void 0)){return}if(options==null){options=userlikePreview.last_config}return new RegisterView({config:options}).showRegisterForm()};userlikePreview.showPreSurvey=function(options){if(!(userlikePreview!=null?userlikePreview.start():void 0)){return}if(options==null){options=userlikePreview.last_config}return new SurveyView({config:options}).showPreSurvey()};userlikePreview.showPostSurvey=function(options){if(!(userlikePreview!=null?userlikePreview.start():void 0)){return}if(options==null){options=userlikePreview.last_config}return new SurveyView({config:options}).showPostSurvey()};userlikePreview.showChat=function(options){if(!(userlikePreview!=null?userlikePreview.start():void 0)){return}if(options==null){options=userlikePreview.last_config}options.operator_display_name=userlikePreview!=null?userlikePreview.operator_display_name:void 0;options.operator_url_image=userlikePreview!=null?userlikePreview.operator_url_image:void 0;return new ChatView({config:options}).showPreview()};userlikePreview.showDisclaimer=function(options){if(options==null){options=userlikePreview.last_config}return new DisclaimerView({config:options}).show()};userlikePreview.showGroupSelect=function(options){if(!(userlikePreview!=null?userlikePreview.start():void 0)){return}if(options==null){options=userlikePreview.last_config}if(options.data==null){options.data={available:[{name:"Operator1",
first:{url_image:"//dggtwb4wc2zg7.cloudfront.net/static/web/images/profile-pictures/default_2.jpg"}},{name:"Operator2",first:{url_image:"//dggtwb4wc2zg7.cloudfront.net/static/web/images/profile-pictures/default_3.jpg"}},{name:"Operator3",first:{url_image:"//dggtwb4wc2zg7.cloudfront.net/static/web/images/profile-pictures/default_4.jpg"}}]}}return new GroupSelectView({config:options}).show()};userlikePreview.showTranscript=function(options){if(!(userlikePreview!=null?userlikePreview.start():void 0)){return}if(options==null){options=userlikePreview.last_config}return new TranscriptView({config:options}).show()};userlikePreview.setButton=function(options){if(!(userlikePreview!=null?userlikePreview.start():void 0)){return}if(options==null){options=userlikePreview.last_config}button.destroy();return button=new ButtonFactory({config:options}).makeButton().render().show(0)};userlikePreview.showButton=function(){if(!(userlikePreview!=null?userlikePreview.start():void 0)){return}return popup.hide()};userlikePreview.setEyecatcher=function(options){if(options==null){options={}}if(!(userlikePreview!=null?userlikePreview.start():void 0)){return}popup.hide();if(options==null){options=userlikePreview.last_config}options.eyecatcher_enabled=true;return new ButtonFactory({config:options}).makeButton().render().show()};userlikePreview.setTheme=function(config){var ref1;if(!(userlikePreview!=null?userlikePreview.start():void 0)){return}config.theme=userlikePreview!=null?userlikePreview.themeGroupedToMerged(config.theme):void 0;if(userlikePreview!=null){userlikePreview.setButton(config)}popup.setConfig(config).setupTheme();return userlikePreview!=null?(ref1=userlikePreview.last_config)!=null?ref1.theme=config.theme:void 0:void 0};userlikePreview.showTransfer=function(options){if(!(userlikePreview!=null?userlikePreview.start():void 0)){return}if(options==null){options=userlikePreview.last_config}return new MessageView({config:options}).showTransfer()};userlikePreview.showProgress=function(options){if(!(userlikePreview!=null?userlikePreview.start():void 0)){return}if(options==null){options=userlikePreview.last_config}return new ProgressView({config:options}).show()};userlikePreview.showError=function(options){if(!(userlikePreview!=null?userlikePreview.start():void 0)){return}if(options==null){options=userlikePreview.last_config}return new MessageView({config:options}).showErrorMessage()};userlikePreview.showFeedbackRatingComposite=function(options){if(!(userlikePreview!=null?userlikePreview.start():void 0)){return}if(options==null){options=userlikePreview.last_config}return new FeedbackRatingCompositeView({config:options}).show()};userlikePreview.showSocialComposite=function(options){if(!(userlikePreview!=null?userlikePreview.start():void 0)){return}if(options==null){options=userlikePreview.last_config}return new SocialCompositeView({config:options}).show()};userlikePreview.registerEvents=function(){var slider_change_method;if(!(userlikePreview!=null?userlikePreview.has_registered_events:void 0)){_jq("#userlike-preview-state").on("click",function(){if(userlikePreview!=null?userlikePreview.isActive():void 0){if(userlikePreview!=null){userlikePreview.stop()}}else{if(userlikePreview!=null){userlikePreview.start()}if(userlikePreview!=null){userlikePreview.cycleView()}}return userlikePreview!=null?userlikePreview.setUIState():void 0});_jq("#userlike-preview-next").on("click",function(){return userlikePreview!=null?userlikePreview.cycleView(1):void 0});_jq("#userlike-preview-prev").on("click",function(){return userlikePreview!=null?userlikePreview.cycleView(-1):void 0});slider_change_method=isIE11()?"change":"input";_jq("#userlike-preview-slider").on(slider_change_method,function(_this){return function(e){return _this.goToView(parseInt(e.target.value),10)}}(this));return userlikePreview!=null?userlikePreview.has_registered_events=true:void 0}};userlikePreview.unregisterEvents=function(){_jq("#userlike-preview-state").off("click");_jq("#userlike-preview-next").off("click");_jq("#userlike-preview-prev").off("click");_jq("#userlike-preview-slider").off("input");return userlikePreview!=null?userlikePreview.has_registered_events=false:void 0};userlikePreview.setUIState=function(){_jq("#userlike-preview-slider").attr("max",(userlikePreview!=null?userlikePreview.view_functions.length:void 0)-1);if(userlikePreview!=null?userlikePreview.isActive():void 0){_jq("#userlike-preview-state").removeClass("icon-play").addClass("icon-pause");_jq(".preview-has-disabled").removeClass("disabled");return _jq("#userlike-preview-slider").get().disabled=false}else{_jq("#userlike-preview-state").removeClass("icon-pause").addClass("icon-play");_jq(".preview-has-disabled").addClass("disabled");return _jq("#userlike-preview-slider").get().disabled=true}};userlikePreview.cycleView=function(direction){if(direction==null){direction=1}if(!(userlikePreview!=null?userlikePreview.start():void 0)){return}if(!(userlikePreview!=null?userlikePreview.isActive():void 0)){return}if(userlikePreview!=null){userlikePreview.current_view_index+=direction}return userlikePreview!=null?userlikePreview.goToView(userlikePreview!=null?userlikePreview.current_view_index:void 0):void 0};userlikePreview.goToView=function(index){var view_function;if(!(userlikePreview!=null?userlikePreview.isActive():void 0)){return}if(userlikePreview!=null){userlikePreview.current_view_index=index}if((userlikePreview!=null?userlikePreview.current_view_index:void 0)<0){if(userlikePreview!=null){userlikePreview.current_view_index=(userlikePreview!=null?userlikePreview.view_functions.length:void 0)-1}}if((userlikePreview!=null?userlikePreview.current_view_index:void 0)>=(userlikePreview!=null?userlikePreview.view_functions.length:void 0)){if(userlikePreview!=null){userlikePreview.current_view_index=0}}_jq("#userlike-preview-slider").val(userlikePreview!=null?userlikePreview.current_view_index:void 0);view_function=userlikePreview!=null?userlikePreview.view_functions[userlikePreview!=null?userlikePreview.current_view_index:void 0]:void 0;if(userlikePreview!=null){userlikePreview.setUIState()}popup.setConfig(userlikePreview.last_config).setupTheme();return userlikePreview[view_function]()};userlikePreview.themeGroupedToMerged=function(grouped){var grouped_name,j,len1,merged_name,merged_names,r;r={};for(grouped_name in MAP){if(!hasProp.call(MAP,grouped_name))continue;merged_names=MAP[grouped_name];for(j=0,len1=merged_names.length;j<len1;j++){merged_name=merged_names[j];r[merged_name]=grouped[grouped_name]}}return r};return userlikePreview}();MAP={lead_color:["headbar_bg_color","icon_active_color","button_bg_color","input_active_text_color","chat_operator_text color","icon_hover_color"],lead_text_color:["headbar_text_color","headbar_icon_color","button_text_color","button_icon_color"],text_color:["headline_text_color","text_default_color"],background_color:["window_bg_color"],chat_text_color:["chat_text_color_1","chat_text_color_2"],chat_bg_color_1:["chat_bg_color_1"],chat_bg_color_2:["chat_bg_color_2"],link_color:["link_text_color","icon_default_color","input_default_text_color","border_color"],font:["font"],button_orientation:["button_orientation"],button_offset_x:["button_offset_x"],button_style:["button_style"],button_icon_online:["button_icon_online"],button_icon_offline:["button_icon_offline"],border_radius:["border_radius"],shadow:["shadow"],icon_set:["icon_set"]};App.get().run(userlikeConfig.app_key,userlikeConfig.widget_key,userlikeConfig.data)}).call(this);
