<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Lisp Code Prettifier</title>
<script>(function () {
  var sourceBaseUrl = "./prettify/";
  var sources = [
      "prettify.js",
      "lang-lisp.js",
      "lang-lua.js",
      "lang-ml.js",
      "lang-proto.js",
      "lang-rust.js",
      "lang-scala.js",
      "lang-sql.js",
      "lang-wiki.js",
      "lang-vhdl.js",
      "lang-vb.js",
      "lang-yaml.js",
  ];
  var styles = [
      "prettify.css"
  ];
  if (window.console) {
    console.log("sourceBaseUrl=" + sourceBaseUrl);
  }
  for (var i = 0; i < sources.length; ++i) {
    document.write(
        "<script src=\"" + sourceBaseUrl + sources[i] + "\"><\/script>");
  }
  document.write(
       "<script src=\"test_base.js\" type=\"text/javascript\"><\/script>");
  for (var i = 0; i < styles.length; ++i) {
    document.write(
        "<link rel=\"stylesheet\" href=\"" + sourceBaseUrl + styles[i] + "\">");
  }
})();

window.onload = (function() {
  var attempt = function() {
    var go = window["go"];
    var prettyPrint = window["prettyPrint"];
    var goldens = window["goldens"];
    if(go && prettyPrint && goldens) {
      go(goldens);
    } else {
      setTimeout(attempt, 20);
    }
  };
  return attempt;
})();
</script>

<link rel="stylesheet" type="text/css" href="test_styles.css" />
</head>

<body bgcolor="white">
<div id="timing"></div>


<h1>Lisp Syntax Highlighting</h1>
<pre class="prettyprint lang-lisp" id="issue42"
>; -*- mode: lisp -*-

(defun back-six-lines () (interactive) (forward-line -6))
(defun forward-six-lines () (interactive) (forward-line 6))

(global-set-key "\M-l" 'goto-line)
(global-set-key "\C-z" 'advertised-undo)
(global-set-key [C-insert] 'clipboard-kill-ring-save)
(global-set-key [S-insert] 'clipboard-yank)
(global-set-key [C-up] 'back-six-lines)
(global-set-key [C-down] 'forward-six-lines)

(setq visible-bell t)
(setq user-mail-address "foo@bar.com")
(setq default-major-mode 'text-mode)

(setenv "TERM" "emacs")
(c-set-offset 'case-label 2)
(setq c-basic-offset 2)
(setq perl-indent-level 0x2)
(setq delete-key-deletes-forward t)
(setq indent-tabs-mode nil)

;; Text mode
(add-hook 'text-mode-hook 
  '(lambda ()
     (turn-on-auto-fill)
   )
)

;; Fundamental mode
(add-hook 'fundamental-mode-hook 
  '(lambda ()
     (turn-on-auto-fill)
   )
)

;; Define and cond are keywords in scheme
(define (sqt x) (sqrt-iter 1.0 2.0 x))
</pre>

<script type="text/javascript">
/**
 * maps ids of rewritten code to the expected output.
 * For brevity, <span class="foo"> has been changed to `FOO and </span>
 * has been changed to `END.
 */
var goldens = {
  issue42: (
      '`COM; -*- mode: lisp -*-`END`PLN\n' +
      '\n' +
      '`END`OPN(`END`KWDdefun`END`PLN back-six-lines `END`OPN(`END`CLO)`END' +
           '`PLN `END`OPN(`END`PLNinteractive`END`CLO)`END`PLN `END`OPN(`END' +
           '`PLNforward-line `END`LIT-6`END`CLO))`END`PLN\n' +
      '`END`OPN(`END`KWDdefun`END`PLN forward-six-lines `END`OPN(`END' +
           '`CLO)`END`PLN `END`OPN(`END`PLNinteractive`END`CLO)`END`PLN `END' +
           '`OPN(`END`PLNforward-line `END`LIT6`END`CLO))`END`PLN\n' +
      '\n' +
      '`END`OPN(`END`PLNglobal-set-key `END`STR"\\M-l"`END`PLN `END' +
           '`LIT\'goto-line`END`CLO)`END`PLN\n' +
      '`END`OPN(`END`PLNglobal-set-key `END`STR"\\C-z"`END`PLN `END' +
           '`LIT\'advertised-undo`END`CLO)`END`PLN\n' +
      '`END`OPN(`END`PLNglobal-set-key `END`PUN[`END`PLNC-insert`END' +
           '`PUN]`END`PLN `END`LIT\'clipboard-kill-ring-save`END`CLO)`END' +
           '`PLN\n' +
      '`END`OPN(`END`PLNglobal-set-key `END`PUN[`END`PLNS-insert`END`PUN]`END' +
           '`PLN `END`LIT\'clipboard-yank`END`CLO)`END`PLN\n' +
      '`END`OPN(`END`PLNglobal-set-key `END`PUN[`END`PLNC-up`END`PUN]`END' +
           '`PLN `END`LIT\'back-six-lines`END`CLO)`END`PLN\n' +
      '`END`OPN(`END`PLNglobal-set-key `END`PUN[`END`PLNC-down`END`PUN]`END' +
           '`PLN `END`LIT\'forward-six-lines`END`CLO)`END`PLN\n' +
      '\n' +
      '`END`OPN(`END`KWDsetq`END`PLN visible-bell `END`KWDt`END`CLO)`END' +
           '`PLN\n' +
      '`END`OPN(`END`KWDsetq`END`PLN user-mail-address `END' +
           '`STR"foo@bar.com"`END`CLO)`END`PLN\n' +
      '`END`OPN(`END`KWDsetq`END`PLN default-major-mode `END' +
           '`LIT\'text-mode`END`CLO)`END`PLN\n' +
      '\n' +
      '`END`OPN(`END`PLNsetenv `END`STR"TERM"`END`PLN `END' +
           '`STR"emacs"`END`CLO)`END`PLN\n' +
      '`END`OPN(`END`PLNc-set-offset `END`LIT\'case-label`END`PLN `END' +
           '`LIT2`END`CLO)`END`PLN\n' +
      '`END`OPN(`END`KWDsetq`END`PLN c-basic-offset `END`LIT2`END`CLO)`END' +
           '`PLN\n' +
      '`END`OPN(`END`KWDsetq`END`PLN perl-indent-level `END`LIT0x2`END`CLO)`END' +
           '`PLN\n' +
      '`END`OPN(`END`KWDsetq`END`PLN delete-key-deletes-forward `END`KWDt`END' +
           '`CLO)`END`PLN\n' +
      '`END`OPN(`END`KWDsetq`END`PLN indent-tabs-mode `END`KWDnil`END' +
           '`CLO)`END`PLN\n' +
      '\n' +
      '`END`COM;; Text mode`END`PLN\n' +
      '`END`OPN(`END`PLNadd-hook `END`LIT\'text-mode-hook`END`PLN \n' +
      '  `END`LIT\'`END`OPN(`END`KWDlambda`END`PLN `END`OPN(`END' +
           '`CLO)`END`PLN\n' +
      '     `END`OPN(`END`PLNturn-on-auto-fill`END`CLO)`END' +
           '`PLN\n' +
      '   `END`CLO)`END`PLN\n' +
      '`END`CLO)`END`PLN\n' +
      '\n' +
      '`END`COM;; Fundamental mode`END`PLN\n' +
      '`END`OPN(`END`PLNadd-hook `END`LIT\'fundamental-mode-hook`END' +
           '`PLN \n' +
      '  `END`LIT\'`END`OPN(`END`KWDlambda`END`PLN `END`OPN(`END' +
           '`CLO)`END`PLN\n' +
      '     `END`OPN(`END`PLNturn-on-auto-fill`END' +
           '`CLO)`END`PLN\n' +
      '   `END`CLO)`END`PLN\n' +
      '`END`CLO)`END`PLN\n' +
      '\n' +
      '`END`COM;; Define and cond are keywords in scheme`END`PLN\n' +
      '`END`OPN(`END`KWDdefine`END`PLN `END`OPN(`END`PLNsqt x`END`CLO)`END' +
           '`PLN `END`OPN(`END`PLNsqrt-iter `END`LIT1.0`END`PLN `END' +
           '`LIT2.0`END`PLN x`END`CLO))`END')
};
</script>

</body>

</html>
